<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

   <meta name="GENERATOR" content="Mozilla/4.77 [en] (X11; U; Linux 2.4.3-12 i686) [Netscape]">

   <title>Cloudy test suite</title>


</head>
<body><h4>  This HTML file was created by the program doc_tsuite.pl, doc_tsuite.txt contains a tab delimited list of the files. </h4>
<hr><kbd><h2>agn_blr_albedo.in</h2>  </kbd><h2><I>measure Rayleigh scattering of Lya
</I></h2><kbd><br>title measure Rayleigh scattering of Lya
<br># model from Korista, K., & Ferland, G. 1998, ApJ, 495, 672
<br>#
<br># commands controlling continuum =========
<br>agn 6.683 -1.20 -1.20 -0.90
<br>ionization parameter 1.0
<br>#
<br># commands for density & abundances =========
<br>init file = "ism.ini"
<br>abundances old solar 84 
<br>hden 11.0
<br>#
<br># commands controlling geometry  =========
<br>stop total column density = 23.75
<br>#
<br># other commands for details     =========
<br>iterate 
<br>#
<br># commands controlling output    =========
<br>normalize to "FeKa" 1.78
<br>print line faint -1
<br>print lines inward
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save overview "agn_blr_albedo.ovr"
<br>save performance "agn_blr_albedo.per"
<br>save continuum last "agn_blr_albedo.con" units kev
<br>save dr "agn_blr_albedo.dr" 
<br>save reflected continuum last "agn_blr_albedo.ref"
<br>save emitted continuum last "agn_blr_albedo.emt"
<br>#
<br># must assert the luminosity since change in this 
<br># line would appear to change the rest of the spectrum
<br># agn_blr_albedo.in
<br># class blr 
<br># ========================================
</kbd><p>
This model computes the albedo of a fairly
standard BLR cloud.  This is the type of
model that was presented in the BLR albedo
paper by Korista & Ferland, 1998, ApJ 495, 672.
<p>
The asserts then check that these continua have the expected brightness.
<p>
</p><hr><kbd><h2>agn_lex00_u0.in</h2>  </kbd><h2><I>intermediate-ionization x-ray ionized cloud from Lexington 2000
</I></h2><kbd><br>title intermediate-ionization x-ray ionized cloud from Lexington 2000
<br>stop column density 16
<br>print line sort wavelength 
<br>print lines column linear 
<br>normalize to "H  1" 1215.67A
<br>print line faint -1
<br>hden 5
<br>iterate
<br>phi(h) 15.477 range 7.353 to 735.3
<br>interpolate (-8 -3)
<br>continue (-6 1.)
<br>continue (-2 14.5)
<br>continue (0.4771 12.7) 
<br>continue (0.8663 10.6)
<br>continue (3.8663 7.6)
<br>continue (6 1)
<br>continue (9 -3)
<br>element abundance helium  -1
<br>element abundance carbon -3.432
<br>element abundance nitrogen -3.959
<br>element abundance oxygen -3.097
<br>element abundance neon -3.959
<br>element abundance magnesium -4.4318
<br>element abundance silicon -4.456
<br>element abundance sulphur -4.7959
<br>element abundance argon -5.4318
<br>element abundance iron -4.398
<br>element lithium off
<br>element beryllium off
<br>element boron off
<br>element fluorine off
<br>element sodium off
<br>element aluminium off
<br>element phosphrous off
<br>element chlorine off
<br>element potasium off
<br>element calcium off
<br>element scandium off
<br>element titanium off
<br>element vanadium off
<br>element chromium off
<br>element manganese off
<br>element cobalt off
<br>element nickel off
<br>element copper off
<br>element zinc off
<br>#
<br>save overview "agn_lex00_u0.ovr"
<br>save performance "agn_lex00_u0.per"
<br>save transmitted continuum "agn_lex00_u0.trn" units keV 
<br>#
<br># agn_lex00_u0.in
</kbd><p>
This is one of the "warm absorber" simulations presented at the Lexington
2000 meeting on nebulae.  Pequignot et al. summarized in 2001ASPC..247..533P.
It is necessary to also include the command
no induced processes
to obtain the results presented there.  This disables UTA ionization,
a process that was not included in the calculations presented in the paper.
<p>
</p><hr><kbd><h2>agn_lex00_u1.in</h2>  </kbd><h2><I>high-ionization x-ray ionized cloud from Lexington 2000
</I></h2><kbd><br>title high-ionization x-ray ionized cloud from Lexington 2000
<br>stop column density 16
<br>print lines column linear 
<br>normalize to "H  1" 1215.67A
<br>print line faint -1
<br>hden 5
<br>iterate
<br>phi(h) 16.477 range 7.353 to 735.3
<br>interpolate (-8 -3)
<br>continue (-6 1.)
<br>continue (-2 14.5)
<br>continue (0.4771 12.7) 
<br>continue (0.8663 10.6)
<br>continue (3.8663 7.6)
<br>continue (6 1)
<br>continue (9 -3)
<br>element abundance helium  -1
<br>element abundance carbon -3.432
<br>element abundance nitrogen -3.959
<br>element abundance oxygen -3.097
<br>element abundance neon -3.959
<br>element abundance magnesium -4.4318
<br>element abundance silicon -4.456
<br>element abundance sulphur -4.7959
<br>element abundance argon -5.4318
<br>element abundance iron -4.398
<br>element lithium off
<br>element beryllium off
<br>element boron off
<br>element fluorine off
<br>element sodium off
<br>element aluminium off
<br>element phosphrous off
<br>element chlorine off
<br>element potasium off
<br>element calcium off
<br>element scandium off
<br>element titanium off
<br>element vanadium off
<br>element chromium off
<br>element manganese off
<br>element cobalt off
<br>element nickel off
<br>element copper off
<br>element zinc off
<br>save overview "agn_lex00_u1.ovr"
<br>save performance "agn_lex00_u1.per"
<br>save transmitted continuum "agn_lex00_u1.trn" units keV 
<br>#
<br># agn_lex00_u1.in 
</kbd><p>
This is one of the "warm absorber" simulations presented at the Lexington
2000 meeting on nebulae.  Pequignot et al. summarized in 2001ASPC..247..533P.
It is necessary to also include the command
no induced processes
to obtain the results presented there.  This disables UTA ionization,
a process that was not included in the calculations presented in the paper.
<p>
</p><hr><kbd><h2>agn_lex00_um1.in</h2>  </kbd><h2><I>low-ionization x-ray ionized cloud from Lexington 2000
</I></h2><kbd><br>title low-ionization x-ray ionized cloud from Lexington 2000
<br>stop column density 16
<br>print lines column linear
<br>print lines sort intensity 
<br>normalize to "H  1" 1215.67A
<br>print line faint -2
<br>hden 5
<br>iterate
<br>phi(h) 14.477 range 7.353 to 735.3
<br>interpolate (-8 -3)
<br>continue (-6 1.)
<br>continue (-2 14.5)
<br>continue (0.4771 12.7) 
<br>continue (0.8663 10.6)
<br>continue (3.8663 7.6)
<br>continue (6 1)
<br>continue (9 -3)
<br>element abundance helium  -1
<br>element abundance carbon -3.432
<br>element abundance nitrogen -3.959
<br>element abundance oxygen -3.097
<br>element abundance neon -3.959
<br>element abundance magnesium -4.4318
<br>element abundance silicon -4.456
<br>element abundance sulphur -4.7959
<br>element abundance argon -5.4318
<br>element abundance iron -4.398
<br>element lithium off
<br>element beryllium off
<br>element boron off
<br>element fluorine off
<br>element sodium off
<br>element aluminium off
<br>element phosphrous off
<br>element chlorine off
<br>element potasium off
<br>element calcium off
<br>element scandium off
<br>element titanium off
<br>element vanadium off
<br>element chromium off
<br>element manganese off
<br>element cobalt off
<br>element nickel off
<br>element copper off
<br>element zinc off
<br># 
<br>save overview "agn_lex00_um1.ovr"
<br>save performance "agn_lex00_um1.per"
<br>save transmitted continuum "agn_lex00_um1.trn"  units keV 
<br>#
<br># agn_lex00_um1.in 
</kbd><p>
This is one of the "warm absorber" simulations presented at the Lexington
2000 meeting on nebulae.  Pequignot et al. summarized in 2001ASPC..247..533P.
It is necessary to also include the command
no induced processes
to obtain the results presented there.  This disables UTA ionization,
a process that was not included in the calculations presented in the paper.
<p>
<p>
</p><hr><kbd><h2>agn_reflector.in</h2>  </kbd><h2><I>model of Compton reflector
</I></h2><kbd><br>title model of Compton reflector
<br>#
<br># commands controlling continuum =========
<br># this is a powerlaw that extends into the x-rays, but by default
<br># has exponential cutoff in FIR
<br>power law -1. hi=1000000000
<br># the ionization parameter for this powerlaw
<br>ionization parameter 1.
<br># add background so that FIR/radio does not have zero flux
<br>background
<br>iterate 
<br>#
<br># commands for density & abundances =========
<br>hden 11
<br>#
<br># commands controlling geometry  =========
<br>stop total column density 24
<br>#
<br># other commands for details     =========
<br>constant temper 5
<br>database h-like element hydrogen levels resolved 10
<br>database h-like element helium levels resolved 10
<br>#
<br># commands controlling output    =========
<br>print line faint 1
<br>print line inward
<br>#
<br># this is to produce lines with lots of contrast with the continuum
<br>set save Line Width 100 km/sec
<br># a fig in part 3 of hazy uses data from this model.  the fig shows lines
<br># with above and below linewidth
<br># set save line Width   c  
<br>save performance "agn_reflector.per"
<br>save continuum last "agn_reflector.con" units kev 
<br>save continuum reflected last "agn_reflector.alb" units kev 
<br>save overview last "agn_reflector.ovr"
<br>save dr last "agn_reflector.dr"
<br>#
<br># agn_reflector.in
<br># class blr 
<br># ========================================
<br># 
</kbd><p>
This is a model of the Compton reflector in AGN.  It is a
constant temperature since models of this region often make that assumption. 
A plot in Part I of Hazy shows the incident and reflected portions of the 
continuum.  The code will complain that the cloud is Compton thick since it 
is not really designed to simulate this situation.
<p>
</p><hr><kbd><h2>agn_S_curve_grid.in</h2>  </kbd><h2><I>temperature across Spitzer thermal stability S curve
</I></h2><kbd><br>title temperature across Spitzer thermal stability S curve
<br>#
<br># commands controlling continuum =========
<br># this is the generic AGN continuum
<br>table agn
<br># the ionization parameter will be varied
<br>ionization parameter 0.00 vary
<br>grid from 0 to 3 in 0.25 dex steps sequential
<br># add background so that FIR/radio does not have zero flux
<br>background
<br>iterate 
<br>#
<br># commands for density & abundances =========
<br># intended to make sim run as fast as possible
<br>hden 8
<br>init file "ism.ini"
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands controlling output
<br># this produces a very large number of lines in the output mostly
<br># because Hbeta is very weak in hot gas.  Choose Lya as the normalization
<br># line to make line list smaller
<br>normalize to "H  1" 1215.67A
<br>print line faint 10 will be varied
<br># create file with list of grid parameters
<br>save overview "agn_S_curve_grid.ovr" last no hash
<br>save performance "agn_S_curve_grid.per"
<br>save grid "agn_S_curve_grid.grd" last no hash
<br>save species densities "agn_S_curve_grid.sden" "Si+12[10:11]" last no hash
<br># save average H+ temperature
<br>save average "agn_S_curve_grid.avr" last no hash
<br>temperature hydrogen 1 
<br>end of temperatures 
<br># save heating and cooling
<br>save heating "agn_S_curve_grid.het" last no hash
<br>save cooling "agn_S_curve_grid.col" last no hash
<br>save pressure "agn_S_curve_grid.pre" last no hash
<br>save iron element "agn_S_curve_grid.fe" last  no hash
<br>save xspec atable "agn_S_curve_grid.fit" 
<br>save neon element "agn_S_curve_grid.ne" last separate
<br>#
<br>#
<br># agn_S_grid.in
<br># class BLR
<br># ========================================
<br>#
</kbd><p>
This computes a series of models that check the temperature
through the S curve in the Fields et al. three-phase model of
ISM stability.
<p>
<p>
</p><hr><kbd><h2>agn_warm_absorber.in</h2>  </kbd><h2><I>simple warm absorber model
</I></h2><kbd><br>title simple warm absorber model
<br>#
<br># commands controlling continuum =========
<br>table power law
<br>ionization parameter 0
<br>#
<br># commands for density & abundances =========
<br>hden 6
<br>abundances old solar 84 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 22
<br>#
<br># other commands for details     =========
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>print line faint 10 
<br>save overview "agn_warm_absorber.ovr"
<br>save performance "agn_warm_absorber.per"
<br>save continuum "agn_warm_absorber.con" last units kev
<br>save continuum "agn_warm_absorber.conA" last units Angstroms
<br>save fine continuum "agn_warm_absorber.finA" last units Angstroms range 7.6A to 15A merge 3
<br>save dr "agn_warm_absorber.dr" last
<br>save lines, optical depth some, "agn_warm_absorber.opt" last
<br>O  3 5006.84A
<br>end of lines
<br># this will be the default units, like the printout
<br>save line optical depths last "agn_warm_absorber_lab.lin" 
<br># this will be the same, in rygbergs
<br>save line optical depths last "agn_warm_absorber_ryg.lin"  units rydberg
<br>#
<br># warrm_absorber
<br># class nlr  
<br># ========================================
<br># 
</kbd><p>
<p>
this is a simple warm absorber model.  It makes a plot of the
transmitted continuum, and generates a list of lines with
significant optical depths
</p><hr><kbd><h2>agn_warm_absorber_hiU.in</h2>  </kbd><h2><I>simple warm absorber model
</I></h2><kbd><br>title simple warm absorber model
<br>set save prefix "agn_warm_absorber_hiU"
<br>#
<br># commands controlling continuum =========
<br>table power law
<br>ionization parameter 150 linear
<br>#
<br># commands for density & abundances =========
<br>hden 6
<br>abundances old solar 84 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 22
<br>#
<br># commands controlling models =========
<br>database h-like element zinc collapsed levels 5
<br>#
<br># other commands for details     =========
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>print line column
<br>normalize "Fe26"      1.77982A 
<br>save overview ".ovr"
<br>save performance ".per"
<br>save continuum ".con" last units kev
<br>save continuum ".conA" last units Angstroms
<br>save fine continuum ".finA" last units Angstroms range 7.6A to 15A merge 3
<br>save dr ".dr" last
<br># this will be the default units, like the printout
<br>save line optical depths last ".lin"
<br># this will be the same, in rygbergs
<br>save line optical depths last ".lin"  units rydberg
<br>#
<br># warrm_absorber
<br># class nlr  
<br># ========================================
<br># 
</kbd><p>
<p>
This is simple warm absorber model with a high ionization parameter,
chosen to yield about 50% ionization fractions for H-like Fe and Zn.
It generates a list of lines with significant optical depths.
</p><hr><kbd><h2>aperture_beam_int.in</h2>  </kbd><h2><I>test aperture beam command with intensity
</I></h2><kbd><br>title test aperture beam command with intensity
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>init file "honly.ini"
<br>#
<br># other commands for details     =========
<br>constant temper 4
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -2
<br>#
<br># commands controlling geometry  =========
<br>stop thickness 10
<br>sphere
<br>aperture beam 
<br>#
<br># commands controlling output    =========
<br>save overview "aperture_beam_int.ovr"
<br>save performance "aperture_beam_int.per"
<br>#
<br># aperture_beam_int.in 
<br># class geometry 
<br># ========================================
</kbd><p>
This is a homogeneous sphere that is especially simple.  The model
is a test of the aperture command, a command that simulates observing
part of an extended object.  In this case the aperture is a beam
contered on the center of the nebula, with a line of sight
extending through the object.  
<p>
The code carries along a dummy emission line ("Unit 1") with a constant intensity
of 1e-10 erg cm-3 s-1.  The line goes through all of the code's infrastructure,
and when the calculation is complete, the program confirms that the "luminosity"
of the line is the emitting volume times 1e-10.  The aperture command
is verified by asserting that the emission line has the correct "luminosity".
In this case the inner radius is not specified so the returned value is unity.
<p>
<p>
</p><hr><kbd><h2>aperture_beam_lum.in</h2>  </kbd><h2><I>test aperture beam command with luminosity
</I></h2><kbd><br>title test aperture beam command with luminosity
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>q(h) 31.5
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop thickness 1e10 linear cm 
<br>radius 9
<br>sphere
<br>aperture beam 
<br>#
<br># other commands for details     =========
<br>constant temper 4
<br>#
<br># commands controlling output    =========
<br>save overview "aperture_beam_lum.ovr"
<br>save performance "aperture_beam_lum.per"
<br>#
<br># aperture_beam_lum.in
<br># class geometry 
<br># ========================================
</kbd><p>
<p>
This is a homogeneous sphere that is especially simple.  The model
is a test of the aperture command, a command that simulates observing
part of an extended object.  In this case the aperture is a beam
contered on the center of the nebula, with a line of sight
extending through the object.  
<p>
The code carries along a dummy emission line ("Unit 1") with a constant intensity
of 1e-10 erg cm-3 s-1.  The line goes through all of the code's infrastructure,
and when the calculation is complete, the program confirms that the "luminosity"
of the line is the emitting volume times 1e-10.  The aperture command
is verified by asserting that this emission line has the correct "luminosity".
<p>
<p>
</p><hr><kbd><h2>aperture_slit.in</h2>  </kbd><h2><I>test aperture slit command with luminosity
</I></h2><kbd><br>title test aperture slit command with luminosity
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>q(h) 31.5
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>radius 9 10
<br>sphere
<br>aperture slit 
<br>#
<br># other commands for details     =========
<br>constant temper 4
<br>#
<br># commands controlling output    =========
<br>save overview "aperture_slit.ovr"
<br>save performance "aperture_slit.per"
<br>#
<br># aperture_slit.in
<br># class geometry 
<br># ========================================
<br># 
</kbd><p>
This is a homogeneous sphere that is especially simple.  The model
is a test of the aperture command, a command that simulates observing
part of an extended object.  In this case the aperture is a long
slit contered on the center of the nebula, extending beyond the outer
reaches of the matter.  
<p>
The code carries along a dummy emission line ("Unit 1") with a constant intensity
of 1e-10 erg cm-3 s-1.  The line goes through all of the code's infrastructure,
and when the calculation is complete, the program confirms that the "luminosity"
of the line is the emitting volume times 1e-10.  The aperture command
is verified by asserting that the emission line has the correct "luminosity".
<p>
</p><hr><kbd><h2>blr_f92.in</h2>  </kbd><h2><I>standard blr cloud in Ferland et al. 1992
</I></h2><kbd><br>title standard blr cloud in Ferland et al. 1992
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -1
<br>#
<br># commands for density & abundances =========
<br>hden 11
<br>abundances old solar 84 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 25
<br>#
<br># other commands for details     =========
<br>database h-like element hydrogen levels resolved 10
<br>database h-like element helium levels resolved 10
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>print h-like departure hydrogen 
<br>print h-like populations hydrogen 
<br>print h-like departure helium
<br>print h-like populations helium
<br>normalize to "H  1" 1215.67A = 105.90
<br>print line faint -2
<br>save performance "blr_f92.per"
<br>save overview last "blr_f92.ovr"
<br>save convergence reason "blr_f92.cvr"
<br>save element nitrogen last "blr_f92.nit"
<br>save element calcium last "blr_f92.ca"
<br>save dr "blr_f92.dr"
<br>save transmitted continuum "blr_f92.trn" last
<br>#
<br># blr_f92.ini
<br># class blr 
<br># ========================================
</kbd><p>
This is similar to one of the BLR models presented in Ferland et al. (1992)
for the well-studied Seyfert galaxy NGC 5548.  It has a very large column
density and is marginally optically thick to electron scattering.  The spectrum
is given relative to Lya, and the intensity of this line is reset to 
produce a spectrum that is on the same intensity scale as that paper.
<p>
</p><hr><kbd><h2>blr_fp89.in</h2>  </kbd><h2><I>final F+P 1989 BLR model table 3
</I></h2><kbd><br>title final F+P 1989 BLR model table 3
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -0.5
<br>#
<br># commands for density & abundances =========
<br>hden 9.5
<br>init file="c84.ini"
<br>abundances old solar 84 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 25.5
<br>#
<br># other commands for details     =========
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br># set a relatively high faint level since lines relative to Lya=100
<br>print line faint -1
<br>print h-like departure coefficients hydrogen
<br>normalize to "H  1" 1215.67A = 85.60
<br>save performance "blr_fp89.per"
<br>save heating "blr_fp89.het"
<br>save convergence reason "blr_fp89.cvr" 
<br>save cooling "blr_fp89.col"
<br>save overview last "blr_fp89.ovr"
<br>save element nitrogen last "blr_fp89.nit"
<br>save results last "blr_fp89.rlt"
<br>save dr "blr_fp89.dr"
<br>#
<br># blr_fp89.in
<br># class blr 
<br># ========================================
</kbd><p>
<p>
<p>
Ferland and Persson (1989) presented this calculation of a BLR cloud.
The differences between the present predictions and
those given by FP are largely due to improved treatment
of Balmer line escape and destruction. The spectrum is given relative
to a Lya intensity of 100. The column density is VERY large, to
reproduce intensities of low-ionization lines, especially the Ca II lines.
<p>
</p><hr><kbd><h2>blr_hizqso.in</h2>  </kbd><h2><I>high Z quasar cloud
</I></h2><kbd><br>title high Z quasar cloud
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter 1
<br>#
<br># commands for density & abundances =========
<br># actual elec den will be about 100x larger 
<br>hden 8
<br>abundances starburst 35
<br>#
<br># commands controlling geometry  =========
<br># this is more gramage than it appears because of high Z
<br>stop column density 21
<br>#
<br># other commands for details     =========
<br># once elec den fail occurs due to tripping over He+ - He I-front
<br># code does recover so not a problem.  The default for this is 10,
<br># and is set low because (hopefully) this would never occur
<br># hydrogen is a minor constituent in this high metallicity gas
<br># the electron density is well above the hydrogen density
<br>failures 3
<br>iterate 3 
<br>#
<br># commands controlling output    =========
<br>normalize "blnd" 1909
<br>save performance "blr_hizqso.per"
<br>save dr "blr_hizqso.dr"
<br>save convergence reason "blr_hizqso.cvr"
<br>save overview last "blr_hizqso.ovr"
<br>save element nitrogen last "blr_hizqso.nit"
<br>save element chlorine last "blr_hizqso.cl"
<br>save element iron last "blr_hizqso.fe"
<br>save element neon last "blr_hizqso.ne"
<br>save element calcium last "blr_hizqso.ca"
<br>save element zinc last "blr_hizqso.zn"
<br>save heating last "blr_hizqso.het"
<br>save cooling last "blr_hizqso.col"
<br>#
<br># 
<br># blr_hizqso.in
<br># class blr 
<br># ========================================
</kbd><p>
This is a model of a very high metallicty BLR cloud.  It checks the
intensities of some of the brigher lines, and is a check that the code
can converge a cloud with this high Z.
<p>
Secondary ionization is very important when H is highly ionized,
due to very high He abundance.  Sec ionization becomes important
at the He+ - He ionization front, where H+/H is 1e-5.
<p>
</p><hr><kbd><h2>blr_kk81.in</h2>  </kbd><h2><I>old blr
</I></h2><kbd><br>title old blr
<br>#
<br># commands controlling continuum =========
<br>interpolate (0 -5) (.05 -5) (.1 0) (1 -0.5) (7.353 -2.233)
<br>continue (735 -3.233) (800 -15) (8.e6 -15)
<br>f(nu) -7.32148
<br>constant gas pressure
<br>#
<br># commands for density & abundances =========
<br>hden 9.60206
<br>init file="c84.ini"
<br>abundances he=-1 c=-3.699 n=-4 o=-3.1549 ne=-4 na=-8 mg=-4.5229
<br>continue al=-10 si=-4.4229 s=-10 ar=-10 ca=-10 fe=-4.5229 ni=-8
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>failures 2
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>print line faint -1
<br>print ages 
<br>normalize "H  1" 1215.67A 100
<br>save performance "blr_kk81.per"
<br>save overview last "blr_kk81.ovr"
<br>save convergence reason last "blr_kk81.cvr"
<br>save dr last "blr_kk81.dr"
<br>save continuum last "blr_kk81.con"
<br>save ionizing continuum "blr_kk81.ion"
<br>#
<br>#
<br># blr_kk81.in
<br># class blr 
<br># ========================================
<br># 
</kbd><p>
This is the "standard" BLR model presented by Kwan and Krolik (1981).
<p>
>>refer	blr	cloud	Kwan, J.,  & Krolik, J. 1981, ApJ, 250, 478
<p>
Compare line intensities to previous versions of CLOUDY
by entering into table on page Error! Bookmark not defined..
<p>
The code caution that the resulting total pressure was not constant
is to be expected.  The KK calculation assumed constant gas pressure,
but internally generature line radiation pressure is significant.  
Because of this the sum
of gas plus radiation pressure was not constant although 
the gas pressure was. 
<p>
</p><hr><kbd><h2>blr_level2.in</h2>  </kbd><h2><I>test dominant level2 lines
</I></h2><kbd><br>title test dominant level2 lines
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization -2
<br>#
<br># commands controlling geometry  =========
<br>stop column density 19
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>element phosphorus abundance 0
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save performance "blr_level2.per" 
<br>save convergence reason last "blr_level2.cvr"
<br>save overview "blr_level2.ovr"
<br>save dr "blr_level2.dr"
<br>#
<br># blr_level2.in
<br># class blr 
<br># ========================================
</kbd><p>
This model checks predictions for the "level2" lines.  These are
lines that are normally very weak, have Opacity Project wavelengths,
and g-bar collision strengths.  Phosphorus is given a large abundance
so that its level2 lines are significant.
<p>
</p><hr><kbd><h2>blr_n09_p18.in</h2>  </kbd><h2><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e18 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e18 cm2 s-1
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 18
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br># these are to try to speed things up
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n09_p18.per"
<br>save overview "blr_n09_p18.ovr" last
<br>save dr "blr_n09_p18.dr" last 
<br>save convergence reason "blr_n09_p18.cvr"
<br>#
<br># blr_n09_p18.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n09_p18_Z20.in</h2>  </kbd><h2><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
<br># 
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 18
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br>abundances starburst 20 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate to convergence
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>print h-like hydrogen departure coefficients
<br>save performance "blr_n09_p18_Z20.per"
<br>save overview "blr_n09_p18_Z20.ovr"
<br>save dr "blr_n09_p18_Z20.dr"
<br>save convergence reason "blr_n09_p18_Z20.cvr"
<br>save convergence error "blr_n09_p18_Z20.cve"
<br>#
<br># blr_n09_p18_Z20.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n09_p20.in</h2>  </kbd><h2><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br># these are to try to speed things up
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n09_p20.per"
<br>save overview "blr_n09_p20.ovr" last
<br>save dr "blr_n09_p20.dr" last 
<br>save continuum units Angstroms "blr_n09_p20.con" last 
<br>save convergence reason "blr_n09_p20.cvr"
<br>#
<br># blr_n09_p18.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n09_p20_Z20.in</h2>  </kbd><h2><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1, Z=20
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>#
<br># commands for density & abundances =========
<br>abundances starburst 20 
<br>hden 9
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br># these are to try to speed things up
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n09_p20_Z20.per"
<br>save overview "blr_n09_p20_Z20.ovr" last
<br>save dr "blr_n09_p20_Z20.dr" last 
<br>save convergence reason "blr_n09_p20_Z20.cvr"
<br>#
<br># blr_n09_p20_Z20.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
<p>
This simulation is optically thin in the Lyman continuum - no H ionization
front is present.  As a result it can be difficult to converge.
</p><hr><kbd><h2>blr_n09_p22.in</h2>  </kbd><h2><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e20 cm2 s-1
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br># these are to try to speed things up
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n09_p22.per"
<br>save overview "blr_n09_p22.ovr" last
<br>save dr "blr_n09_p22.dr" last 
<br>save convergence reason "blr_n09_p22.cvr"
<br>#
<br># blr_n09_p22.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the models that sample the LOC plane.
</p><hr><kbd><h2>blr_n09_p22_Z20.in</h2>  </kbd><h2><I>BLR model, density 1e09 cm-3, flux of H-ion phots 1e22 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e09 cm-3, flux of H-ion phots 1e22 cm2 s-1, Z=20
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>#
<br># commands for density & abundances =========
<br>abundances starburst 20 
<br>hden 9
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>init "c84.ini"
<br>iterate convergence 
<br># these are to try to speed things up
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n09_p22_Z20.per"
<br>save overview "blr_n09_p22_Z20.ovr" last
<br>save dr "blr_n09_p22_Z20.dr" last 
<br>save convergence reason "blr_n09_p22_Z20.cvr"
<br>save convergence base "blr_n09_p22_Z20.cvb"
<br>save element iron "blr_n09_p22_Z20.fe"
<br># save line emissivities when there is significant ionization stratification
<br># some of these ions will not exist at the inner edge or even anywhere in the sim
<br># saving the emissivities should still work correctly though...
<br>save line emissivity "blr_n09_p22_Z20.ems"
<br>Fe21 142.281A
<br>blnd  1666A
<br>O  1  6300.30
<br>He 1  6678.15A
<br>blnd  1240A
<br>end of lines
<br>#
<br># blr_n09_p22_Z20.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the models that sample the LOC plane.
</p><hr><kbd><h2>blr_n11_p20.in</h2>  </kbd><h2><I>BLR model, density 1e11 cm-3, flux of H-ion phots 1e20 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e11 cm-3, flux of H-ion phots 1e20 cm2 s-1
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>#
<br># commands for density & abundances =========
<br>hden 11
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate convergence 
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n11_p20.per"
<br>save convergence reason "blr_n11_p20.cvr"
<br>save overview "blr_n11_p20.ovr" last
<br>save dr "blr_n11_p20.dr" last 
<br>#
<br># blr_n11_p20.in 
<br># class blr 
<br># ========================================
<br># 
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n11_p20_Z20.in</h2>  </kbd><h2><I>BLR model, density 1e11 cm-3, flux of H-ion phots 1e20 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e11 cm-3, flux of H-ion phots 1e20 cm2 s-1, Z=20
<br># 
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>#
<br># commands for density & abundances =========
<br>hden 11
<br>abundances starburst 20 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate convergence 
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n11_p20_Z20.per"
<br>save cooling "blr_n11_p20_Z20.col" 
<br>save convergence reason last "blr_n11_p20_Z20.cvr"
<br>save heating "blr_n11_p20_Z20.het" 
<br>save element calcium "blr_n11_p20_Z20.cal" 
<br>save overview "blr_n11_p20_Z20.ovr" 
<br>save dr "blr_n11_p20_Z20.dr" 
<br>save temperature history "blr_n11_p20_Z20.tem" 
<br>#
<br># blr_n11_p20_Z20.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
<p>
2010 dec 25
This sim obtains different results for Hb and Fe II with gcc and icc.  This is because the
sim is not fully converged.  Robin's & Peter's notes follow.  This will probably be trac ticket #191
<p>
results changed with trivial changes in the source - Peter's example follows;
This is due to lack of convergence rather than a fundamental difference in physics
r4426:
<p>
 Fe 2  2400A   6.854   1.9161
 Fe 2  6200A   6.827   1.8005
 Fe 2  2500A   6.984   2.5834
 Fe 2  2300A   7.101   3.3854
 Fe 2  8900A   6.714   1.3899
<p>
r4427:
<p>
 Fe 2  2400A   6.852   1.9092
 Fe 2  6200A   6.923   2.2472
 Fe 2  2500A   6.943   2.3504
 Fe 2  2300A   7.161   3.8897
 Fe 2  8900A   6.671   1.2574
<p>
Robin;
OK, I ran for 10 iterations with an old vs. new test on the cooling --
no substantial differences were reported.
<p>
The ne does seem to wander around quite a bit deep in the model,
rather than smoothly converge -- attached plot is for the last
iterations 5 to 10 (i.e. from when the code declares convergence in
the standard blr_... run onwards).  Not so bad as the difference plot
which Peter shows, but not great.  The temperature convergence seems
better.
<p>
Suggests to me this may be a problem with poor convergence
criteria/hysteresis, with the collisional cooling change just being
the butterfly.
<p>
there's also an unresolved drop in both ne and H+ around 8.5e11
cm in the first iteration, which might be worth trying to understand.
<p>
Peter:
It looks like there is a small thermal front in this model near the 
outer edge, though I derive this only from eyeballing the Te plot. 
They are quite common in blr models. It would also be a partial 
explanation of the jerky behavior of the code: gas near such a 
front will be quite sensitive to changes in cooling and/or heating 
since the curves are nearly parallel. It is however still
worthwhile asking whether we are exacerbating the problem by
writing the cooling terms in atom_leveln() the way we do.
<p>
Robin: 
Yes, there is a temperature front exactly at the rear of the slab (it
only appears in the later iterations).
<p>
email exhange on this was around 2010 dec 22 - 24 
<p>
</p><hr><kbd><h2>blr_n12_p19.in</h2>  </kbd><h2><I>BLR model, density 1e12 cm-3, flux of H-ion phots 1e19 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e12 cm-3, flux of H-ion phots 1e19 cm2 s-1
<br>#
<br># commands for density & abundances =========
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 19
<br>#
<br># commands controlling geometry  =========
<br>hden 12
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate convergence 
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n12_p19.per"
<br>save convergence reason last "blr_n12_p19.cvr"
<br>save overview "blr_n12_p19.ovr" last
<br>save dr "blr_n12_p19.dr" last 
<br>#
<br># 
<br># blr_n12_p19.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n12_p19_Z20.in</h2>  </kbd><h2><I>BLR model, density 1e12 cm-3, flux of H-ion phots 1e19 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e12 cm-3, flux of H-ion phots 1e19 cm2 s-1, Z=20
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 19
<br>#
<br># commands for density & abundances =========
<br>hden 12
<br>abundances starburst 20 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>failures 5 
<br>iterate convergence 
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n12_p19_Z20.per"
<br>save convergence reason "blr_n12_p19_Z20.cvr" 
<br>save overview "blr_n12_p19_Z20.ovr" last
<br>save dr "blr_n12_p19_Z20.dr" last 
<br>#
<br># blr_n12_p19_Z20.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n13_p18.in</h2>  </kbd><h2><I>BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1
<br>#
<br># this is a very low ionization cloud
<br># the conditions, and some lines, are surprisingly sensitive
<br># to the treatment of hydrogen molecules
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 18
<br>#
<br># commands for density & abundances =========
<br>hden 13
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate to convergence 
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>init "c84.ini"
<br>no level2 lines
<br>save performance "blr_n13_p18.per"
<br>save overview "blr_n13_p18.ovr" last
<br>save dr "blr_n13_p18.dr" last 
<br>save convergence reason "blr_n13_p18.cvr" 
<br>#
<br># blr_n13_p18.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n13_p18_Z20.in</h2>  </kbd><h2><I>BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
<br>#
<br># this is a very low ionization cloud
<br># the conditions, and some lines, are surprisingly sensitive
<br># to the treatment of hydrogen molecules
<br># extend stopping temperature to low values to cover full column density
<br>#
<br># commands controlling continuum =========
<br>phi(h) 18
<br>table agn
<br>#
<br># commands for density & abundances =========
<br>hden 13
<br>abundances starburst 20 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>stop temperature 1000
<br>#
<br># other commands for details     =========
<br># this sim needs roughly 10 iterations to converge 
<br>iterate convergence
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br># abort if too many failures occur - we want to pass this test
<br># failures 2 
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n13_p18_Z20.per"
<br>save overview "blr_n13_p18_Z20.ovr" last
<br>save overview "blr_n13_p18_Z20.ovr1"
<br>save dr "blr_n13_p18_Z20.dr" last 
<br>save convergence reason "blr_n13_p18_Z20.cvr" 
<br>save heating "blr_n13_p18_Z20.het"
<br>save cooling "blr_n13_p18_Z20.col"
<br>#
<br># 
<br># blr_n13_p18_Z20.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n13_p22.in</h2>  </kbd><h2><I>BLR model, density 1e13 cm-3, flux of H-ion phots 1e22 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e13 cm-3, flux of H-ion phots 1e22 cm2 s-1
<br># 
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>#
<br># commands for density & abundances =========
<br>hden 13
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate convergence 
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>print h-like departure hydrogen 
<br>print h-like departure helium 
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n13_p22.per"
<br>save convergence reason last "blr_n13_p22.cvr"
<br>save overview "blr_n13_p22.ovr" last
<br>save dr "blr_n13_p22.dr" last 
<br>#
<br># blr_n13_p22.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n13_p22_Z20.in</h2>  </kbd><h2><I>BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
</I></h2><kbd><br>title BLR model, density 1e13 cm-3, flux of H-ion phots 1e18 cm2 s-1, Z=20
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>#
<br># commands for density & abundances =========
<br>hden 13
<br>abundances starburst 20 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate convergence 
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n13_p22_Z20.per"
<br>save convergence reason last "blr_n13_p22_Z20.cvr"
<br>save overview "blr_n13_p22_Z20.ovr"
<br>save dr "blr_n13_p22_Z20.dr"
<br>save heating "blr_n13_p22_Z20.het"
<br>save cooling "blr_n13_p22_Z20.col"
<br>#
<br># blr_n13_p22_Z20.in 
<br># class blr 
<br># ========================================
</kbd><p>
This is one of the 5 models that sample the LOC plane.
</p><hr><kbd><h2>blr_n14_p18.in</h2>  </kbd><h2><I>BLR model, density 1e14 cm-3, flux of H-ion phots 1e18 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e14 cm-3, flux of H-ion phots 1e18 cm2 s-1
<br>#
<br># this is a very low ionization cloud
<br># the conditions, and some lines, are surprisingly sensitive
<br># to the treatment of hydrogen molecules
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 18
<br>#
<br># commands for density & abundances =========
<br>hden 14
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#stop efrac 0.1
<br>#
<br># other commands for details     =========
<br>iterate to convergence 
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 1215.67A 100 
<br>init "c84.ini"
<br>no level2 lines
<br>save performance "blr_n14_p18.per"
<br>save overview "blr_n14_p18.ovr" last
<br>save dr "blr_n14_p18.dr" last 
<br>save convergence reason "blr_n14_p18.cvr" 
<br>#
<br># blr_n14_p18.in 
<br># class blr 
<br># ========================================
</kbd><p>
</p><hr><kbd><h2>blr_n14_p20.in</h2>  </kbd><h2><I>BLR model, density 1e14 cm-3, flux of H-ion phots 1e20 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e14 cm-3, flux of H-ion phots 1e20 cm2 s-1
<br># 
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 20
<br>#
<br># commands for density & abundances =========
<br>hden 14
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate convergence 
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>print h-like departure hydrogen 
<br>print h-like departure helium 
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n14_p20.per"
<br>save convergence reason last "blr_n14_p20.cvr"
<br>save overview "blr_n14_p20.ovr" last
<br>save dr "blr_n14_p20.dr" last 
<br>#
<br># blr_n14_p20.in 
<br># class blr 
<br># ========================================
</kbd><p>
</p><hr><kbd><h2>blr_n14_p22.in</h2>  </kbd><h2><I>BLR model, density 1e14 cm-3, flux of H-ion phots 1e22 cm2 s-1
</I></h2><kbd><br>title BLR model, density 1e14 cm-3, flux of H-ion phots 1e22 cm2 s-1
<br># 
<br># commands controlling continuum =========
<br>table agn
<br>phi(h) 22
<br>#
<br># commands for density & abundances =========
<br>hden 14
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate convergence 
<br># these are to try to speed things up
<br>init "c84.ini"
<br>no level2 lines
<br>#
<br># commands controlling output    =========
<br>print h-like departure hydrogen 
<br>print h-like departure helium 
<br>normalize to "H  1" 1215.67A 100 
<br>save performance "blr_n14_p22.per"
<br>save convergence reason last "blr_n14_p22.cvr"
<br>save overview "blr_n14_p22.ovr" last
<br>save dr "blr_n14_p22.dr" last 
<br>#
<br># blr_n14_p22.in 
<br># class blr 
<br># ========================================
</kbd><p>
</p><hr><kbd><h2>blr_nf84.in</h2>  </kbd><h2><I>early model of blr
</I></h2><kbd><br>title early model of blr
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -1.92
<br>power law -1 100 0.01
<br>#
<br># commands for density & abundances =========
<br>hden 9.5
<br>init, file="ism.ini"
<br>abundances cameron
<br>stop lyman optical 6
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>constant gas pressure
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>save performance "blr_nf84.per"
<br>save overview last "blr_nf84.ovr"
<br>save convergence reason last "blr_nf84.cvr"
<br>save dr last "blr_nf84.dr"
<br>save results last "blr_nf84.rlt"
<br>#
<br># blr_nf84.in
<br># class blr 
<br># ========================================
<br># 
</kbd><p>
This is an example of a "conventional" BLR calculation. The parameters are
similar to those of Table 1 of Netzer and Ferland (1984).  Notice that the
ratio of Lyalpha to Hbeta ratio is much larger than observed.
<p>
>>refer	blr	model	Netzer, H., & Ferland, G. J. 1984, PASP, 96, 593  
<p>
</p><hr><kbd><h2>blr_nf84_45deg.in</h2>  </kbd><h2><I>early model of BLR, with illumination at 45 degree angle
</I></h2><kbd><br>title early model of BLR, with illumination at 45 degree angle
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -1.92
<br>power law -1 100 0.01
<br># this continuum is a beam coming in at 45 degrees 
<br>illumination angle 45 degrees
<br>#
<br># commands for density & abundances =========
<br>hden 9.5
<br>abundances cameron
<br>stop lyman optical 6
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>init file "ism.ini"
<br>constant gas pressure
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>save performance "blr_nf84_45deg.per"
<br>save overview "blr_nf84_45deg.ovr"
<br>save convergence reason last "blr_nf84_45deg.cvr"
<br>save dr "blr_nf84_45deg.dr"
<br>save results last "blr_nf84_45deg.rlt"
<br>#
<br># blr_nf84_45deg.in
<br># class blr 
<br># ========================================
<br># 
</kbd><p>
This is an example of a "conventional" BLR calculation. The parameters are
similar to those of Table 1 of Netzer and Ferland (1984).  Notice that the
ratio of Lyalpha to Hbeta ratio is much larger than observed.
<p>
>>refer	blr	model	Netzer, H., & Ferland, G. J. 1984, PASP, 96, 593  
<p>
</p><hr><kbd><h2>blr_rnfa.in</h2>  </kbd><h2><I>table 1 of Rees et al. ApJ 347, 648
</I></h2><kbd><br>title table 1 of Rees et al. ApJ 347, 648
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>init file="c84.ini"
<br>abundances he= -1 c= -3.328 n= -4.0088 o= -3.0809 ne= -4 na= -20
<br>continue mg= -4.3768 al= -5.5686 si= -4.36653 s= -4.76955 
<br>continue ar= -5.4202 ca= -5.6383 fe= -4.4815 ni= -20
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>normalize "H  1" 1215.67A = 100
<br>print line faint -1
<br>save performance "blr_rnfa.per"
<br>save overview last "blr_rnfa.ovr"
<br>save convergence reason last "blr_rnfa.cvr"
<br>save continuum last "blr_rnfa.con" units microns 
<br>save transmitted continuum last "blr_rnfa.trn" units rydbergs 
<br>save element nitrogen last "blr_rnfa.nit"
<br>save dr last "blr_rnfa.dr"
<br>save results last "blr_rnfa.rlt"
<br>#
<br># blr_rnfa.in
<br># class blr
<br># ========================================
<br># 
</kbd><p>
This is the lower density cloud computed in Rees et al. (1989). 
Table 1 of that paper lists the predictions, which were a mean of those
of Hagai Netzer's ION and roughly version 76 of CLOUDY.  The lines
are generally still in good agreement with the predictions of that paper. 
In particular the changes in the line fluxes shown in Figure 1
of that paper are reproduced quite well.
</p><hr><kbd><h2>blr_rnfb.in</h2>  </kbd><h2><I>table 1 of Rees et al. ApJ 347, 648
</I></h2><kbd><br>title table 1 of Rees et al. ApJ 347, 648
<br># 
<br># blr model from 
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 12
<br>init file="c84.ini"
<br>abundances he= -1 c= -3.328 n= -4.0088 o= -3.0809 ne= -4 na= -20
<br>continue mg= -4.3768 al= -5.5686 si= -4.36653 s= -4.76955 
<br>continue ar= -5.4202 ca= -5.6383 fe= -4.4815 ni= -20
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>print line faint -1
<br>print line optical depths
<br>save performance "blr_rnfb.per"
<br>save overview last "blr_rnfb.ovr"
<br>save convergence reason last "blr_rnfb.cvr"
<br>save element nitrogen last "blr_rnfb.nit"
<br>save dr last "blr_rnfb.dr"
<br>save results last "blr_rnfb.rlt"
<br>save line emissivity "blr_rnfb.ems"
<br>H  1 4861.32A
<br>blnd  8446
<br>blnd  1304
<br>end of lines
<br>normalize "H  1" 1215.67A = 91.8
<br>#
<br># blr_rnfb.in
<br># class blr 
<br># ========================================
<br># 
</kbd><p>
This is a very dense cloud, and was computed in Rees et al. (1989). 
Table 1 of that paper lists the predictions, which were a mean of those of
Hagai Netzer's ION and roughly version 76 of CLOUDY.  The lines are
generally still in good agreement with the predictions of that paper. 
In particular the changes in the line fluxes shown in Figure 1 of that
paper are reproduced quite well.  The fluxes of Lya and Hb are not
reproduced with great precision by this model because of changes in
collision rates for hydrogen and especially the form of the
escape probability function for subordinate lines.  As Figure 1 of
RNF showed the line intensities are very sensitive to density for
these parameters.
</p><hr><kbd><h2>chianti_all_cool.in</h2>  </kbd><h2><I>cooling of a collisionally ionized plasma
</I></h2><kbd><br>title cooling of a collisionally ionized plasma
<br>#
<br># commands controlling continuum =========
<br>cosmic rays, background
<br>coronal 4 vary
<br>grid 4 6 0.5 sequential
<br>database chianti "CloudyChiantiAll.ini" levels max
<br>species "Fe+" levels=all
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>set eden 0
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>save overview "chianti_all_cool.ovr"
<br>save performance "chianti_all_cool.per"
<br>save grid "chianti_all_cool.grd" last no hash
<br>save cooling "chianti_all_cool.col" last no hash
<br>save emitted continuum "chianti_all_cool.con" units angstroms
<br>#
</kbd><p>
</p><hr><kbd><h2>chianti_fe_cool.in</h2>  </kbd><h2><I>cooling of a collisionally ionized plasma
</I></h2><kbd><br>title cooling of a collisionally ionized plasma
<br>#
<br># commands controlling continuum =========
<br>cosmic rays, background
<br>coronal 4 vary
<br>database stout print
<br>database chianti "CloudyChiantiFe.ini" print
<br>species "Fe+" levels=all
<br>grid 4 6 0.5 sequential
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>init "honly.ini"
<br>element iron on
<br>element iron abundance 0
<br>set eden 0
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>save overview "chianti_fe_cool.ovr"
<br>save performance "chianti_fe_cool.per"
<br>save grid "chianti_fe_cool.grd" last no hash
<br>save cooling "chianti_fe_cool.col" last no hash
<br>save emitted continuum "chianti_fe_cool.con" units angstroms
<br>#
</kbd><p>
This tests the use of Chianti limited to Fe ions, and the Kurucz 
Fe III, IV, and V added by Matt Lykins
<p>
</p><hr><kbd><h2>coll_coronal.in</h2>  </kbd><h2><I>model of active region of solar corona
</I></h2><kbd><br>title model of active region of solar corona
<br>#
<br># commands controlling continuum =========
<br># temperature of corona
<br>coronal equilibrium, 2.5e6 K
<br># assume the sun is a blackbody at 5770K
<br>blackbody 5770 K
<br>luminosity solar linear 1 
<br>#
<br># commands for density & abundances =========
<br>hden log=10 
<br>#
<br># commands controlling geometry  =========
<br># its height above photosphere and thickness
<br>radius 11 thickness = 10
<br># the gas fully covers the center of symmetry
<br>sphere
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "o  8" 18.9689A 
<br>save overview "coll_coronal.ovr"
<br>save performance "coll_coronal.per"
<br>save dr "coll_coronal.dr" last
<br>save continuum "coll_coronal.con" last units angstroms
<br>#
<br># 
<br># coll_coronal.in
<br># class coronal 
<br># ========================================
<br># 
</kbd><p>
This is a rough model of the solar corona.
The test checks that the coronal equilibrium commands work.
The gas is predominantly collisionally ionized.
<p>
</p><hr><kbd><h2>coll_heat_only.in</h2>  </kbd><h2><I>test code in limit where ONLY mechanical heating is present
</I></h2><kbd><br>title test code in limit where ONLY mechanical heating is present
<br>#
<br># commands controlling continuum =========
<br>no photoionization
<br>blackbody 5000 STE 
<br>#
<br># commands controlling geometry  =========
<br>stop column density 15 
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># other commands for details     =========
<br>hextra -1.5
<br>iterate 
<br>#
<br># commands controlling output    =========
<br># this command must be tested somewhere
<br>print cooling, zone 5
<br># output files
<br>save performance "coll_heat_only.per"
<br>save overview "coll_heat_only.ovr"
<br>save heating "coll_heat_only.het"
<br>save cooling "coll_heat_only.col"
<br>save convergence reason "coll_heat_only.cvr"
<br>save dr "coll_heat_only.dr"
<br>save continuum "coll_heat_only.con"  units angstroms 
<br>#
<br>#  
<br># coll_heat_only.in
<br># class coronal 
<br># ========================================
</kbd><p>
This test is an optically thin collisionally ionized gas with no
photoionization at all. 
<p>
<p>
</p><hr><kbd><h2>coll_t3.in</h2>  </kbd><h2><I>coronal equilibrium at 10^3 K
</I></h2><kbd><br>title coronal equilibrium at 10^3 K
<br>#
<br># commands controlling continuum =========
<br>coronal 3  
<br># add component of cosmic rays to drive chemistry 
<br>cosmic ray background
<br>#
<br># other commands for details     =========
<br>iterate  
<br>#
<br># commands controlling geometry  =========
<br>stop column density 15 
<br>stop temperature off
<br>#
<br># commands for density & abundances =========
<br>hden 10  
<br>#
<br># other commands for details     =========
<br># this sim needs very precise convergence to get a reliable result
<br>set eden convergence tolerance 1e-4
<br>#
<br># commands controlling output    =========
<br>save performance "coll_t3.per"
<br>save overview "coll_t3.ovr" 
<br>save continuum "coll_t3.con"  units angstroms 
<br>save dominant rates "coll_t3.sulphur" "S"
<br>save dominant rates "coll_t3.molh2" "H2"
<br>save dominant rates "coll_t3.molh" "H"
<br>#
<br>#
<br># coll_t3.in
<br># class coronal  
<br># ========================================
</kbd><p>
This tests conditions of collisional equilibrium at low densities.
This is one of a series of sims coll_t?.in which test ionization
over a range of temperatures.  This one, unlike the others,
includes cosmic rays.  Chemistry is important at this low temperature
and the chemical network will collapse without a source of ionization.
The cosmic rays provide this source of ionization.
</p><hr><kbd><h2>coll_t3_grains.in</h2>  </kbd><h2><I>coronal equilibrium at 10^3 K, with grains to assist chemistry
</I></h2><kbd><br>title coronal equilibrium at 10^3 K, with grains to assist chemistry
<br>#
<br># commands controlling continuum =========
<br>coronal 1e3K
<br># add component of cosmic rays to drive chemistry 
<br>cosmic ray background
<br># >>chng 20 sep 19 test updated ISM abundances
<br>abundances "ISM-HD20.abn"
<br>set H2 Jura rate
<br>#
<br># other commands for details     =========
<br>iterate  
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># commands for density & abundances =========
<br>hden 4  
<br>#
<br># other commands for details     =========
<br># this sim needs very precise convergence to get a reliable result
<br>set eden convergence tolerance 1e-4
<br>#
<br># commands controlling output    =========
<br>save performance "coll_t3_grains.per"
<br>save overview "coll_t3_grains.ovr" 
<br>save continuum "coll_t3_grains.con"  units angstroms 
<br>#
<br>#
<br># coll_t3_grains.in
<br># class coronal  
<br># ========================================
</kbd><p>
This tests conditions of collisional equilibrium at low densities.
This is one of a series of sims coll_t?.in which test ionization
over a range of temperatures.  This one, unlike the others,
includes cosmic rays and grains.  Chemistry is important at this low temperature
and the chemical network will collapse without a source of ionization.
The cosmic rays provide this source of ionization.
</p><hr><kbd><h2>coll_t4.in</h2>  </kbd><h2><I>coronal equilibrium at 10^4 K
</I></h2><kbd><br>title coronal equilibrium at 10^4 K
<br>#
<br># commands controlling continuum =========
<br>coronal 4
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling geometry  =========
<br>stop column density 15 
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># commands controlling output    =========
<br>save performance "coll_t4.per"
<br>save overview "coll_t4.ovr" 
<br>save continuum "coll_t4.con"  units angstroms 
<br>#
<br>#
<br># coll_t4.in
<br># class coronal  
<br># ========================================
</kbd><p>
this tests conditions of collisional equilibrium at low densities
</p><hr><kbd><h2>coll_t4_Z30.in</h2>  </kbd><h2><I>coronal equilibrium at 10^4 K
</I></h2><kbd><br>title coronal equilibrium at 10^4 K
<br>#
<br># commands controlling continuum =========
<br>coronal 4
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling geometry  =========
<br>stop column density 15 
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>metals 30 
<br>#
<br># commands controlling output    =========
<br>save performance "coll_t4_Z30.per"
<br>save overview "coll_t4_Z30.ovr" 
<br>save continuum "coll_t4_Z30.con"  units angstroms 
<br>#
<br>#
<br># coll_t4_Z30.in
<br># class coronal  
<br># ========================================
</kbd><p>
This tests conditions of collisional equilibrium at low densities
and high metallicity, where H-O CX will strongly affect
ionization of H
<p>
This is the high Z mate to coll_t4.in
</p><hr><kbd><h2>coll_t5.in</h2>  </kbd><h2><I>coronal equilibrium at 10^5 K
</I></h2><kbd><br>title coronal equilibrium at 10^5 K
<br>#
<br># commands controlling continuum =========
<br>coronal 5
<br>#
<br># commands controlling geometry  =========
<br>stop column density 15 
<br># test the luminosity case
<br>radius 13 
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br>#
<br># commands controlling output    =========
<br># normalize to strong HeII line
<br>normalize to "He 2" 303.784A 
<br>save performance "coll_t5.per"
<br>save overview "coll_t5.ovr"
<br>save continuum "coll_t5.con" units angstroms 
<br>#
<br># coll_t5.in
<br># class coronal  
<br># ========================================
</kbd><p>
This is a test collisional ionization equilibrium
at 1e5 K.
</p><hr><kbd><h2>coll_t6.in</h2>  </kbd><h2><I>coronal equilibrium at 10^6 K
</I></h2><kbd><br>title coronal equilibrium at 10^6 K
<br>#
<br># commands controlling continuum =========
<br>coronal 6
<br>#
<br># commands controlling geometry  =========
<br>stop column density 15 
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># other commands for details     =========
<br>iterate 
<br>#
<br># commands controlling output    =========
<br>normalize to "c  5" 40.2678A 
<br># output files
<br>save performance "coll_t6.per"
<br>save overview "coll_t6.ovr"
<br>save continuum "coll_t6.con"  units angstroms 
<br>#
<br># coll_t6.in
<br># class coronal 
<br># ========================================
</kbd><p>
This test is an optically thin collisionally ionized gas.
<p>
<p>
</p><hr><kbd><h2>coll_t7.in</h2>  </kbd><h2><I>coronal equilibrium at 10^7 K
</I></h2><kbd><br>title coronal equilibrium at 10^7 K
<br>#
<br># commands controlling continuum =========
<br>coronal 7
<br>#
<br># commands controlling geometry  =========
<br>stop column density 15 
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># other commands for details     =========
<br>#
<br>normalize to "o  8" 18.9689A 
<br># commands controlling output    =========
<br>save performance "coll_t7.per"
<br>save overview "coll_t7.ovr"
<br>save continuum "coll_t7.con" units angstroms
<br>save cooling "coll_t7.col"
<br>save each cooling last "coll_t7.cole"
<br>save cooling each "coll_t7.cle"
<br>#
<br># coll_t7.in 
<br># class coronal 
<br># ========================================
</kbd><p>
Test with only collisional ionization at a
high temperature. 
</p><hr><kbd><h2>dynamics_orion_flow.in</h2>  </kbd><h2><I>Orion nebula blister with wind
</I></h2><kbd><br>title Orion nebula blister with wind
<br>#
<br># commands controlling continuum =========
<br>blackbody 40000
<br>phi(h) 13.0
<br>brems 6
<br>phi(h) 10
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>abundances hii region no grains
<br>grains orion no qheat single 
<br>#
<br># commands controlling geometry  =========
<br>wind -7 km/s advection
<br># this accounts for matter beyond end of the model
<br>double optical depths
<br>sphere 
<br>stop AV 5 
<br>stop temperature linear 5  
<br>#
<br># other commands for details     =========
<br>iterate 4
<br>magnetic field -4 
<br>cosmic rays background 
<br># this has no effect on dynamics, but is to desaturate the lines as per flow
<br>turbulence 8 km/sec no pressure
<br># try to speed up simulation without hurting dynamics
<br>init "fast.ini"
<br># use Bakes & Tielens heating
<br>set PAH Bakes 
<br>#
<br># commands controlling output    =========
<br># want to print line intensities are surface brightness, per arcsec^2
<br>print lines surface brightness arcsec
<br>print line faint -1.5
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save performance "dynamics_orion_flow.per"
<br>save overview "dynamics_orion_flow.ovr" no hash
<br>save hydrogen 21 cm "dynamics_orion_flow.21cm" no hash
<br>save dr "dynamics_orion_flow.dr" no hash
<br>save continuum last "dynamics_orion_flow.con" units microns no hash
<br>save pressure "dynamics_orion_flow.pre" no hash
<br>save heating "dynamics_orion_flow.het" no hash
<br>save cooling "dynamics_orion_flow.col" no hash
<br>save molecules "dynamics_orion_flow.mol" no hash
<br>save wind "dynamics_orion_flow.wnd" last 
<br>#
<br># dynamics_orion_flow.in
<br># class dynamics hii pdr
<br># ========================================
<br># 
</kbd><p>
This is a model similar in spirit to the blister geometry H+ region
model computed by Baldwin et al. (1991), but with a D-critical flow.
Many physical processes have been disabled to make this simulationn faster.
Grain physics is not done so the gas temperature is incorrect.  The
main purpose is to do a quick test of the dynamical flow with grain
opacities included.  The slow directory contains a full simulation
of a flow like Orion.
</p><hr><kbd><h2>dynamics_veryfast.in</h2>  </kbd><h2><I>very fast wind model
</I></h2><kbd><br>title very fast wind model
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br># this is a set of commands to speed up calc
<br>init file "fast.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop thickness 8.4
<br># this is a subsonic wind with advection 
<br>wind velo -5 advection
<br>#
<br># other commands for details     =========
<br># absolutely no convergence problems should occur 
<br>failures 1
<br># this degrades the continuum resolution by factor of 3, to
<br># speed up calc 
<br>set continuum resolution 3
<br>iterate 4
<br>#
<br># commands controlling output    =========
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save overview "dynamics_veryfast.ovr"
<br>save performance "dynamics_veryfast.per"
<br>save pressure last "dynamics_veryfast.pre"
<br>save total opacity last "dynamics_veryfast.opc"
<br>save ionizing continuum last "dynamics_veryfast.ion"
<br>save continuum last "dynamics_veryfast.con"
<br>save dr "dynamics_veryfast.dr"
<br>#
<br># 
<br># dynamics_veryfast.in 
<br># class dynamics  
<br># ========================================
<br># 
</kbd><p>
This is meant to be a very fast calculation to 
use when running extensive debug-enabled runtimes.
<p>
<p>
</p><hr><kbd><h2>dynamics_veryfast_rec.in</h2>  </kbd><h2><I>very fast wind model
</I></h2><kbd><br>title very fast wind model
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br># this is a set of commands to speed up calc
<br>init file "fast.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop thickness 8.4
<br># this is a subsonic wind with advection 
<br>wind velo 5 advection
<br>#
<br># other commands for details     =========
<br># absolutely no convergence problems should occur 
<br>failures 1
<br># this degrades the continuum resolution by factor of 3, to
<br># speed up calc 
<br>set continuum resolution 3
<br>iterate 4
<br>#
<br># commands controlling output    =========
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save overview "dynamics_veryfast_rec.ovr"
<br>save performance "dynamics_veryfast_rec.per"
<br>save pressure last "dynamics_veryfast_rec.pre"
<br>save total opacity last "dynamics_veryfast_rec.opc"
<br>save ionizing continuum last "dynamics_veryfast_rec.ion"
<br>save continuum last "dynamics_veryfast_rec.con"
<br>save dr "dynamics_veryfast_rec.dr"
<br>#
<br># 
<br># dynamics_veryfast_rec.in 
<br># class dynamics  
<br># ========================================
<br># 
</kbd><p>
This is meant to be a very fast calculation to 
use when running extensive debug-enabled runtimes.
<p>
<p>
</p><hr><kbd><h2>dynamics_wind.in</h2>  </kbd><h2><I>test of equations of motion in a very highly ionized wind
</I></h2><kbd><br>title test of equations of motion in a very highly ionized wind
<br># 
<br># test motion in electron scattering limit
<br># radiative acceleration (e- only) is 9.54E-7 cm s^-2
<br># terminal velocity (e- only) is 7.6 km s^-1 
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>luminosity (total) 45
<br># 
<br># commands for density & abundances =========
<br>hden 4
<br># this only includes H and He
<br>init file="hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>radius (parsecs) 1
<br>stop thickness (parsecs) -1
<br># a slow wind velocity, will assert velocity at outer radius
<br>wind velo 0.1 ball
<br>#
<br># other commands for details     =========
<br># this will speed things up a bit 
<br>no level2
<br>no radiation pressure
<br>constant temperature 8
<br>#
<br># commands controlling output    =========
<br>save overview "dynamics_wind.ovr"
<br>save performance "dynamics_wind.per"
<br>save pressure "dynamics_wind.pre"
<br>save wind "dynamics_wind.wnd"
<br>save dr "dynamics_wind.dr"
<br>#
<br># dynamics_wind.in
<br># class limit dynamics 
<br># ========================================
<br># 
</kbd><p>
This tests the radiative acceleration and terminal velocity of 
a wind in which only electron scattering is important.  The parameters
were chosen so that electron scattering is the dominant opacity source,
so that the equations can be solved both numerically (in the example)
and analytically (the expected solution given above).  In a realistic wind
the gas would be more neutral and line driving would dominate.  The force
multiplier, given in the save wind output, is nearly unity as a result.
<p>
<br>Checks:
<br>-	The radiative acceleration is correct (e- 9.543910-7 cm s-2).
<br>-	The terminal velocity should be 7.57 km s-1.
<br>-	Force multiplier near unity (no line driving since so highly ionized).
<br>-	Thickness of cloud correct (R-Ro + dr/2 should be 3.086391017 cm).
<p>
</p><hr><kbd><h2>feii_hin.in</h2>  </kbd><h2><I>test feii in high density limit
</I></h2><kbd><br>title test feii in high density limit
<br>#
<br># commands controlling continuum =========
<br>black 25000 K
<br>ionization -10
<br>#
<br># commands for density & abundances =========
<br>hden 18
<br># force a high electron density to insure collisions dominate
<br>eden 18
<br>#
<br># commands controlling geometry  =========
<br>constant tempera 4
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>species "Fe+" levels=all
<br>iterate
<br># want to test collision only limit 
<br>no induced processes
<br>#
<br># commands controlling output    =========
<br>set save prefix "feii_hin"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species continuum ".fe2con" "Fe+" last units microns
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last
<br>#
<br>#
<br># feii_hin.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks that, at high particle densitites, in which
the gas should be in collisional
equilibrium, the level populations of the large model Fe+ ion
go to the proper values, where the departure coefficients
are all equal to unity.
<p>
<p>
</p><hr><kbd><h2>feii_hirad.in</h2>  </kbd><h2><I>feii in case of high radiation density limit
</I></h2><kbd><br>title feii in case of high radiation density limit
<br>#
<br># commands controlling continuum =========
<br>black 8000 K lte 
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br>element iron abundance 2
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>species "Fe+" levels=all
<br>constant tempera 8000
<br>iterate
<br>#
<br># commands controlling output    =========
<br>set save prefix "feii_hirad"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species densities ".lv1" "Fe+[:200]" last
<br>save species densities ".lv2" "Fe+[201:]" last
<br>save species continuum ".fe2con" "Fe+" last units microns
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last
<br>#
<br>#
<br># feii_hirad.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks that, at high radiation densitites, in which
the gas is irradiated by a blackbody in strict thermodynamic
equilibrium, the level populations of the large model Fe+ ion
go to the proper values, where the departure coefficients
are all equal to unity.
<p>
</p><hr><kbd><h2>feii_pump.in</h2>  </kbd><h2><I>test feii in continuum pumped limit
</I></h2><kbd><br>title test feii in continuum pumped limit
<br>#
<br># commands controlling continuum =========
<br>black 25000 K
<br>ionization -5
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>abundances old solar 84 
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>Case B
<br>iterate 
<br>constant tempera 4
<br>species "Fe+" levels=all 
<br>#
<br># commands controlling output    =========
<br>set save prefix "feii_pump"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species continuum ".con" "Fe+" units microns last  
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last
<br>#
<br>#
<br># feii_pump.in
</kbd><p>
This is a constant temperature low ionization
cloud, with BLR-like densities, which includes the
large FeII atom.  The tests check on the emission
predicted in the Fe II bands.
<p>
This model tests the large FeII model in the optically thin,
continuum pumped limit.  The zone thickness is set to a
small value (1 cm) so that full continuum hits atom.
<p>
</p><hr><kbd><h2>feii_ste.in</h2>  </kbd><h2><I>thermal equilibrium of FeII in STE limit
</I></h2><kbd><br>title thermal equilibrium of FeII in STE limit
<br>#
<br># commands controlling continuum =========
<br>black 8000 K lte 
<br>hden 9
<br>#
<br># commands for density & abundances =========
<br>element iron abundance 2
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>species "Fe+" levels=all
<br>iterate
<br>#
<br># commands controlling output    =========
<br>set save prefix "feii_ste"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save continuum last ".con"
<br>save species column density last ".col" "Fe+"
<br>save species densities last ".pop" "Fe+[:]"
<br>save species departure last ".dep" "Fe+[:]"
<br>save species levels last ".lev" "Fe+"
<br>save species continuum ".fe2con" "Fe+" last units microns
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last
<br>#
<br># feii_ste.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. It is irradiated by a blackbody in strict
thermodynamic equilibrium.  We check that the temperature
of the gas is equal to the radiation temperature, to confirm
that the thermal properties of the model FeII atom obey thermodynamics.
 
</p><hr><kbd><h2>feii_t4n0.in</h2>  </kbd><h2><I>FeII emission in typical intermediate density photoionzied cloud
</I></h2><kbd><br>title FeII emission in typical intermediate density photoionzied cloud
<br>#
<br># commands controlling continuum =========
<br>black 5e5K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>element iron abundance 2
<br>element iron ionization -7 0 -7
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>species "Fe+" levels=all
<br>#
<br># commands controlling output    =========
<br>print lines column 
<br>print line inward
<br>print line sort wavelength
<br>print line faint 0.1
<br>normalize "Fe 2b" 5270
<br>set save prefix "feii_t4n0"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species continuum last ".con" "Fe+" units angstroms
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last no hash
<br>#
<br>#
<br># feii_t4n0.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. it has a low density and unit thickness
<p>
The model is optically thin, no RT.
</p><hr><kbd><h2>feii_t4n8.in</h2>  </kbd><h2><I>FeII emission in typical intermediate density photoionzied cloud
</I></h2><kbd><br>title FeII emission in typical intermediate density photoionzied cloud
<br>#
<br># commands controlling continuum =========
<br>black 5e5K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 8
<br>element iron abundance 2
<br>element iron ionization -7 0 -7
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>species "Fe+" levels=all
<br>#
<br># commands controlling output    =========
<br>print lines column 
<br>print line inward
<br>print line sort wavelength
<br>print line faint 0.1
<br>normalize "Fe 2b" 5270
<br>set save prefix "feii_t4n8"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species continuum last ".con" "Fe+" units angstroms
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last no hash
<br>#
<br>#
<br># feii_t4n8.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. it has a low density and unit thickness
<p>
The model is optically thin, no RT.
</p><hr><kbd><h2>feii_t4n8_rt.in</h2>  </kbd><h2><I>FeII emission in typical intermediate density photoionzied cloud
</I></h2><kbd><br>title FeII emission in typical intermediate density photoionzied cloud
<br>#
<br># commands controlling continuum =========
<br>black 5e5K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 8
<br>element iron abundance 2
<br>element iron ionization -7 0 -7
<br>#
<br># commands controlling geometry  =========
<br>stop thickness 5
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>species "Fe+" levels=all
<br>iterate 3
<br>#
<br># commands controlling output    =========
<br>print line precision 6
<br>print lines column 
<br>print line inward
<br>print line sort wavelength
<br>print line faint 0.1
<br>normalize "Fe 2b" 5270
<br>set save prefix "feii_t4n8_rt"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species continuum last ".con" "Fe+" units angstroms
<br>save species inward continuum last ".cin" "Fe+" units angstroms
<br>save species outward continuum last ".cout" "Fe+" units angstroms
<br>save species column density last ".col" "Fe+[:]"
<br>save species densities last ".pop" "Fe+[:]"
<br>save species optical depth last ".opt" "Fe+"
<br>save species lines last ".lin" "Fe+"
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+"
<br>save line emissivity ".ems"
<br>"Fe 2b" 2797
<br>"InwdBnd" 2797 
<br>end of lines
<br>#
<br>#
<br># feii_t4.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. it has intermediate density and should produce
and FeII spectrum something like an AGN.
 
The set line precision 6 increases the number of significant figures
in the wavelengths for each line.  This is needed to get the right
FeII inward band.
<p>
This has a finite thickness and so tests the RT, line overlap.
</p><hr><kbd><h2>feii_t4n8_Smyth19.in</h2>  </kbd><h2><I>FeII emission in typical intermediate density photoionzied cloud
</I></h2><kbd><br>title FeII emission in typical intermediate density photoionzied cloud
<br>species "Fe+" dataset="Smyth19"
<br>database Stout print
<br>#
<br># commands controlling continuum =========
<br>black 5e5K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 8
<br>element iron abundance 2
<br>element iron ionization -7 0 -7
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>species "Fe+" levels=all
<br>#
<br># commands controlling output    =========
<br>print lines column 
<br>print line inward
<br>print line sort wavelength
<br>print line faint 0.1
<br>normalize "Fe 2b" 5270
<br>set save prefix "feii_t4n8_Smyth19"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species continuum last ".con" "Fe+" units angstroms
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last no hash
<br>#
<br>#
<br># feii_t4n8_Tayal18.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. it has a low density and unit thickness
<p>
The model is optically thin, no RT.
</p><hr><kbd><h2>feii_t4n8_Tayal18.in</h2>  </kbd><h2><I>FeII emission in typical intermediate density photoionzied cloud
</I></h2><kbd><br>title FeII emission in typical intermediate density photoionzied cloud
<br>species "Fe+" dataset="Tayal18"
<br>database Stout print
<br>#
<br># commands controlling continuum =========
<br>black 5e5K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 8
<br>element iron abundance 2
<br>element iron ionization -7 0 -7
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>species "Fe+" levels=all
<br>#
<br># commands controlling output    =========
<br>print lines column 
<br>print line inward
<br>print line sort wavelength
<br>print line faint 0.1
<br>normalize "Fe 2b" 5270
<br>set save prefix "feii_t4n8_Tayal18"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species continuum last ".con" "Fe+" units angstroms
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last no hash
<br>#
<br>#
<br># feii_t4n8_Tayal18.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. it has a low density and unit thickness
<p>
The model is optically thin, no RT.
</p><hr><kbd><h2>feii_t4n8_Verner99.in</h2>  </kbd><h2><I>FeII emission in typical intermediate density photoionzied cloud
</I></h2><kbd><br>title FeII emission in typical intermediate density photoionzied cloud
<br>species "Fe+" dataset="Verner99"
<br>database Stout print
<br>#
<br># commands controlling continuum =========
<br>black 5e5K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 8
<br>element iron abundance 2
<br>element iron ionization -7 0 -7
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>species "Fe+" levels=all
<br>#
<br># commands controlling output    =========
<br>print lines column 
<br>print line inward
<br>print line sort wavelength
<br>print line faint 0.1
<br>normalize "Fe 2b" 5270
<br>set save prefix "feii_t4n8_Verner99"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save species continuum last ".con" "Fe+" units angstroms
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last no hash
<br>#
<br>#
<br># feii_t4n8_Tayal18.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This model has a very high iron abundance, 100x H, and most Fe is
in the form of Fe+. it has a low density and unit thickness
<p>
The model is optically thin, no RT.
</p><hr><kbd><h2>func_abund_fluc.in</h2>  </kbd><h2><I>check fluctuating heavy-element abundances 
</I></h2><kbd><br>title check fluctuating heavy-element abundances 
<br># commands controlling continuum =========
<br>blackbody 5
<br>ionization -2
<br># 
<br># commands for density & abundances =========
<br>hden 3
<br># this varies the abundnaces between default and 1e-4 times default,
<br># over a 1e10 cm period - we will compute half a cycle
<br>fluctuations abundances 10.3 0 -4
<br># 
<br># commands controlling geometry  =========
<br># stop at half a cycle so pick off lowest abundances
<br>stop thickness 10
<br># 
<br># other commands for details     =========
<br># speed things up a bit
<br>init "c84.ini"
<br>#
<br># commands controlling output    =========
<br>print column density
<br>save performance "func_abund_fluc.per"
<br>save overview "func_abund_fluc.ovr"
<br>save abundances "func_abund_fluc.abn"
<br>#
<br># commands giving asserts
<br>#
<br># func_abund_fluc.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This checks that the variable abundances option works
<p>
</p><hr><kbd><h2>func_distance.in</h2>  </kbd><h2><I>check that distance and "print flux earth" commands work 
</I></h2><kbd><br>title check that distance and "print flux earth" commands work 
<br>#
<br># commands controlling continuum =========
<br># luminosity in ionizing radiation, this and distance
<br># were chosen so that flux at earth assocated with total
<br># luminoisity of object is 1 erg cm-2 s-1 
<br>luminosity 40
<br>laser 2
<br>#
<br># must test capabiliites somewhere
<br># >>19 07 09, add abundances
<br>abundances "palme14-Sol.abn"
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br># >>19 07 09, add abundances
<br># init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>radius 17
<br>#
<br># other commands for details     =========
<br>distance 19.450395
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br># give flux at Earth
<br>print lines, flux at Earth
<br>save overview "func_distance.ovr"
<br>save performance "func_distance.per"
<br>#
<br># func_distance.in 
<br># class function 
<br># ========================================
<br># 
</kbd><p>
Normally the code predicts the intensity or luminosity of
the emission lines.  This test confirms that it can predict
the flux recieved at the Earth instead.  The model is the simplest
and fastest that can be computed - a H-only constant temperature
single zone.  The total luminosity is set to 1e40 erg/s, and the
ionization source is a laser at 2 ryd.  With these set, the
total luminosity in ionizing radiation, the total luminoisity in
the incident continuum (the emission line labeled "Inci 0") will be 1e40.
<p>
The code will predict the flux at the Earth if both the distance to the
oject is specified with the distance command, and this is requested with
the print flux earth command.  The distance was chosen so that the
total flux at the Earth will be 1 erg/s.  This is asserted at the
end of the calculation.
<p>
</p><hr><kbd><h2>func_dlaw.in</h2>  </kbd><h2><I>test model with dlaw table
</I></h2><kbd><br>title test model with dlaw table
<br>#
<br># commands controlling continuum =========
<br>phi(H) 15
<br>table agn
<br>#
<br># commands for density & abundances =========
<br>dlaw table radius
<br>continue 16 9
<br>continue 17 7
<br>continue 18 5
<br>continue 19 3
<br>continue 20 1
<br>continue 21 -1
<br>end of dlaw
<br>#
<br># must test capabiliites somewhere
<br># >>19 07 09, add abundances
<br>abundances "palme14-Met.abn"
<br>#init "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>filling factor -5
<br>radius 17 20
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>save overview "func_dlaw.ovr"
<br>save performance "func_dlaw.per"
<br>save dr "func_dlaw.dr"
<br>save overveiw "func_dlaw.ovr"
<br>#
<br>#
<br># func_dlaw.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
this model tests the dlaw density table command 
<p>
<p>
<p>
</p><hr><kbd><h2>func_fulltrace.in</h2>  </kbd><h2><I>test full trace output
</I></h2><kbd><br>title test full trace output
<br>#
<br># commands controlling continuum =========
<br>trace h-like hydrogen full no print
<br># check that no uninitialized rates are printed (r2757) 
<br>print arrays ionization carbon only
<br>print arrays levels "C[1:5]"
<br>stop zone 1
<br>table agn
<br>ionization parameter -0.5
<br>#
<br># commands for density & abundances =========
<br>hden 9.5
<br>init file="honly.ini"
<br>element carbon on 
<br>#
<br># other commands for details     =========
<br>database h-like element hydrogen collapsed levels 1 
<br>#
<br># commands controlling output    =========
<br># func_fulltrace.in
<br># class function 
<br># ========================================
</kbd><p>
this checks that trace output functions correctly
</p><hr><kbd><h2>func_globule.in</h2>  </kbd><h2><I>test of globule command
</I></h2><kbd><br>title test of globule command
<br>#
<br># commands controlling continuum =========
<br>black 40000 K
<br>ionization parameter -1.5
<br>#
<br># commands for density & abundances =========
<br>globule initial density=5 scale depth=14 
<br>init file "ism.ini"
<br>abundances hii region no qheat 
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 2
<br>#
<br># commands controlling output    =========
<br>print line faint -1.5
<br>save performance "func_globule.per"
<br>save overview last "func_globule.ovr"
<br>save results last "func_globule.rlt"
<br>save dr "func_globule.dr" last
<br>save heating "func_globule.het" last
<br>save cooling "func_globule.col" last
<br>#
<br># func_globule.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
<p>
This model uses the globule command, tests that the zoning logic
works for this extreme case, and that the code is able to converge
the globule model.
<p>
</p><hr><kbd><h2>func_grid_line_ratios.in</h2>  </kbd><h2><I>test generating line ratios in a grid run
</I></h2><kbd><br>title test generating line ratios in a grid run
<br># 
<br># commands controlling continuum =====
<br>blackbody 4e4 K
<br>ionization parameter -2
<br># 
<br># commands for density & abundances =====
<br># these are to speed up the calculation, only do H, O, and Ne
<br>init "honly.ini"
<br>element oxygen on  
<br>element neon on  
<br>element sulphur on  
<br>element oxygen ionization 1 1 1
<br>element neon ionization 1 1 1 
<br>element sulphur ionization 1 1 1
<br># vary the hydrogen density
<br>hden 4 vary
<br>grid 2 6.1 1 sequential
<br># 
<br># other commands for details =======
<br># these are constant temperature models, vary T
<br>constant temperature 4 vary
<br>grid 4000 17000 3000 linear
<br>stop zone 1 
<br>#
<br># commands controlling output =====
<br>save overview "func_grid_line_ratios.ovr"
<br>save performance "func_grid_line_ratios.per"
<br>save line list "func_grid_line_ratios.pun" "func_grid_line_ratios.dat" ratio no hash
<br>save grid "func_grid_line_ratios.grd"
<br>#
<br># commands giving (lack of) assert ==========
<br>#
<br># func_grid_line_line_ratios.in
<br># class function
<br># ===================================================
</kbd><p>
This uses the grid command to compute line ratios for a wide range of
density and temperature.  The ionization is set to a uniform value and
only a few elements are included.  this makes the calculation faster
and prevents recombination [O III] 4363 from becoming important (there
is no O+3).
<p>
These are the line ratios mentioned as limits in the Johnstone et al.
Spitzer cooling flow filament paper (2007).
</p><hr><kbd><h2>func_grid_list.in</h2>  </kbd><h2><I>test the 'list' keyword on the grid command
</I></h2><kbd><br>title test the 'list' keyword on the grid command
<br>blackbody 10000 STE vary
<br>grid list "func_grid_list.dat" linear sequential
<br>hden 5
<br>stop zone 1
<br>iterate 2
<br>****************
</kbd><p>
This is a simple grid with parameter values stored in an external file.
That file is also used to monitor the temperature of each grid point.
<p>
</p><hr><kbd><h2>func_hotgas_coolstar.in</h2>  </kbd><h2><I>test very soft continuum, very hot gas
</I></h2><kbd><br>title test very soft continuum, very hot gas
<br>#
<br># commands controlling continuum =========
<br># put in the cosmic background as the only continuum source 
<br>CMB  
<br># gas has constant temperature of 1e6 K
<br>constant temperature, t=6
<br>#
<br># commands for density & abundances =========
<br>hden 10.
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br># specify a thin cell of gas - 1 cm thick
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br># iterate since gas is optically thin
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save overview "func_hotgas_coolstar.ovr"
<br>save performance "func_hotgas_coolstar.per"
<br>#
<br># func_hotgas_coolstar.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a test where the CMB is the only continuum source.
It does not extend to energies where the
code needs to work.  There are special cases 
used in this situation, for continuum addressing,
so this checks whether those still function.
</p><hr><kbd><h2>func_ion_increase.in</h2>  </kbd><h2><I>test model where ionization increases with depth
</I></h2><kbd><br>title test model where ionization increases with depth
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -4
<br>table agn
<br>#
<br># commands for density & abundances =========
<br>hden 7 -4
<br>init "hheonly.ini"
<br>element oxygen on  
<br>element iron on  
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>filling factor -5
<br>radius 17 20
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>save overview "func_ion_increase.ovr"
<br>save performance "func_ion_increase.per"
<br>save dr "func_ion_increase.dr"
<br>save overveiw "func_ion_increase.ovr"
<br>save element oxygen "func_ion_increase.oxy"
<br>save element iron "func_ion_increase.fe"
<br>#
<br>#
<br># func_ion_increase.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This density falls off faster than 1/r^2 so the ionization increases
with depth.  Most sims have decreasing rather than increasing ionization.
<p>
<p>
<p>
</p><hr><kbd><h2>func_LineList_BLR.in</h2>  <br>test
<br>print line precision 6
<br>table lines "LineList_BLR.dat"
</kbd><p>
</p><hr><kbd><h2>func_LineList_BLR_Fe2.in</h2>  <br>test
<br>print line precision 6
<br>table lines "LineList_BLR_Fe2.dat"
<br>set save prefix "func_LineList_BLR_Fe2"
<br>save species bands ".fe2b" "FeII_bands.ini" "Fe+" last
</kbd></p><hr><kbd><h2>func_LineList_He_like.in</h2>  <br>test
<br>print line precision 6
<br>table lines "LineList_He_like.dat"
</kbd><p>
</p><hr><kbd><h2>func_LineList_HeH.in</h2>  <br>test
<br>print line precision 6
<br>table lines "LineList_HeH.dat"
</kbd><p>
</p><hr><kbd><h2>func_LineList_HII.in</h2>  <br>test
<br>print line precision 6
<br>table lines "LineList_HII.dat"
</kbd><p>
</p><hr><kbd><h2>func_LineList_NLR.in</h2>  <br>test
<br>print line precision 6
<br>table lines "LineList_NLR.dat"
</kbd><p>
</p><hr><kbd><h2>func_LineList_PDR.in</h2>  </kbd><h2><I>check that wavelengths agree at high line precision
</I></h2><kbd><br>title check that wavelengths agree at high line precision
<br>test
<br>print line precision 6
<br>table lines "LineList_PDR.dat"
</kbd><p>
</p><hr><kbd><h2>func_LineList_PDR_H2.in</h2>  </kbd><h2><I>check that wavelengths agree at high line precision
</I></h2><kbd><br>title check that wavelengths agree at high line precision
<br>test
<br>database h2
<br>print line precision 6
<br>table lines "LineList_PDR_H2.dat"
</kbd><p>
</p><hr><kbd><h2>func_LineList_strong.in</h2>  <br>test
<br>print line precision 6
<br>table lines "LineList_strong.dat"
</kbd><p>
</p><hr><kbd><h2>func_lines.in</h2>  </kbd><h2><I>create output file with list of func_lines
</I></h2><kbd><br>title create output file with list of func_lines
<br>print line precision 6 
<br>database h2 levels large 
<br>species "Fe+" levels=all 
<br># report all species in use
<br>database print
<br>test
<br>#
<br># commands controlling continuum =========
<br># commands for density & abundances =========
<br># commands controlling geometry  =========
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br># this creates the file "func_lines.lab" that contains a list
<br># of all emission labels
<br>save overview "func_lines.ovr"
<br>save performance "func_lines.per"
<br>save line labels "func_lines.lab"
<br># the save species xxx series of line-related reports
<br>save species labels "func_lines.spclab" all
<br>save species lines "func_lines.spclin" all
<br>save species levels units wavenumber "func_lines.spclev" all
<br># this must come last since code stops after doing it
<br># this creates the file "func_lines.lis" that contains a list
<br># of the emission func_lines that are transported. 
<br>save line data "func_lines.lis"
<br># 
<br># There is nothing extra to assert, since test does include many asserts
<br># 
<br># func_lines.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This runs the standard "test" case, and then creates
the line data and labels files.	 Test by itself includes
many asserts, so no further asserts are needed here.
<p>
The file func_lines.lab is a useful list of all lines predicted by the code.
Cut and paste this into other places when you need to find a particular
emission line.
<p>
The func_lines lines.dat gives atomic data for all the lines, and their
critical density at 10000 K.
The large H2 and Fe II model atoms are turned on to include their lines. 
<p>
</p><hr><kbd><h2>func_ly_pump_scale.in</h2>  </kbd><h2><I>test scaling of H lyman-line pumping
</I></h2><kbd><br>title test scaling of H lyman-line pumping
<br>sphere
<br>blackbody 30000
<br>q(h) 47
<br>hden 2.5
<br>radius 16
<br>stop zone 1
<br>database H-like Lyman pumping scale .2
</kbd><p>
This purpose of this test is just to exercise the option
to scale the H lyman series pumping rates by some factor.
</p><hr><kbd><h2>func_map.in</h2>  </kbd><h2><I>map of heating vs cooling
</I></h2><kbd><br>title map of heating vs cooling
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -2.5
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>abundances old solar 84 
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop lyman optical depth -7
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br># save map information to generate plot for hazy
<br>save overview "func_map.ovr"
<br>save performance "func_map.per"
<br>save map file="func_map.dta"
<br>set nmaps 100
<br>#
<br># map.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This is a test of the continuity of the code over a very large range
of temperature. It was used to produce one of the thermal maps shown in Hazy.
<p>
<br>Checks:
<br>-	No breaks in the heating and cooling curves where
	various approximations change.
<p>
</p><hr><kbd><h2>func_nolight.in</h2>  </kbd><h2><I>check OK with no radiation incident
</I></h2><kbd><br>title check OK with no radiation incident
<br>constant temp 5e7 linear
<br>hden 7 log
<br>set dr 0
<br>stop zone 1
<br>#
<br>save performance "func_nolight.per"
<br>save dr "func_nolight.dr"
<br>save overveiw "func_nolight.ovr"
<br>#
<br>#
<br># func_nolight.in
<br># class function
<br># ========================================
<br>#
</kbd><p>
Check that we handle limit where there is no incident radiation field
</p><hr><kbd><h2>func_sdrmin.in</h2>  </kbd><h2><I>test set drmin command
</I></h2><kbd><br>title test set drmin command
<br>#
<br># commands controlling continuum =========
<br>blackbody 8e4
<br>luminosity 37.5
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>#
<br># commands controlling geometry  =========
<br>radius 17
<br>sphere
<br>stop thickness 17.03
<br>stop temperature off
<br>#
<br># other commands for details     =========
<br>set drmin 15.5
<br>cosmic rays background
<br>#
<br># commands controlling output    =========
<br>save overview "func_sdrmin.ovr"
<br>save performance "func_sdrmin.per"
<br>save dr "func_sdrmin.dr" last
<br>#
</kbd><p>
This simulation tests the SET DRMIN command. It is a toy model of a planetary
nebula that is designed to extend into the PDR. The minimum stepsize is
deliberately set much too large so that we would immediately notice if the
command was broken. It also tests if we still hit the correct outer radius
when SET DRMIN is used. Without the SET DRMIN command this sim would need
410 zones (trunk@2760).
</p><hr><kbd><h2>func_set_ion.in</h2>  </kbd><h2><I>test impact of setting ionization 
</I></h2><kbd><br>title test impact of setting ionization 
<br>#
<br># commands for density & abundances =========
<br>init "ism.ini" 
<br>hden 0 
<br>element hydrogen ionization 0 1 
<br>element helium ionization 0 1 0 
<br>element carbon ionization 0 1 
<br>element oxygen ionization 0 0.1 0.2 0.3 0.2 0.1 0.1  
<br>element iron ionization -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 0 -9 -9
<br>#
<br># commands controlling continuum =========
<br>blackbody 5
<br>ionization parameter -2
<br>#
<br># commands controlling geometry  =========
<br># force model to be 1 cm thick
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>stop zone 1
<br>#
<br># commands controlling output    =========
<br>normalize to "o  3"  5006.84 
<br>save overview "func_set_ion.ovr"
<br>save performance "func_set_ion.per"
<br>save dr "func_set_ion.dr" 
<br>#
<br># 
<br># func_set_ion.in
</kbd><p>
# class function 
# ========================================
# 
 
this script exercies the option to specify the ionization of a species
</p><hr><kbd><h2>func_stopcol.in</h2>  </kbd><h2><I>test stop column density "species" command
</I></h2><kbd><br>title test stop column density "species" command
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -2
<br>blackbody 50000
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>init file "ism.ini"
<br># test option to turn off elements with small abundances
<br>element limit off -5
<br>#
<br># commands controlling geometry  =========
<br># stop calc at line ratio, the point of this test 
<br>stop column density "N+2" 10.
<br>#
<br># other commands for details     =========
<br>constant temperature 10000 K
<br>#
<br># commands controlling output    =========
<br>set save prefix "func_stopcol"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save dr ".dr" last
<br>#
<br>#
<br>#
<br>#
<br># func_stopcol.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This is an example of a simple calculation that stops when
a column density of a species reaches a specific value.
The tricky part is that the species label contains a number, so
we need to ascertain that the column density is parsed correctly.
</p><hr><kbd><h2>func_stopline1.in</h2>  </kbd><h2><I>test stop line command
</I></h2><kbd><br>title test stop line command
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -2
<br>blackbody 50000
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>abundances old solar 84 
<br>init file "ism.ini"
<br># test option to turn off elements with small abundances
<br>element limit off -5
<br>#
<br># commands controlling geometry  =========
<br># stop calc at line ratio, the point of this test 
<br>stop line "c  2" 157.636m reaches 0.0358 
<br>#
<br># other commands for details     =========
<br>constant temperature 10000 K
<br>#
<br># commands controlling output    =========
<br>save overview "func_stopline1.ovr"
<br>save performance "func_stopline1.per"
<br>save dr "func_stopline1.dr" last
<br>#
<br># func_stopline1.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This is an example of a simple calculation that stops when
a line reaches a specified intensity.
The option to turn off elements with trivial abundances is used.
</p><hr><kbd><h2>func_stopline2.in</h2>  </kbd><h2><I>test stop line command
</I></h2><kbd><br>title test stop line command
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -2
<br>blackbody 50000
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>abundances old solar 84 
<br>init file "ism.ini"
<br>#
<br># commands controlling geometry  =========
<br># stop calc at line ratio, the point of this test 
<br>stop line "c  2" 157.636m reaches 0.002 relative to "o  3"  5006.84 A
<br>#
<br># other commands for details     =========
<br>constant temperature 10000 K
<br>#
<br># commands controlling output    =========
<br>normalize to "o  3"  5006.84 
<br>save overview "func_stopline2.ovr"
<br>save performance "func_stopline2.per"
<br>save dr "func_stopline2.dr" last
<br>#
<br># func_stopline2.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
this is an example of a simple calculation that stops when
a certain emission line ratio is reached
<p>
</p><hr><kbd><h2>func_t10.in</h2>  </kbd><h2><I>test very soft continuum, very hot gas
</I></h2><kbd><br>title test very soft continuum, very hot gas
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameters -2
<br>#
<br># commands for density & abundances =========
<br>hden 1.
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br># specify a thin cell of gas - 1 cm thick
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br># set constant temperature to high-T limit
<br>constant temperature, t=10 log 
<br># iterate since gas is optically thin
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save overview "func_t10.ovr"
<br>save performance "func_t10.per"
<br>#
<br># 
<br># func_t10.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a test of the highest temperature the code can do.
<p>
</p><hr><kbd><h2>func_t3.in</h2>  </kbd><h2><I>test low temperature limit of code, 3K
</I></h2><kbd><br>title test low temperature limit of code, 3K
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameters -2
<br>#
<br># commands for density & abundances =========
<br>hden -1
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br># specify a thin cell of gas 1 cm thick
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br># set constant temperature to low-T limit
<br>constant temperature, t=3.0 linear 
<br># iterate since gas is optically thin
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save overview "func_t3.ovr"
<br>save performance "func_t3.per"
<br>#
<br>#
<br># 
<br># func_t3.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a test of the lowest temperature the code can do.
It runs a constant temperature of 3K
<p>
</p><hr><kbd><h2>func_t3_linesintroff.in</h2>  </kbd><h2><I>test low temperature limit of code, 3K
</I></h2><kbd><br>title test low temperature limit of code, 3K
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameters -2
<br>#
<br># commands for density & abundances =========
<br>hden -1
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br># specify a thin cell of gas 1 cm thick
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br># set constant temperature to low-T limit
<br>constant temperature, t=3.0 linear 
<br># iterate since gas is optically thin
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print lines intrinsic off
<br>set save prefix "func_t3_linesintroff"
<br>save overview ".ovr"
<br>save performance ".per"
<br>#
<br>#
<br># 
<br># func_t3.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a test of the lowest temperature the code can do.
It runs a constant temperature of 3K.
The predicted intrinsic spectrum
is suppressed in the main output.
</p><hr><kbd><h2>func_t3_linesoff.in</h2>  </kbd><h2><I>test low temperature limit of code, 3K
</I></h2><kbd><br>title test low temperature limit of code, 3K
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameters -2
<br>#
<br># commands for density & abundances =========
<br>hden -1
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br># specify a thin cell of gas 1 cm thick
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br># set constant temperature to low-T limit
<br>constant temperature, t=3.0 linear 
<br># iterate since gas is optically thin
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print lines off
<br>set save prefix "func_t3_linesoff"
<br>save overview ".ovr"
<br>save performance ".per"
<br>#
<br>#
<br># 
<br># func_t3.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a test of the lowest temperature the code can do.
It runs a constant temperature of 3K.
The predicted spectra (intrinsic and emergent)
are suppressed in the main output.
</p><hr><kbd><h2>func_test.in</h2>  </kbd><h2><I>run smoke test
</I></h2><kbd><br>title run smoke test
<br># commands controlling continuum =========
<br>test
<br># commands for density & abundances =========
<br># commands controlling geometry  =========
<br># other commands for details     =========
<br># include this in one test to make sure it works
<br>set continuum shield ferland
<br>#
<br># commands controlling output    =========
<br># increase precision of all printed wavelengths
<br>print line precision 6 
<br># following will print physical constants used by the code
<br>print constants
<br># print RR and DR rates
<br>print recombination
<br># print the past to the data directory
<br>print path 
<br># the citation for the current version of the code
<br>print citation
<br># following prints column densities 
<br>print column density
<br>save performance "func_test.per"
<br>save continuum "func_test.con"
<br>save overview "func_test.ovr"
<br># func_test.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This runs the smoke test command, which include several asserts.
The tests the behavior of increasing the number of significant figures
in printed wavelengths.  
<p>
</p><hr><kbd><h2>func_test_cycle.in</h2>  </kbd><h2><I>exercise full range of density, temperature
</I></h2><kbd><br>title exercise full range of density, temperature
<br>#
<br># modified from slow/grid_extreme.in
<br># this version cycles through the corner models twice
<br># to see if the second repetition exactly matches the first
<br># checkall.pl calls test_grid.pl to check that output is identical
<br># 
<br>element lithium off
<br>element berylium off
<br>element boron off
<br>cosmic rays background linear 0.1266
<br>cmb
<br>iterate
<br># 
<br>blackbody 6 
<br>energy density 6 vary
<br>grid 1 6 5 cycle sequential
<br># -8 18 
<br>hden 2 vary
<br>grid -6 15 21
<br>stop zone 1
<br># set to constant small thickness
<br>set dr -10
<br>#
<br>trace h-like full helium no print
<br>trace he-like full no print
<br>trace heavy no print
<br>trace convergence esource no print
<br>no time
<br># 
<br>save performance no hash "func_test_cycle.per"
<br>save grid no hash "func_test_cycle.grd" last 
<br>save overview last no hash "func_test_cycle.ovr" last 
<br>save average "func_test_cycle.avr" last 
<br>temperature hydrogen 2
<br>end of average
<br># 
<br>#
<br># func_test_cycle.in limits
<br> 
</kbd></p><hr><kbd><h2>func_test_grid.in</h2>  </kbd><h2><I>test whether the output from a repeated model reproduces exactly
</I></h2><kbd><br>title test whether the output from a repeated model reproduces exactly
<br>print depart he-like element helium
<br>trace h-like full helium no print
<br>trace he-like full no print
<br>trace heavy no print
<br>trace convergence esource no print
<br>test
<br>no time
<br>fudge 0 vary
<br>grid 0 to 1 1 repeat sequential
<br>iterate 3
<br>****************
</kbd><p>
This tests that the code gets repeatable results in a large grid run.
It will not if variables are not properly initialized.
tsuite / programs / comp does a similar test.
<p>
auto / checkall.pl includes test to check this.
</p><hr><kbd><h2>func_testmole.in</h2>  </kbd><h2><I>this runs the standard, one command, test, which contains many asserts
</I></h2><kbd><br>title this runs the standard, one command, test, which contains many asserts
<br># commands controlling continuum =========
<br>test mole 
<br># 
<br># commands for density & abundances =========
<br># commands controlling geometry  =========
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>save performance "func_testmole.per"
<br>save overview "func_testmole.ovr"
<br># func_testmole.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This runs the "test mole" command, which include several asserts.
<p>
</p><hr><kbd><h2>func_tlaw.in</h2>  </kbd><h2><I>test model with tlaw table
</I></h2><kbd><br>title test model with tlaw table
<br>#
<br># commands controlling continuum =========
<br>phi(H) 15
<br>table agn
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br>init "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>filling factor -5
<br>radius 16 17
<br>stop temperature 3 linear
<br>#
<br># other commands for details     =========
<br>tlaw table radius
<br>continue -35 4
<br>continue 16 4
<br>continue 16.2 3
<br>continue 16.4 4
<br>continue 16.6 3.5
<br>continue 16.8 4
<br>continue 20 4
<br>continue 21 -1
<br>end of tlaw
<br>#
<br># commands controlling output    =========
<br>save overview "func_tlaw.ovr"
<br>save performance "func_tlaw.per"
<br>save dr "func_tlaw.dr"
<br>save overveiw "func_tlaw.ovr"
<br>#
<br>#
<br># func_tlaw.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
this model tests the tlaw density table command 
<p>
<p>
<p>
</p><hr><kbd><h2>func_trans_lumi.in</h2>  </kbd><h2><I>test transmitted continuum in luminosity mode
</I></h2><kbd><br>title test transmitted continuum in luminosity mode
<br>#
<br># common commands 
<br>init file "func_trans_lumi.dat"
<br>#
<br># commands controlling geometry  =========
<br>radius 21
<br>#
<br># commands controlling output    =========
<br>set save prefix "func_trans_lumi"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save ionization last ".ion"
<br>save continuum last ".con"
<br>#
<br># this contains a large number of asserts that both tests use
<br>init file "trans_lumi.dat"
<br># 
<br># func_trans_lumi.in 
<br># class function 
<br># ========================================
<br># 
</kbd><p>
func_trans_lumi, func_trans_save_lumi, and func_trans_read_lumi_scale are a
set of tests that check that the code can save a transmitted continuum in
luminosity mode and then read it back in.
<p>
func_trans_lumi.in: this sim is directly illuminated by a BB at Rin = 1e21.
  Its predictions should be identical to func_trans_read_lumi_scale.in.
<p>
func_trans_save_lumi.in: this sim is directly illuminated by a BB at Rin =
  1e20. It saves the transmitted continuum and has no monitors.
<p>
func_trans_read_lumi_scale.in: this sim is illiminated by the transmitted
  continuum at Rin = 1e21. Its predictions should be almost identical to
  func_trans_lumi.in. This tests that the transmitted continuum works
  correctly in luminosity mode and also that spherical dilution is handled
  correctly.
</p><hr><kbd><h2>func_trans_read.in</h2>  </kbd><h2><I>second of func_trans_save/func_trans_read pair, use transmitted continuum
</I></h2><kbd><br>title second of func_trans_save/func_trans_read pair, use transmitted continuum
<br># the transmitted continuum produced by func_trans_punch
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -1
<br>table read "func_trans_save.trn"
<br>brems 6
<br>ionization parameter -6
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br># this contains a large number of asserts used by both commands
<br>init file "trans.dat"
<br>save overview "func_trans_read.ovr"
<br>save performance "func_trans_read.per"
<br>save ionization last "func_trans_read.ion"
<br>#
<br># 
<br># func_trans_read.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
func_trans_save.in and func_trans_read.in are a pair of
tests that check that the code can save a transmitted
continuum then read it.
<p>
</p><hr><kbd><h2>func_trans_read_lumi_scale.in</h2>  </kbd><h2><I>test read transmitted continuum in luminosity mode
</I></h2><kbd><br>title test read transmitted continuum in luminosity mode
<br>#
<br># commands controlling continuum =========
<br>table read "func_trans_save_lumi.trn" scale
<br># second, very faint SED to force luminosity mode
<br>blackbody 50
<br>luminosity 1
<br>#
<br># commands for density & abundances =========
<br>hden 3
<br>#
<br># commands controlling geometry  =========
<br>radius 21
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>set save prefix "func_trans_read_lumi_scale"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save ionization last ".ion"
<br>save continuum last ".con"
<br>#
<br># this contains a large number of asserts that both tests use
<br>init file "trans_lumi.dat"
<br># 
<br># func_trans_read_lumi_scale.in 
<br># class function 
<br># ========================================
<br># 
</kbd><p>
func_trans_lumi, func_trans_save_lumi, and func_trans_read_lumi_scale are a
set of tests that check that the code can save a transmitted continuum in
luminosity mode and then read it back in.
<p>
func_trans_lumi.in: this sim is directly illuminated by a BB at Rin = 1e21.
  Its predictions should be identical to func_trans_read_lumi_scale.in.
<p>
func_trans_save_lumi.in: this sim is directly illuminated by a BB at Rin =
  1e20. It saves the transmitted continuum and has no monitors.
<p>
func_trans_read_lumi_scale.in: this sim is illiminated by the transmitted
  continuum at Rin = 1e21. Its predictions should be almost identical to
  func_trans_lumi.in. This tests that the transmitted continuum works
  correctly in luminosity mode and also that spherical dilution is handled
  correctly.
<p>
This sim must come after func_trans_save_lumi since it needs the save file
generated by func_trans_save_lumi.
</p><hr><kbd><h2>func_trans_read_scale.in</h2>  </kbd><h2><I>second of func_trans_save/func_trans_readread pair
</I></h2><kbd><br>title second of func_trans_save/func_trans_readread pair
<br># use the transmitted continuum produced by func_trans_save
<br>#
<br># commands controlling continuum =========
<br># 10 continua scaled to 1/10 original should get same answer
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>table read "func_trans_save.trn" scale -1
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br># this contains a large number of asserts used by both commands
<br>init file "trans.dat"
<br>save overview "func_trans_read_scale.ovr"
<br>save performance "func_trans_read_scale.per"
<br>save ionization last "func_trans_read_scale.ion"
<br># transmitted continuum should scale as specified
<br>save last transmitted continuum "func_trans_read_scale.trn"
<br>#
<br># 
<br># func_trans_read_scale.in
<br># class function 
<br># ========================================
<br># 
</kbd><p>
func_trans_save.in and func_trans_read_scale.in are a pair of
tests that check that the code can save a transmitted
continuum then read it.
<p>
</p><hr><kbd><h2>func_trans_save.in</h2>  </kbd><h2><I>first of func_trans_save/func_trans_read pair, save continuum
</I></h2><kbd><br>title first of func_trans_save/func_trans_read pair, save continuum
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -1
<br>table agn
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save overview "func_trans_save.ovr"
<br>save performance "func_trans_save.per"
<br>save ionization last "func_trans_save.ion"
<br>save continuum last "func_trans_save.con"
<br># this continuum will be used by transread.in 
<br>save last transmitted continuum "func_trans_save.trn"
<br>#
<br># this contains a large number of asserts that both tests use
<br>init file "trans.dat"
<br># 
<br># func_trans_save.in 
<br># class function 
<br># ========================================
<br># 
</kbd><p>
func_trans_save, func_trans_read, func_trans_read_scale are a set of
tests that check that the code can save a transmitted
continuum then read it.
<p>
This sim must come before func_trans_read since it
generates the save file needed by func_trans_read.
Alphabetical order insures this.
</p><hr><kbd><h2>func_trans_save_lumi.in</h2>  </kbd><h2><I>test save transmitted continuum in luminosity mode
</I></h2><kbd><br>title test save transmitted continuum in luminosity mode
<br>#
<br># common commands 
<br>init file "func_trans_lumi.dat"
<br>#
<br># commands controlling geometry  =========
<br>radius 20
<br>#
<br># commands controlling output    =========
<br>set save prefix "func_trans_save_lumi"
<br>save overview ".ovr"
<br>save performance ".per"
<br>save ionization last ".ion"
<br>save continuum last ".con"
<br>save transmitted continuum ".trn"
<br>#
<br># 
<br># func_trans_save_lumi.in 
<br># class function 
<br># ========================================
<br># 
</kbd><p>
func_trans_lumi, func_trans_save_lumi, and func_trans_read_lumi_scale are a
set of tests that check that the code can save a transmitted continuum in
luminosity mode and then read it back in.
<p>
func_trans_lumi.in: this sim is directly illuminated by a BB at Rin = 1e21.
  Its predictions should be identical to func_trans_read_lumi_scale.in.
<p>
func_trans_save_lumi.in: this sim is directly illuminated by a BB at Rin =
  1e20. It saves the transmitted continuum and has no monitors.
<p>
func_trans_read_lumi_scale.in: this sim is illiminated by the transmitted
  continuum at Rin = 1e21. Its predictions should be almost identical to
  func_trans_lumi.in. This tests that the transmitted continuum works
  correctly in luminosity mode and also that spherical dilution is handled
  correctly.
<p>
This sim must come before func_trans_read_lumi_scale since it generates the
save file needed by func_trans_read_lumi_scale.
</p><hr><kbd><h2>grains_hot.in</h2>  </kbd><h2><I>test temperature of gas and dust in high energy density environment
</I></h2><kbd><br>title test temperature of gas and dust in high energy density environment
<br>#
<br># commands controlling continuum =========
<br>table power law 
<br># intensity of incident radiation field set by its energy density
<br>energy density temp 550 K
<br>#
<br># commands for density & abundances =========
<br>hden 5.0
<br>init "ism.ini"
<br># Orion grains and abundances
<br>abundances orion 
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set drmax 10
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>normalize to "O  8" 18.9689A
<br>save performance "grains_hot.per"
<br>save overview "grains_hot.ovr" last 
<br>#
<br>#
<br># grains_hot.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the grains in an extreme condition - irradiation by an AGN
near the illuminated face of the molecular torus.  The gas is 
predominantly heated by the grain electron photo-ejection.
</p><hr><kbd><h2>grains_hot_wd01.in</h2>  </kbd><h2><I>test temperature of gas and dust in high energy density environment
</I></h2><kbd><br>title test temperature of gas and dust in high energy density environment
<br>#
<br># commands controlling continuum =========
<br>table power law 
<br>energy density temp 550
<br>#
<br># commands for density & abundances =========
<br>hden 5.0
<br>init "ism.ini"
<br>abundances orion no grains 
<br>grains orion no qheat 
<br>#
<br># revert to WD01 treatment
<br>no grain x-ray treatment
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set drmax 10
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>normalize to "O  8" 18.9689A
<br>save performance "grains_hot_wd01.per"
<br>save overview "grains_hot_wd01.ovr" last 
<br>#
<br>#
<br># grains_hot_wd01.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the grains in an extreme condition - irradiation by an AGN
near the illuminated face of the molecular torus.  The gas is 
predominantly heated by the grains. The grain treatment has been
reverted to Weingartner & Draine, 2001, which is NOT appropriate
for these conditions. It is however a good test whether the old
treatment is not broken....
</p><hr><kbd><h2>grains_lte.in</h2>  </kbd><h2><I>check that grains equilibriate at correct temp in ste limit
</I></h2><kbd><br>title check that grains equilibriate at correct temp in ste limit
<br># this also tests that the code works when H He ionization is ZERO
<br>#
<br># commands controlling continuum =========
<br>black 3 lte 
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>eden 5
<br>init file "hheonly.ini"
<br># need to normalize to some line, oxygen will provide some 
<br>element oxygen on 
<br># ism grains with high dust to gas ratio
<br>grain abund 1
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br>iterate
<br>cosmic rays background
<br>database h2
<br>#
<br># commands controlling output    =========
<br>save species "grains_lte.h" "H[:]" last densities 
<br>save species "grains_lte.h2" "H2[:]" last densities  
<br>normalize to "O  1" 63.1679m
<br>save overview "grains_lte.ovr"
<br>save performance "grains_lte.per"
<br>save heating last "grains_lte.het"
<br>save cooling last "grains_lte.col"
<br>#
<br># grains_lte.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This test irradiates a set of grains with a true blackbody in
strict thermodynamic equilibrium.  We expect the grains
(and everything else) to equilibriate at the blackbody temperature.
The gas temperature is forced to the radiation temperature because
the current molecule network (based on ISM approximations) does not
go to LTE in the high-radiation density limit.  The calculation
asserts that all grain temperatures are very close to the radiation
temperature.
<p>
<p>
<p>
</p><hr><kbd><h2>grains_qheat.in</h2>  </kbd><h2><I>cool atomic ISM with Si grain quantum heating
</I></h2><kbd><br>title cool atomic ISM with Si grain quantum heating
<br>#
<br># commands controlling continuum =========
<br>table draine
<br>extinguish 20
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br># turns on grains with default abundance (log abundance ratio to ism = 0)
<br># and with quantum heating enabled by default
<br># (disabled with "no grains qheat" option)
<br>grains 0. "silicate_ism_10.opc"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>cosmic rays background
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "c  2" 157.636m 
<br>print line faint -2
<br>print line column
<br>save overview "grains_qheat.ovr"
<br>save performance "grains_qheat.per"
<br>save grains temperature last "grains_qheat.qht"
<br>save continuum  "grains_qheat.con" units microns last
<br>save two photon continuum "grains_qheat.2nu" units microns
<br>save qheat last "grains_qheat.qhd"
<br>#
<br>#
<br># grains_qheat.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This sim produces dust emission with a Wein trail that is
dominated by quantum heating emission.
<p>
</p><hr><kbd><h2>grains_temp.in</h2>  </kbd><h2><I>test all grain species temperature
</I></h2><kbd><br>title test all grain species temperature
<br>#
<br># commands controlling continuum =========
<br>black 50000
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 3
<br>grains "graphite_ism_01.opc"
<br>grains "silicate_ism_01.opc"
<br>grains "graphite_orion_01.opc"
<br>grains "silicate_orion_01.opc"
<br>grains "silicate_0m010.opc"
<br>grains "silicate_0m100.opc"
<br>grains "grey_ism_01.opc"
<br>grains "silicate_1m000.opc"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>constant temper 4
<br>#
<br># commands controlling output    =========
<br>#
<br>#
<br># grains_temp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This turns on all the grain species that are included in the distribution.
A model of an ionized layer is
done and the monitors confirm the resulting grain temperatures.
<p>
<p>
</p><hr><kbd><h2>grains_temp_all.in</h2>  </kbd><h2><I>test all grain species temperature
</I></h2><kbd><br>title test all grain species temperature
<br>#
<br># commands controlling continuum =========
<br>black 50000
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 3
<br># this turns on orion-style distributed grains
<br>grains orion
<br># this turns on ism distributed grains
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>constant temper 4
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save overview "grains_temp_all.ovr"
<br>save performance "grains_temp_all.per"
<br>save dr "grains_temp_all.dr" last 
<br>save grain charge "grains_temp_all.grnchr" last 
<br>save grain temperature "grains_temp_all.grntem" last 
<br>save grain drift velocity "grains_temp_all.grndft" last 
<br>#
</kbd><p>
	
# grains_temp_all.in
# class limit 
# ========================================
# 
<p>
This is a relatively quick test of grains.  
The Orion and ISM silicate and graphitic grains
are turned on and their equilibrium temperature
checked. 
</p><hr><kbd><h2>grid_coronal.in</h2>  </kbd><h2><I>coronal equilibrium
</I></h2><kbd><br>title coronal equilibrium
<br>#
<br># commands controlling continuum =========
<br>coronal 4 vary
<br>grid 1 9 0.25 sequential log
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>#
<br># must include cosmic ray background since going below 1e4 K
<br>cosmic ray background
<br># 
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands controlling output    =========
<br>no blends
<br>save grid "grid_coronal.grd" last no hash
<br>save ages "grid_coronal.age" last no hash
<br>save cooling "grid_coronal.col" last no hash
<br># 
<br># grid_coronal.in
<br># class coronal 
<br># ========================================
<br># 
<br>*********
</kbd><p>
This is a classical cooling function calculation - cosmic rays must be included
for temperatures below 1e4 K to sustain the chemistry.
This is a coronal (collisional) ionization calculation.
</p><hr><kbd><h2>grid_coronal_grains.in</h2>  </kbd><h2><I>coronal equilibrium
</I></h2><kbd><br>title coronal equilibrium
<br>#
<br># commands controlling continuum =========
<br>coronal 4 vary
<br>grid 1 9 0.25 sequential log
<br>#
<br># commands for density & abundances =========
<br>abundances ISM
<br>grains PAH 3
<br>hden 0
<br>#
<br># must include cosmic ray background since going below 1e4 K
<br>cosmic ray background
<br># 
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands controlling output    =========
<br>no blends
<br>save grid "grid_coronal_grains.grd" last no hash
<br>save cooling "grid_coronal_grains.col" last no hash
<br># 
<br># grid_coronal_grains.in
<br># class coronal 
<br># ========================================
<br># 
<br>*********
</kbd><p>
this is a classical cooling function calculation - cosmic rays must be included
for temperatures below 1e4 K to sustain chemistry.
This is a coronal (collisional) ionization calculation.
This case uses ISM abundances, depleted heavy elements, with grains
</p><hr><kbd><h2>grid_coronal_primal.in</h2>  </kbd><h2><I>coronal equilibrium
</I></h2><kbd><br>title coronal equilibrium
<br>#
<br># commands controlling continuum =========
<br>coronal 4 vary
<br>grid 1 9 0.25 sequential log
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>abundances primordial
<br>#
<br># must include cosmic ray background since going below 1e4 K
<br># make it 1e-4 of the default rate
<br>cosmic ray background -4
<br># 
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands controlling output    =========
<br>no blends
<br>save grid "grid_coronal_primal.grd" last no hash
<br>save cooling "grid_coronal_primal.col" last no hash
<br># 
<br># grid_coronal_primal.in
<br># class coronal 
<br># ========================================
<br># 
<br>*********
</kbd><p>
This is a classical cooling function calculation - cosmic rays must be included
for temperatures below 1e4 K to sustain chemistry.
This is a coronal (collisional) ionization calculation.
<p>
This version uses primordial abundances.  A small CR rate has to be set 
for the low-T chemistry to work.  The possibility of primordial
cosmic rays is rays is mentioned by 2014A&A...570L...3T although
thiey are not part of standard primrodial chemistry networks.
<p>
This is not a realistic model for several reasons.  First, it uses the approximate
small H2 model - the large model invoked with ATOM H2 is better but slower.
Second, primordial chemistry is time dependent - the Universe is typically not
old enough, at a given z, for the chemistry to have reached steady state.
This is a time-steady calculation.
<p>
The purpose of the test is to demonstrate code behavior in the metal-free
limit, over a wide range of temperature.  Gas-phase light-element
chemistry is exercised, but with the trace amount of cosmic rays.
<p>
</p><hr><kbd><h2>grid_h2coronal.in</h2>  </kbd><h2><I>coronal equilibrium
</I></h2><kbd><br>title coronal equilibrium
<br>#
<br># commands controlling continuum =========
<br>coronal 4 vary
<br>grid 1 9 0.25 log sequential
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br># use all databases
<br>database H2
<br>database chianti levels max
<br>database stout  levels max
<br>species "Fe+" levels=all
<br>#
<br># must include cosmic ray background since going below 1e4 K
<br>cosmic ray background
<br># 
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands controlling output    =========
<br>no blends
<br>save grid "grid_h2coronal.grd" last no hash
<br>save cooling "grid_h2coronal.col" last no hash
<br># 
<br># grid_h2coronal.in
<br># class coronal 
<br># ========================================
<br># 
<br>*********
</kbd><p>
This is a classical cooling function calculation - cosmic rays must be included
for temperatures below 1e4 K to sustain the chemistry.
This is a coronal (collisional) ionization calculation.
<p>
It is a pair with grid_coronal - this uses complete species models,
including all levels, while grid_coronal uses the default.
There will be more cooling as a result, at a cost of more memory
and greater execution time.
This also serves as a test of the full Stout database
</p><hr><kbd><h2>grid_h2coronal_primal.in</h2>  </kbd><h2><I>coronal equilibrium
</I></h2><kbd><br>title coronal equilibrium
<br>#
<br># commands controlling continuum =========
<br>coronal 4 vary
<br>grid 1 9 0.25 log sequential
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>abundances primrodial
<br>database H2
<br>#
<br># must include cosmic ray background since going below 1e4 K
<br># make it 1e-4 of the default rate
<br>cosmic ray background -4
<br># 
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands controlling output    =========
<br>no blends
<br>save grid "grid_hcoronal_primal.grd" last no hash
<br>save cooling "grid_h2coronal_primal.col" last no hash
<br># 
<br># grid_h2coronal_primal.in
<br># class coronal 
<br># ========================================
<br># 
<br>*********
</kbd><p>
This is a classical cooling function calculation - cosmic rays must be included
for temperatures below 1e4 K to sustain chemistry.
This is a coronal (collisional) ionization calculation.
<p>
This version uses primordial abundances.  A small CR rate has to be set 
for the low-T chemistry to work.  The possibility of primordial
cosmic rays is rays is mentioned by 2014A&A...570L...3T although
thiey are not part of standard primrodial chemistry networks.
<p>
This is not a realistic model for several reasons.  First, it uses the approximate
small H2 model - the large model invoked with ATOM H2 is better but slower.
Second, primordial chemistry is time dependent - the Universe is typically not
old enough, at a given z, for the chemistry to have reached steady state.
This is a time-steady calculation.
<p>
The purpose of the test is to demonstrate code behavior in the metal-free
limit, over a wide range of temperature.  Gas-phase light-element
chemistry is exercised, but with the trace amount of cosmic rays.
<p>
</p><hr><kbd><h2>h2_coll_t4.in</h2>  </kbd><h2><I>coronal equilibrium at 10^4 K
</I></h2><kbd><br>title coronal equilibrium at 10^4 K
<br>#
<br># commands controlling continuum =========
<br>coronal 4
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling geometry  =========
<br>stop column density 15 
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>database H2
<br>#
<br># commands controlling output    =========
<br>save performance "h2_coll_t4.per"
<br>save overview "h2_coll_t4.ovr" 
<br>save continuum "h2_coll_t4.con"  units angstroms 
<br>#
<br>#
<br># h2_coll_t4.in
<br># class coronal  
<br># ========================================
</kbd><p>
this tests conditions of collisional equilibrium at low densities
<p>
database h2 included to test results of large model
Hden is 4 (coll_tx series is 10) to reproduce conditinos for major bug)
</p><hr><kbd><h2>h2_cr.in</h2>  </kbd><h2><I>H2 with background cosmic ray ionization
</I></h2><kbd><br>title H2 with background cosmic ray ionization
<br>#
<br># commands controlling continuum =========
<br># this is hot star SED
<br>black 30000
<br>intensity  -5. range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br># background CR ionization rate of 2.5e-17 s^-1,
<br>cosmic rays, background
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 5 
<br>stop temperature 400 
<br>#
<br># other commands for details     =========
<br># failures should not occur
<br>failures 1 
<br>database h2 
<br>iterate
<br># want clean test of CR physics so set constant kinetic temperature
<br>constant temperature 500K
<br># must turn off line photoexcitation and Solomon process
<br># since we want to test cr heating and ionization
<br>no induced processes
<br>#
<br># commands controlling output    =========
<br>print column density 
<br>print ages
<br>save performance "h2_cr.per"
<br>save overview "h2_cr.ovr" last
<br>save h2 lines "h2_cr.lin" last electronic all 
<br>save h2 rates "h2_cr.rat" last
<br>save h2 column density "h2_cr.col" last
<br>save dominant rates "h2_cr.h2" "H2" last 
<br>save chemistry rates "h2_cr.h2d" "H2" destruction
<br>#
<br># 
<br># h2_cr.in
<br># class limit  
<br># ========================================
<br># 
</kbd><p>
This test conditions of cosmic ray ionization.  
Solar abundances with no dust are assumed so this involves
gas-phase chemistry alone.
The Solomon process is disabled with the "no induced processes' command
so H2 is mainly dissociated by cosmic rays.
This forms a pair with h2_cr_grains, which does include grains.
<p>
</p><hr><kbd><h2>h2_cr_grains.in</h2>  </kbd><h2><I>background cosmic ray ionization by suprathermal electrons only
</I></h2><kbd><br>title background cosmic ray ionization by suprathermal electrons only
<br>#
<br># commands controlling continuum =========
<br># this is hot star continuum
<br>black 30000
<br>intensity  -5. range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br># background CR ionization rate should be 2.5e-17 s^-1,
<br># Tielens & Hollenbach 1985; McKee AstroPH 9901370
<br>cosmic rays, background
<br>#
<br># commands for density & abundances =========
<br>abundances ism 
<br>hden 5
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 5 
<br>stop temperature 400 
<br>#
<br># other commands for details     =========
<br>set h2 grain formation thermal pump 
<br>database h2 
<br>iterate
<br>constant temperature 500K
<br># must turn off line photoexcitation
<br># since we want to test cr heating and ionization
<br>no induced processes
<br>#
<br># commands controlling output    =========
<br>normalize to "H2  " 2.12125m
<br>print column density 
<br>print ages
<br>save performance "h2_cr_grains.per"
<br>save overview "h2_cr_grains.ovr" last
<br>save h2 lines "h2_cr_grains.lin" limit -10 last electronic all 
<br>save continuum units microns "h2_cr_grains.con" last 
<br>save h2 rates "h2_cr_grains.rat" last
<br>save h2 column density "h2_cr_grains.col" last
<br>save grains H2rates "h2_cr_grains.h2r" last
<br>save dominant rates "h2_cr_grains.h2" "H2" last 
<br>save chemistry rates "h2_cr_grains.h2d" "H2" destruction
<br>#
<br># h2_cr_grains.in
<br># class limit  
<br># ========================================
<br># 
</kbd><p>
This tests conditions of cosmic ray ionization and grain formation pumping.
Solomon process is turned off with the "no induced processes" command
so cosmic rays are the main dissociation process.
This forms a pair with h2_cr which does not include grains, so relies
only on gas-phase chemistry.
</p><hr><kbd><h2>h2_hminus.in</h2>  </kbd><h2><I>H2 populations in H- dominated limit
</I></h2><kbd><br>title H2 populations in H- dominated limit
<br># this is one of a pair with h2_solomon.in 
<br>#
<br># commands controlling continuum =========
<br># this is hot star continuum
<br>black 30000
<br>intensity  -5. range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br># background CR ionization rate should be 2.5e-17 s^-1,
<br># Tielens & Hollenbach 1985; McKee AstroPH 9901370
<br>cosmic rays, background
<br>#
<br># commands for density & abundances =========
<br># no grains in this sim so H2 forms by H- route
<br>abundances ism no grains 
<br>hden 5
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 5 
<br>stop temperature 400 
<br>#
<br># other commands for details     =========
<br># default is Takahashi 2001 - test thermal distribution here
<br>set h2 grain formation thermal pump 
<br>database h2 
<br>iterate
<br>constant temperature 500K
<br>#
<br># commands controlling output    =========
<br>print column density 
<br>print ages
<br>save performance "h2_hminus.per"
<br>save overview "h2_hminus.ovr" last
<br>save h2 lines "h2_hminus.lin" last all 
<br>save h2 rates "h2_hminus.rat" last
<br>save h2 column density "h2_hminus.col" last
<br>save dominant rates "h2_hminus.h2" "H2" last 
<br>save chemistry rates "h2_hminus.h2d" "H2" destruction
<br>#
<br># h2_hminus.in
<br># class limit  
<br># ========================================
<br># 
</kbd><p>
This tests large H2 model in limit of H- formation and Solomon destruction.
<p>
</p><hr><kbd><h2>h2_pdr_leiden_f1.in</h2>  </kbd><h2><I>low density and flux model 1 
</I></h2><kbd><br>title low density and flux model 1 
<br>database H2 He collisions new 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br># this is to insure that no H-ionizing radiation strikes the cloud
<br>extinguish 24 
<br>#
<br># commands for density & abundances =========
<br>#  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br># turn on the large H2 model
<br>database h2 
<br># turn down the number of convergence failures - there should be none
<br>failures 3
<br># use leiden initialization file
<br>init file="pdr_leiden.ini"
<br># This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br># This sets the gas kinetic temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#
<br># commands controlling output    =========
<br># default normalization line is Hbeta, which is not produced by this gas
<br>normalize to "c  2" 157.636m
<br>print line faint -4 
<br>#
<br># saves
<br># check that all lines are found
<br>table lines "LineList_PDR_H2.dat"
<br>save performance "h2_pdr_leiden_f1.per"
<br>save overview "h2_pdr_leiden_f1.ovr"
<br>save line emissivity "h2_pdr_leiden_f1.ems" 
<br>H2   2.12125m
<br>CO   650.074m
<br>C  2 157.636m
<br>O  1 63.1679m
<br>Si 2 34.8046m
<br>end of lines
<br>save leiden lines "h2_pdr_leiden_f1.lin"
<br>save leiden "h2_pdr_leiden_f1.lei"
<br>save dr "h2_pdr_leiden_f1.dr" 
<br>save molecules "h2_pdr_leiden_f1.mol"
<br>save grain physical conditions "h2_pdr_leiden_f1.grn"
<br>save overview "h2_pdr_leiden_f1.ovr"
<br>save H2 lines "h2_pdr_leiden_f1.h2lin" all
<br>save H2 column density "h2_pdr_leiden_f1.h2col"
<br>save H2 populations matrix zone "h2_pdr_leiden_f1.pop"
<br>save H2 rates "h2_pdr_leiden_f1.rat"
<br>save dominant rates "h2_pdr_leiden_f1.h2" "H2" 
<br>save chemistry rates "h2_pdr_leiden_f1.h2d" "H2" destruction
<br>#
<br>#
<br># h2_pdr_leiden_f1.in
<br># class pdr  
<br># ========================================
<br># 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><kbd><h2>h2_solomon.in</h2>  </kbd><h2><I>H2 populations in solomon dominated limit
</I></h2><kbd><br>title H2 populations in solomon dominated limit
<br># this is a pair with h2_hminus 
<br>#
<br># commands controlling continuum =========
<br># this is hot star continuum
<br>black 30000
<br>intensity  -5. range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br># background CR ionization rate should be 2.5e-17 s^-1,
<br># Tielens & Hollenbach 1985; McKee AstroPH 9901370
<br>cosmic rays, background
<br>#
<br># commands for density & abundances =========
<br>abundances ism 
<br>hden 5
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 5 
<br>stop temperature 400 
<br>#
<br># other commands for details     =========
<br># default is Takahashi 2001 - test thermal distribution here
<br>set h2 grain formation thermal pump 
<br>database h2 
<br>iterate
<br>constant temperature 500K
<br>#
<br># commands controlling output    =========
<br># don't print so many lines
<br>print line faint 10 
<br>print line column
<br>print line sort wavelength
<br>print column density 
<br>print ages
<br>save performance "h2_solomon.per"
<br>save overview "h2_solomon.ovr" last
<br>save h2 lines "h2_solomon.lin" limit -10 last all electronic all
<br>save h2 rates "h2_solomon.rat" last
<br>save h2 column density "h2_solomon.col" last
<br>save continuum units microns "h2_solomon.con" last
<br>save dominant rates "h2_solomon.h2" "H2" last 
<br>save chemistry rates "h2_solomon.h2d" "H2" destruction
<br>#
<br># h2_solomon.in
<br># class limit  
<br># ========================================
<br># 
</kbd><p>
This test H2 in case of grain formation and solomon destruction
<p>
</p><hr><kbd><h2>h2_t2000.in</h2>  </kbd><h2><I>test large H2 molecule in shock-like conditions
</I></h2><kbd><br>title test large H2 molecule in shock-like conditions
<br>#
<br># commands controlling continuum =========
<br># there is a continuum but it is unimportant
<br># first continuum is FIR hot grain continuum produced in 
<br># unmodeled HII Region
<br>black 30000
<br>intensity  -5 range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br># must provide source of ionization for chemistry 
<br>cosmic rays, background
<br>#
<br># commands for density & abundances =========
<br>hden 6
<br>grains ism, abundance log 0.16 single
<br>init file="ism.ini"
<br>abundances he= -1.01 c= -3.52 n=-8 o=-3.30 ne=-8 mg=-5.89
<br>continue si= -6.10 s= -5.10 cl=-7 ar=-8 fe= -6.60
<br>#
<br># commands controlling geometry  =========
<br>stop zone 10
<br># force zone thickess to 1 cm 
<br>set dr 0 
<br># need to lower stop temperature since gas is cooler than 4000K
<br>stop temperature 3
<br>#
<br># other commands for details     =========
<br>failures 2 
<br>database h2  
<br>constant temperature 2000 
<br>iterate
<br># this stop Lymnan line excitation of H, which is then photoionized
<br># by Balmer continuum
<br>Database H-like Lyman pumping off
<br>#
<br># commands controlling output    =========
<br>normalize to "H2  " 2.12125m 
<br># 
<br>save performance "h2_t2000.per"
<br>save dominant rates "h2_t2000.oh" "OH" last
<br>save dominant rates "h2_t2000.ohp" "OH+" last
<br>save dominant rates "h2_t2000.h2" "H2" last
<br>save pdr "h2_t2000.pdr"
<br>save h2 rates "h2_t2000.rat"
<br>save h2 column density "h2_t2000.col"
<br>save h2 lines "h2_t2000.lin" all last
<br>save h2 populations "h2_t2000.pop" all last
<br>save chemistry rates "h2_t2000.h2d" "H2" destruction
<br>save raw continuum "h2_t2000.raw"
<br>save continuum "h2_t2000.con"
<br>save overview "h2_t2000.ovr"
<br>save species column densities "h2_t2000.scol" all
<br>save species departures "h2_t2000.sdep" "H2O[:]"
<br>save species densities "h2_t2000.spop" all
<br>save species energies "h2_t2000.senr" "H2O[:]"
<br>save species column densities "h2_t2000.scolH2O" "H2O[:]"
<br>save species densities "h2_t2000.spopH2O"  "H2O[:]"
<br>#
<br># h2_t2000.in 
<br># class limit  
<br># ========================================
</kbd><p>
This is a collisionally dominated H2 simulation.  The temperature
has been fixed at 2000K and the large molecule turned on.  The calculation
checks the returned value of the ortho to para densities.
Cosmic rays and the incident continuum have little effect, the density is high,
so the populations should be close to LTE.
<p>
</p><hr><kbd><h2>h2_t500.in</h2>  <br>set h2 continuum dissociation Stancil
</kbd><h2><I>test large H2 molecule in PDR-like conditions
</I></h2><kbd><br>title test large H2 molecule in PDR-like conditions
<br>#
<br># commands controlling continuum =========
<br># first continuum is FIR hot grain continuum produced in 
<br># unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity -2.7 (total)
<br># this is hot star continuum
<br>black 30000
<br>intensity  -5 range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br>#
<br># commands for density & abundances =========
<br>hden 6
<br>grains ism, abundance log 0.16 single, no qheat 
<br>init file="ism.ini"
<br>abundances he= -1.01 c= -3.52 n=-8 o=-3.30 ne=-8 mg=-5.89
<br>continue si= -6.10 s= -5.10 cl=-7 ar=-8 fe= -6.60
<br>turbulence 2.7 km/sec
<br>#
<br># commands controlling geometry  =========
<br>stop zone 10
<br># force zone thickess to 1 cm 
<br>sphere
<br>set dr 0 
<br># stop when gas is fully neutral
<br>stop efrac -10
<br># stop when gas is cold
<br>stop temperature 10 linear
<br>#
<br># other commands for details     =========
<br>failures 2 
<br>database h2  
<br>constant temperature 500 
<br>iterate
<br>Database H-like Lyman pumping off
<br>cosmic rays background
<br>#
<br># commands controlling output    =========
<br>normalize to "CO  " 866.727m 
<br># uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print line faint -2
<br>print ages
<br># 
<br>save performance "h2_t500.per"
<br>save cooling "h2_t500.col"
<br>save pdr "h2_t500.pdr"
<br>save H2 rates "h2_t500.rat"
<br>save H2 lines "h2_t500.lin" all 
<br>save H2 column density "h2_t500.h2col"
<br>save H2 populations "h2_t500.pop"
<br>save H2 levels "h2_t500.lev"
<br>save raw continuum "h2_t500.raw"
<br>save continuum "h2_t500.con"
<br>save overview "h2_t500.ovr"
<br>save dominant rates "h2_t500.h2" "H2" 
<br>save chemistry rates "h2_t500.h2d" "H2" destruction
<br>#
<br># h2_t500.in 
<br># class limit  
<br># ========================================
</kbd><p>
This is a dense molecular gas with background cosmic rays and the incident
radiation field set to a small value.  The lower levels are in LTE.
<p>
</p><hr><kbd><h2>h_otsopen.in</h2>  </kbd><h2><I>test ots, inward fractions for pure hydrogen, open geo, filling factor
</I></h2><kbd><br>title test ots, inward fractions for pure hydrogen, open geo, filling factor
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "honly.ini"  
<br>#
<br># commands controlling geometry  =========
<br>constant temper 7500
<br>filling factor 0.01
<br>#
<br># other commands for details     =========
<br># must iterate to get inward line fractions, that are asserted below
<br>iterate 
<br>diffuse ots
<br># not iterating does not affect the solution
<br>no level2
<br>no induced processes (OK) 
<br>#
<br># commands controlling output    =========
<br>print line inward
<br>save performance "h_otsopen.per"
<br>save overview  "h_otsopen.ovr" last
<br>save dr  "h_otsopen.dr" last
<br>save continuum "h_otsopen.con" last units angstrom
<br>#
<br># this is an open geometry, so do not expect H atom to exactly be case B
<br># due to Lyman line leakage.  we iterated, so have a good estimate of
<br># inward and outward fractions, which we test 
<br># h_otsopen.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the total emission from a hydrogen Stromgren sphere
using the OTS approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
</p><hr><kbd><h2>h_otspp.in</h2>  </kbd><h2><I>plane parallel conservation and hydrogenic emission for pure hydrogen
</I></h2><kbd><br>title plane parallel conservation and hydrogenic emission for pure hydrogen
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "honly.ini"  
<br>#
<br># commands controlling geometry  =========
<br>sphere static (OK)
<br>#
<br># other commands for details     =========
<br>constant temper 7500
<br>no level2
<br>no induced processes (OK) 
<br># needed to prevent 2s / Bal from becoming optically thick 
<br>turbulence 20 km/s
<br>diffuse ots
<br>database h-like levels resolved 10 
<br>#
<br># commands controlling output    =========
<br>save performance "h_otspp.per"
<br>save overview "h_otspp.ovr" 
<br>save dr "h_otspp.dr" 
<br>#
<br># h_otspp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
<p>
This tests the total emission from a plane parallel pure hydrogen
Stromgren sphere using the OTS approximation.  The conservation
of the total number of ionizing photons, and the emitted spectrum,
are all checked.
<p>
</p><hr><kbd><h2>h_otssp.in</h2>  </kbd><h2><I>spherical conservation and hydrogenic emission for pure hydrogen
</I></h2><kbd><br>title spherical conservation and hydrogenic emission for pure hydrogen
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "honly.ini"  
<br>#
<br># commands controlling geometry  =========
<br>radius 13
<br># not iterating does not affect the solution
<br>sphere static (OK)
<br>#
<br># other commands for details     =========
<br>constant temper 7500
<br>diffuse ots
<br>no level2
<br>no induced processes (OK) 
<br>#
<br># commands controlling output    =========
<br>save performance "h_otssp.per"
<br>save overview "h_otssp.ovr" 
<br>save dr "h_otssp.dr" 
<br>#
<br># h_otssp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the total emission from a spherical pure hydrogen Stromgren sphere
using the OTS approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
</p><hr><kbd><h2>h_outopen.in</h2>  </kbd><h2><I>test open geometry 
</I></h2><kbd><br>title test open geometry 
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>init file "honly.ini"  
<br>#
<br># commands controlling geometry  =========
<br>filling 0.01
<br>#
<br># other commands for details     =========
<br>diffuse outward
<br>iterate
<br>database h-like levels resolved 15
<br>no level2
<br>no induced processes (OK) 
<br>constant temper 4
<br>#
<br># commands controlling output    =========
<br># normally will not print out inward parts of lines
<br>print line inward
<br>save performance "h_outopen.per"
<br>save overview  "h_outopen.ovr" last
<br>save dr  "h_outopen.dr" last
<br>#
<br># this is an open geometry, so do not expect H atom to exactly be case B
<br># due to Lyman line leakage.  we iterated, so have a good estimate of
<br># inward and outward fractions, which we test 
<br># h_outopen.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
<p>
This tests the total emission from an open geometry, 
hydrogen Stromgren sphere,
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
</p><hr><kbd><h2>h_outpp.in</h2>  </kbd><h2><I>plane parallel H-only, close, test hydrogenic emission
</I></h2><kbd><br>title plane parallel H-only, close, test hydrogenic emission
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br># the hydrogen density
<br>hden 5
<br># an ini file that will include H-only
<br>init file "honly.ini"  
<br>#
<br># commands controlling geometry  =========
<br># need this to prevent lyman lines from escaping
<br>sphere static (OK)
<br>#
<br># other commands for details     =========
<br># prevent continuum pumping of lyman lines
<br>no induced processes (OK)
<br># must include this to keep Ha optically thin 
<br>turbulence 20 km/s
<br># this is the approximation we are testing
<br>diffuse outward
<br># force a constant temperature, then give stopping criteria
<br># if stop were not present model would go to limiting number of zones
<br>constant temper 7500
<br># increase number of levels to get full emission
<br>database h-like levels resolved 20 
<br>#
<br># commands controlling output    =========
<br># need to turn this on so that continua at various energies will
<br># be included in the emission line list 
<br># normalize results to perfect case b - our predictions should
<br># be close to this
<br># the output and asserts
<br>save performance "h_outpp.per"
<br>save overview "h_outpp.ovr" 
<br>save dr "h_outpp.dr"
<br>#
<br># energies dominated by two photon emission not included since very
<br># sensitive to Lya transport
<br># h_outpp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
<p>
This tests the total emission from a plane parallel pure hydrogen Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
</p><hr><kbd><h2>h_outsp.in</h2>  </kbd><h2><I>spherical conservation and hydrogenic emission for pure hydrogen
</I></h2><kbd><br>title spherical conservation and hydrogenic emission for pure hydrogen
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "honly.ini"  
<br>#
<br># commands controlling geometry  =========
<br>radius 13
<br># not iterating does not affect the solution
<br>sphere static (OK)
<br>#
<br># other commands for details     =========
<br>constant temper 7500
<br>no level2
<br>database h-like levels resolved 20 
<br>no induced processes (OK) 
<br>diffuse outward
<br>#
<br># commands controlling output    =========
<br>save performance "h_outsp.per"
<br>save overview "h_outsp.ovr" 
<br>save dr "h_outsp.dr" 
<br>#
<br># energies dominated by two photon emission not included since very
<br># sensitive to Lya transport
<br># h_outsp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the total emission from a spherical pure hydrogen Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
</p><hr><kbd><h2>h_t4_conemis.in</h2>  </kbd><h2><I>continuous emission from H atom
</I></h2><kbd><br>title continuous emission from H atom
<br>#
<br># commands controlling continuum =========
<br># use laser so that stellar continuum is not in predicted continuum
<br>laser 2
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br># high density to suppress two-photon emission
<br>hden 8
<br>init "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br># this thisckness is the inverse square of the density, so the
<br># total emission from the computed slab will in effect have the
<br># square of the density removed, so predictions will be j pi j / n_e n_p
<br>stop thickness -16
<br>#
<br># other commands for details     =========
<br># include a large number of levels to capture IR emission
<br># increase default resolution stored in continuum_mesh.ini 
<br>set continuum resolution 0.1
<br>iterate
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>print lines column 
<br>save overview "h_t4_conemis.ovr"
<br>save performance "h_t4_conemis.per"
<br>save continuum "h_t4_conemis.con" last no title units microns 
<br>#
<br># h_t4_conemis.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the continuous emission from the model H atom.  The
gas temperature is 10000 K and the continuous emissivity
is asserted for a range of wavelengths.
<p>
This was used to generate the plot in Hazy 2 comparing the emission
from a pure hydrogen plasma with those of Ferland 1980.
<p>
# >>refer	HI	emission	Ferland, G. J. 1980, PASP, 92, 596
</p><hr><kbd><h2>h_t4_conemis_lon.in</h2>  </kbd><h2><I>low-den continuous HI emission with 2-nu important
</I></h2><kbd><br>title low-den continuous HI emission with 2-nu important
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>init "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop thickness 0
<br>#
<br># other commands for details     =========
<br># increase default resolution stored in continuum_mesh.ini 
<br>set continuum resolution 0.1
<br>case b 
<br>iterate
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>print lines column 
<br>save overview "h_t4_conemis_lon.ovr"
<br>save performance "h_t4_conemis_lon.per"
<br>save continuum "h_t4_conemis_lon.con" last units microns 
<br>save two photon continuum "h_t4_conemis_lon.2nu" last rydbergs
<br>#
<br># h_t4_conemis_lon.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a mate to hatomt10.in except that the density is low enough
for two-photon emission to be very imporant in the optical and uv.
</p><hr><kbd><h2>h_t4_conemis_thick.in</h2>  </kbd><h2><I>H I continuous emissivity, used for plot in hazy
</I></h2><kbd><br>title H I continuous emissivity, used for plot in hazy
<br>#
<br># commands controlling continuum =========
<br>black 5
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br># high density to suppress two-photon emission
<br>hden 7
<br># turn off all elements, except for hydrogen, so that
<br># we really test hydrogen emission 
<br>init file= "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br># this is necessary to stop model at H ionization front
<br># constant temperature models will go on to infinity without this 
<br>stop efrac -0.8
<br>#
<br># other commands for details     =========
<br># increase continuum resolution by factor of ten
<br>set continuum resolution 0.1
<br># line fluorescense would be very important with above turbulence,
<br># turn it off 
<br>no induced processes
<br># need large atom to get the many Rydgerg levels in the infrared
<br># atom h-like levels resolved 10
<br># what full outward flux so use spherical geometry
<br>sphere 
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br># results will be relative to interplated Hummer&Storey Hbeta 
<br># this tests hydrogen atom too 
<br># output the predicted continuum
<br>save overview "h_t4_conemis_thick.ovr"
<br>save performance "h_t4_conemis_thick.per"
<br>save emitted continuum last iteration "h_t4_conemis_thick.con" units micron
<br>save dr last "h_t4_conemis_thick.dr"
<br>#
<br># h_t4_conemis_thick.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks that the predicted hydrogen continuum is in good agreement
with exact results in the optically thin nebular limit.
<p>
<br>Checks:
<br>-	This output was used to generate figure h_t4_conemis_thick in Part I of HAZY. 
<br>-	Continuum relative to Hbeta should agree with Ferland (1980)
	filter averaged results.
<br>-	Hbeta should agree with Case B predictions, and Q(H) 4861.
<p>
</p><hr><kbd><h2>heatomt10.in</h2>  </kbd><h2><I>continuous emission from HeI 
</I></h2><kbd><br>title continuous emission from HeI 
<br>#
<br># commands controlling continuum =========
<br>laser 1.9 ryd
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br># need high density to supress two-photon emission
<br>hden 10
<br># force high density for electrons, He+ density will be the same
<br>set eden 12
<br># set He/H ratio to 100, He and elec will have same density
<br>element abundance helium 2
<br>init "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br># this thickness will get unit emission when combined with above densities
<br>stop thickness -24
<br>#
<br># other commands for details     =========
<br>iterate
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>#
<br>set continuum resolution 0.1
<br>set nFnu diffuse outward, diffuse inward
<br>print line faint 1
<br>print line column
<br>save overview "heatomt10.ovr"
<br>save performance "heatomt10.per"
<br>save continuum "heatomt10.con" last no title units microns 
<br>save diffuse continuum "heatomt10.dif" last no title units microns
<br>#
<br># heatomt10.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests continuous emission from the He I atom.
The laser is used so that the incident continuum
is not included in the total emission.
<p>
</p><hr><kbd><h2>heatomt10lon.in</h2>  </kbd><h2><I>test low-den continuous emission from H atom, 2-nu is important
</I></h2><kbd><br>title test low-den continuous emission from H atom, 2-nu is important
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden -8
<br>element helium abundance log 3
<br>set eden -5
<br>init "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop thickness log 10
<br>#
<br># other commands for details     =========
<br>no scattering opacity
<br># force all helium to be in He+ 
<br>element helium ionization -4 0 -4 
<br>case b 
<br># increase default resolution stored in continuum_mesh.ini 
<br>set continuum resolution 0.1
<br>iterate
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>normalize to "Blnd" 4471.50A 
<br>print lines column  
<br>print lines column 
<br>save overview "heatomt10lon.ovr"
<br>save performance "heatomt10lon.per"
<br>save continuum "heatomt10lon.con" last units microns 
<br>save diffuse continuum "heatomt10lon.dif" last units microns 
<br>save two photon continuum "heatomt10lon.2nu" last
<br>#
<br># heatomt10lon.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a mate to hatomt10.in except that everything is He at low density
</p><hr><kbd><h2>heiont10.in</h2>  </kbd><h2><I>continuous emission from HeII
</I></h2><kbd><br>title continuous emission from HeII
<br>#
<br># commands controlling continuum =========
<br>laser 5 ryd
<br>ionization 1
<br>#
<br># commands for density & abundances =========
<br>hden 8
<br>set eden 10
<br>element abundance helium 2
<br>init "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop thickness -20
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>iterate
<br># increase continuum resolution by factor of ten
<br>set continuum resolution 0.1
<br>set nFnu diffuse outward, diffuse inward
<br>#
<br># commands controlling output    =========
<br>print line faint 1
<br>print line column
<br>save overview "heiont10.ovr"
<br>save performance "heiont10.per"
<br>save continuum "heiont10.con" last no title units microns 
<br>#
<br># heiont10.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the He II continuous emission.  The helium abundance
is very large so that He II overwhelms other emission sources.
The resolution of the continuum mesh is increased so that we get
a better representation of the continuous emission.
<p>
</p><hr><kbd><h2>helike_ar.in</h2>  </kbd><h2><I>He-like argon emission
</I></h2><kbd><br>title He-like argon emission
<br>#
<br># commands controlling continuum =========
<br>laser 600
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br># include lots of the element we are testing and set the ionization 
<br># to be dominated by the correct ion stage
<br>element argon abundance -2
<br>element argon ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element iron off
<br>#
<br># commands controlling geometry  =========
<br>set dr -12
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure argon
<br>print line faint -5
<br>save overview "helike_ar.ovr"
<br>save performance "helike_ar.per"
<br># This is Lyman alpha
<br>normalize to "Ar17" 3.94907A
<br>#
<br># 3.994A is 2^3S to ground
<br># Totl is 2^3P to ground
<br># 3.365A is 3^1P to ground
<br># 21.54A is 3^3P to 2^3S
<br># 22.24A is 3^3D to 2^3P
<br># 
<br># helike_ar.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test He-like emission for argon
<p>
<p>
</p><hr><kbd><h2>helike_c.in</h2>  </kbd><h2><I>he-like carbon emission
</I></h2><kbd><br>title he-like carbon emission
<br>#
<br># commands controlling continuum =========
<br>laser 50
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br># include lots of the element we are testing and set the ionization 
<br># to be dominated by the correct ion stage
<br>element carbon abundance -2
<br>element carbon ionization -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>#
<br># commands controlling geometry  =========
<br>set dr -12
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure carbon
<br>print line faint -2
<br>save overview "helike_c.ovr"
<br>save performance "helike_c.per"
<br># This is Lyman alpha
<br>normalize to "C  5" 40.2678A
<br>#
<br>#
<br># helike_c.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test he-like carbon emission
<p>
</p><hr><kbd><h2>helike_co.in</h2>  </kbd><h2><I>He-like cobalt emission
</I></h2><kbd><br>title He-like cobalt emission
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>print he-like departure cobalt 
<br>constant temper 5
<br>iterate
<br>hden 7
<br>set dr -12
<br>init file "ism.ini"
<br># must turn on since ism.ini turned it off
<br>element cobalt on  
<br># then set abundance and ionization after turning it on
<br>element cobalt abundance -2
<br>element cobalt ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br># now turn lots of elements off to save time
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>laser 1300
<br>ionization -1
<br>stop zone 1
<br>print line faint -2
<br>save overview "helike_co.ovr"
<br>save performance "helike_co.per"
<br>#
<br># helike_co.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test emission of He-like Co
<p>
</p><hr><kbd><h2>helike_cu.in</h2>  </kbd><h2><I>He-like copper emission
</I></h2><kbd><br>title He-like copper emission
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>print he-like departure copper 
<br>constant temper 5
<br>iterate
<br>hden 7
<br>set dr -12
<br>init file "ism.ini"
<br># must turn on since ism.ini turned it off
<br>element copper on  
<br># then set abundance and ionization after turning it on
<br>element copper abundance -2
<br>element copper ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br># now turn lots of elements off to save time
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>laser 1300
<br>ionization -1
<br>stop zone 1
<br>print line faint -2
<br>save overview "helike_cu.ovr"
<br>save performance "helike_cu.per"
<br>#
<br># helike_cu.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test emission of He-like Cu
</p><hr><kbd><h2>helike_fe.in</h2>  </kbd><h2><I>he-like iron emission
</I></h2><kbd><br>title he-like iron emission
<br>#
<br># commands controlling continuum =========
<br>laser 1300
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br>set dr -12
<br># include lots of the element we are testing and set the ionization 
<br># to be dominated by the correct ion stage
<br>element iron abundance -2
<br>element iron ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print line faint -2
<br>print he-like departure iron
<br>save overview "helike_fe.ovr"
<br>save performance "helike_fe.per"
<br># This is Lyman alpha
<br>normalize to "Fe25" 1.8504A
<br>#
<br># 
<br># helike_fe.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
check He-like emission for iron
<p>
<p>
</p><hr><kbd><h2>helike_mg.in</h2>  </kbd><h2><I>he-like magnesium emission
</I></h2><kbd><br>title he-like magnesium emission
<br>#
<br># commands controlling continuum =========
<br>laser 250
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br>set dr -12
<br>element magnesium abundance -2
<br>element magnesium ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure magnesium
<br>print line faint -2
<br>save overview "helike_mg.ovr"
<br>save performance "helike_mg.per"
<br># This is Lyman alpha
<br>normalize to "Mg11" 9.16875A
<br>#
<br># 
<br># helike_mg.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test He-like Mg emission
<p>
<p>
</p><hr><kbd><h2>helike_n.in</h2>  </kbd><h2><I>He-like nitrogen emission
</I></h2><kbd><br>title He-like nitrogen emission
<br>#
<br># commands controlling continuum =========
<br>laser 75
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br>element nitrogen abundance -2
<br>element nitrogen ionization -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element carbon off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure nitrogen
<br>print line faint -2
<br>save overview "helike_n.ovr"
<br>save performance "helike_n.per"
<br># This is Lyman alpha
<br>normalize to "N  6" 28.7870A
<br>#
<br># helike_n.in
<br># class limit  
<br># ========================================
<br># 
</kbd><p>
test He-like emission for N
<p>
</p><hr><kbd><h2>helike_ne.in</h2>  </kbd><h2><I>he-like neon emission
</I></h2><kbd><br>title he-like neon emission
<br>#
<br># commands controlling continuum =========
<br>laser 170
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br># include lots of the element we are testing and set the ionization 
<br># to be dominated by the correct ion stage
<br>element neon abundance -2
<br>element neon ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure neon
<br>print line faint -2
<br>save overview "helike_ne.ovr"
<br>save performance "helike_ne.per"
<br># This is Lyman alpha
<br>normalize to "Ne 9" 13.4471A
<br>#
<br># 
<br># helike_ne.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test He-like emission for oxygen
<p>
<p>
</p><hr><kbd><h2>helike_ni.in</h2>  </kbd><h2><I>he-like nickel emission
</I></h2><kbd><br>title he-like nickel emission
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>print he-like departure nickel
<br>constant temper 5
<br>iterate
<br>hden 7
<br>set dr -12
<br>init file "ism.ini"
<br># must turn on since ism.ini turned it off
<br>element nickel on  
<br># then set abundance and ionization after turning it on
<br>element nickel abundance -2
<br>element nickel ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br># now turn lots of elements off to save time
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>laser 1300
<br>ionization -1
<br>stop zone 1
<br>print line faint -2
<br>save overview "helike_ni.ovr"
<br>save performance "helike_ni.per"
<br>#
<br># helike_ni.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
Test He-like Ni emission.
</p><hr><kbd><h2>helike_o.in</h2>  </kbd><h2><I>he-like oxygen ion vs. Bautista & Kallman 2000 Table 1, column 3
</I></h2><kbd><br>title he-like oxygen ion vs. Bautista & Kallman 2000 Table 1, column 3
<br>#
<br># commands controlling continuum =========
<br>laser 100
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br># include lots of the element we are testing and set the ionization 
<br># to be dominated by the correct ion stage
<br>element oxygen abundance -2
<br>element oxygen ionization -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure oxygen
<br>print line sort wavelength 
<br>print line faint -5
<br>save overview "helike_o.ovr"
<br>save performance "helike_o.per"
<br>save continuum "helike_o.con" units Angstroms
<br>normalize to "o  7" 21.6020A
<br>#
<br># helike_o.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test He-like emission for oxygen
<p>
<p>
</p><hr><kbd><h2>helike_si.in</h2>  </kbd><h2><I>He-like silicon emission
</I></h2><kbd><br>title He-like silicon emission
<br>#
<br># commands controlling continuum =========
<br>laser 350
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br># include lots of the element we are testing and set the ionization 
<br># to be dominated by the correct ion stage
<br>element silicon abundance -2
<br>element silicon ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br>init file "ism.ini"
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure silicon
<br>print line faint -2
<br>save overview "helike_si.ovr"
<br>save performance "helike_si.per"
<br># This is Lyman alpha
<br>normalize to "Si13" 6.64803A
<br>#
<br>#
<br># helike_si.in
<br># class limit
<br># 
</kbd><p>
test He-like emission for silicon
<p>
<p>
</p><hr><kbd><h2>helike_zn.in</h2>  </kbd><h2><I>He-like zinc emission
</I></h2><kbd><br>title He-like zinc emission
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>print he-like departure zinc 
<br>constant temper 5
<br>iterate
<br>hden 7
<br>set dr -12
<br>init file "ism.ini"
<br># must turn on since ism.ini turned it off
<br>element zinc on  
<br># then set abundance and ionization after turning it on
<br>element zinc abundance -2
<br>element zinc ionization -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 0 -5
<br># now turn lots of elements off to save time
<br>element helium off
<br>element carbon off
<br>element nitrogen off
<br>element oxygen off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>laser 1300
<br>ionization -1
<br>stop zone 1
<br>print line faint -2
<br>save overview "helike_zn.ovr"
<br>save performance "helike_zn.per"
<br>#
<br># helike_zn.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test emission for He-like Zn
</p><hr><kbd><h2>hhe_otspp.in</h2>  </kbd><h2><I>plane parallel conservation and H-like emission for H, He
</I></h2><kbd><br>title plane parallel conservation and H-like emission for H, He
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>#
<br># commands controlling geometry  =========
<br># expanding sphere to stop Lya from destroying HeI 23S
<br>sphere
<br>#
<br># other commands for details     =========
<br>diffuse ots 
<br>database h-like element hydrogen levels resolved 10 
<br># need to iterate since we will assert helium triplet lines 
<br># that depend on having stable solution
<br>iterate 
<br>constant temper 7500
<br>no induced processes (OK)
<br>#
<br># commands controlling output    =========
<br>save performance "hhe_otspp.per"
<br>save overview "hhe_otspp.ovr"  last
<br>save dr "hhe_otspp.dr"  last
<br>#
<br># helium lines
<br># hhe_otspp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
<p>
This tests the total emission from a spherical pure H + He Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
<p>
</p><hr><kbd><h2>hhe_otssp.in</h2>  </kbd><h2><I>spherical conservation and H-like emission for H and He
</I></h2><kbd><br>title spherical conservation and H-like emission for H and He
<br>#
<br># commands controlling continuum =========
<br>blackbody 40000
<br>ionization -2
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>#
<br># commands controlling geometry  =========
<br>diffuse ots
<br>database h-like levels resolved 10 
<br>radius 13
<br>sphere static
<br>#
<br># other commands for details     =========
<br>constant temper 7500
<br>iterate
<br>no level2
<br>no induced processes (OK)
<br>#
<br># commands controlling output    =========
<br>save performance "hhe_otssp.per"
<br>save overview "hhe_otssp.ovr"  last
<br>save dr "hhe_otssp.dr"  last
<br>#
<br># helium lines
<br># hhe_otssp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
<p>
This tests the total emission from a spherical pure H + He-like Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.	The geometry is plane paralel.
<p>
</p><hr><kbd><h2>hhe_outpp.in</h2>  </kbd><h2><I>plane parallel conservation emission for H, He gas
</I></h2><kbd><br>title plane parallel conservation emission for H, He gas
<br>#
<br># commands controlling continuum =========
<br>blackbody 40000
<br>ionization -2
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>#
<br># commands controlling geometry  =========
<br># open sphere to stop Lya from destroying HeI 23S
<br>sphere
<br>#
<br># other commands for details     =========
<br># need this since will assert  helium triplet lines that depend on stable soln
<br>iterate 
<br>constant temper 7500
<br>database h-like element hydrogen levels resolved 10 
<br>no level2
<br>no induced processes (OK)
<br>#
<br># commands controlling output    =========
<br>save performance "hhe_outpp.per"
<br>save overview "hhe_outpp.ovr"  last
<br>save dr "hhe_outpp.dr"  last
<br>#
<br># hhe_outpp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the total emission from a spherical pure hydrogen Stromgren sphere
using the outward only approximation.  The conservation of the total number
of ionizing photons, and the emitted spectrum, are all checked.
<p>
<p>
</p><hr><kbd><h2>hhe_outppff.in</h2>  </kbd><h2><I>plane parallel filling factor pure H, He gas
</I></h2><kbd><br>title plane parallel filling factor pure H, He gas
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>#
<br># commands controlling geometry  =========
<br>filling factor -1
<br>sphere
<br>#
<br># other commands for details     =========
<br># need this since will assert  helium triplet lines that depend on stable soln
<br>iterate 
<br>constant temper 7500
<br>no level2
<br>no induced processes (OK)
<br>database h-like element hydrogen levels resolved 10
<br>#
<br># commands controlling output    =========
<br>save performance "hhe_outppff.per"
<br>save overview "hhe_outppff.ovr"  last
<br>save dr "hhe_outppff.dr"  last
<br>#
<br># helium lines
<br># hhe_outppff.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a plane-parallel constant temperature cloud with only
hydrogen and helium.  The gas has a filling factor of 0.1.  
Induced processes are turned off and a large H atom is used
so that the hydrogen recombination
spectrum will be close to Case B. The calculation stops beyond the
hydrogen ionization front, because of the stop efrac command (it needs
this since this is a constant temperature calculation, so the usual
lower-temperature stopping criterion does not apply).   The asserts
confirm that energy is conserved and that the hydrogen spectrum is correct.
 
</p><hr><kbd><h2>hhe_outsp.in</h2>  </kbd><h2><I>spherical conservation and H-like emission for H, He
</I></h2><kbd><br>title spherical conservation and H-like emission for H, He
<br>#
<br># commands controlling continuum =========
<br>ionization -2
<br>blackbody 40000
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>init file "hheonly.ini"  
<br>#
<br># commands controlling geometry  =========
<br>radius 13
<br>sphere static
<br>#
<br># other commands for details     =========
<br>iterate
<br>diffuse outward only
<br>constant temper 7500
<br>no level2
<br>no induced processes (OK)
<br>database h-like element hydrogen levels resolved 10
<br>#
<br># commands controlling output    =========
<br>save performance "hhe_outsp.per"
<br>save overview "hhe_outsp.ovr"  last
<br>save dr "hhe_outsp.dr"  last
<br>#
<br># helium lines
<br># 
<br># hhe_outsp.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
<p>
This tests a spherical cloud with only hydrogen and helium.
Diffuse fields are transferred with the outward only approximation.
The asserts check that the ionizing radiation is conserved.
<p>
<p>
</p><hr><kbd><h2>hii_blister.in</h2>  </kbd><h2><I>Lexington 1995 dust-free hii blister region
</I></h2><kbd><br>title Lexington 1995 dust-free hii blister region
<br>#
<br># commands controlling continuum =========
<br># a simple blackbody
<br>blackbody 40000
<br># the flux of H-ionizing photons
<br>phi(h) 13.0
<br># add the CMB after hot star shape & luminosity specified
<br>CMB 
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>init file="ism.ini"
<br># HII region abundance but no dust
<br>abundances hii region no grains
<br>abundances he=1 c=1 n=1 o=1 ne=1 mg=.0001 si=.01 s=1 cl=1 ar=1
<br>continue fe=.001
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>#
<br># other commands for details     =========
<br># this is to desaturate Lya to prevent excited state photoionization
<br># from being important - the other codes did not include this important
<br># physical process
<br>turbulence 10 km/s
<br># must iterate since optically thick
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "Ca B" 4861.32A
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>print line faint .01
<br>print line sum
<br>Blnd 5875.66A
<br>blnd 2326
<br>blnd 1335
<br>blnd 1909
<br>N  2  6583.45
<br>N  2 6548.05
<br>n  3  57.3238m
<br>blnd  7325
<br>blnd  3727
<br>O  3  51.8004m
<br>o  3  5006.84
<br>o  3  4958.91
<br>Ne 2  12.8101m
<br>Ne 3  15.5509m
<br>Ne 3 3868.76A
<br>Ne 3 3967.47A
<br>S  3  18.7078m
<br>S  3  9530.62
<br>S  3  9068.62
<br>s  4  10.5076m
<br>end of lines
<br>set blend "HepsNe3" 3968
<br>Ne 3  3967.47
<br>H  1  3970.07
<br>end of lines
<br>save performance "hii_blister.per"
<br>save overview last "hii_blister.ovr"
<br>save dr last "hii_blister.dr"
<br>save results last "hii_blister.rlt"
<br>print line optical depths
<br>#
<br># 
<br># hii_blister.in
<br># class hii
<br># ========================================
</kbd><p>
<p>
This is one of the test cases from the Lexington Meeting suite of
nebulae (Ferland et al. 1995).  It is a grain-free hii_blister HII region,
similar to inner regions of the Orion Nebula, except for the
absence of grains.
The set of lines entered with the print line sum command lists
the most powerful coolants in this model.  This is one of the
tabulated quantities in the Lexington Meeting, and is a
fundamental test of energy conservation in the code. 
The ratio of the sum of these lines to Hb is equivalent to the
Stoy ratio, used for determining stellar temperatures.
<p>
The "dielec kludge 0" command is to turn off my estimates of the
DR rates for those elements that had none.  This was only to allow
comparison with other calculations that did not make similar estimates.
For an actual calculation I would not include this command, since the
guesses are better than nothing.
<p>
the turbulence is to stop the balmer lines from becoming optically
thick since few other codes include an actual H atom, but use
case b instead.  The Orion HII region does have an observed turbulence
of about 8 km/s.  
<p>
This calculation stops near the H+ - H0 ionization front, where
the temperature falls below the default lowest temperature of 4000 K.
This model would have continued into the PDR had a lower temperature
been specified with the STOP LOWEST TEMP command. 
<p>
</p><hr><kbd><h2>hii_coolstar.in</h2>  </kbd><h2><I>dust free cool HII region model, Lexington 1995
</I></h2><kbd><br>title dust free cool HII region model, Lexington 1995
<br>#
<br># commands controlling continuum =========
<br>black body, T = 20000 K 
<br>q(h) 49
<br># add the CMB after hot star shape & luminosity specified
<br>CMB 
<br>#
<br># commands for density & abundances =========
<br>hden = 2
<br>init file="ism.ini"
<br>abund He=-1 C=-3.6576 N=-4.39794 O=-3.481146 ne=-4.30103 mg=-8
<br>continue si=-8 s=-5.04576 cl=-7 ar=-8 fe=-8
<br>#
<br># commands controlling geometry  =========
<br>radius = 18.477121
<br>sphere
<br># this is to go deep to pick up all H recombs
<br>stop efract -2
<br>stop temperature 1000
<br>#
<br># other commands for details     =========
<br># must iterate since fine structure lines are optically thick
<br>iterate
<br># assume there is neutral gas beyond what we compute
<br>double
<br>#
<br># commands controlling output    =========
<br>print line faint .01
<br># this is the sum of lines in table 2 of the Lexington meeting
<br>print line sum 
<br>N  2  6583.45
<br>N  2 6548.05
<br>blnd  3727
<br>Ne 2  12.8101m
<br>Blnd  6720
<br>S  3  18.7078m
<br>S  3  33.4704m
<br>S  3  9530.62
<br>S  3  9068.62
<br>end of lines
<br>save performance "hii_coolstar.per"
<br>save overview last "hii_coolstar.ovr"
<br>save dr last "hii_coolstar.dr"
<br>save results last "hii_coolstar.rlt"
<br>save continuum last units microns "hii_coolstar.con"
<br>save lines, zone cumulative, "hii_coolstar.cum"
<br>H  1 4861.32A
<br>o  3  5006.84
<br>blnd  3727
<br>O  1  6300.30
<br>end of lines
<br>#
<br># Hbeta 4.93E36, L(total)4.30xHbeta
<br># hii_coolstar.in
<br># class hii 
<br># ========================================
<br># 
</kbd><p>
<p>
This is one of the test cases from the Lexington Meeting suite of nebulae. 
It is a grain-free HII region ionized by a very cool star.  Hydrogen is
ionized but not helium so this tests the transport of the H Lyman continuum. 
The set of lines is entered with the print line sum command to test
energy conservation.
</p><hr><kbd><h2>hii_hiU_StaticSphere_noGrains.in</h2>  </kbd><h2><I>very high ionization parameter static H II region without dust
</I></h2><kbd><br>title very high ionization parameter static H II region without dust
<br>stop efrac -1
<br>stop temperature 3
<br>sphere static
<br>covering factor 0.500
<br>q(H) = 51.340
<br>radius  1.000 linear parsecs
<br>hden 2.
<br>database h-like element hydrogen resolved levels 20
<br>print line pump
<br>iterate to convergence
</kbd><h2><I>test
</I></h2><kbd><br>title test
<br>#    IMF slope: 2.35 Mup=120 Mlow=0.1 Mo
<br>#    Metallicity: z004 ;
<br>#    Age = 2.9000 Myrs
<br>print off
<br>interpolate ( 6.5172, -10.0000)
<br>continue (12.2727001 , 18.5331989 ) (12.3306917 , 18.4600873 )
<br>continue (12.3976394 , 18.3696100 ) (12.4768200 , 18.2559724 )
<br>continue (12.5737312 , 18.1106805 ) (12.6986694 , 17.9237063 )
<br>continue (12.8747606 , 17.7132364 ) (13.1757900 , 17.9262936 )
<br>continue (13.4759529 , 18.4762233 ) (13.4776898 , 18.4795692 )
<br>continue (13.4794342 , 18.4830526 ) (13.4811860 , 18.4865412 )
<br>continue (13.4829436 , 18.4900359 ) (13.4847097 , 18.4935365 )
<br>continue (13.4864815 , 18.4970429 ) (13.4882616 , 18.5005546 )
<br>continue (13.4900484 , 18.5040724 ) (13.4918434 , 18.5075965 )
<br>continue (13.4936462 , 18.5111264 ) (13.4954555 , 18.5146620 )
<br>continue (13.4972725 , 18.5182046 ) (13.4990971 , 18.5217529 )
<br>continue (13.5009291 , 18.5253099 ) (13.5027698 , 18.5288689 )
<br>continue (13.5046176 , 18.5324342 ) (13.5064739 , 18.5360110 )
<br>continue (13.5083371 , 18.5395916 ) (13.5102098 , 18.5431760 )
<br>continue (13.5120904 , 18.5467681 ) (13.5139776 , 18.5503718 )
<br>continue (13.5158738 , 18.5539755 ) (13.5177790 , 18.5569388 )
<br>continue (13.5196928 , 18.5608904 ) (13.5216140 , 18.5648526 )
<br>continue (13.5235449 , 18.5688178 ) (13.5254828 , 18.5727940 )
<br>continue (13.5274301 , 18.5767735 ) (13.5293867 , 18.5807617 )
<br>continue (13.5313524 , 18.5847603 ) (13.5333258 , 18.5887622 )
<br>continue (13.5353093 , 18.5927732 ) (13.5373014 , 18.5967928 )
<br>continue (13.5393032 , 18.6008181 ) (13.5413133 , 18.6048488 )
<br>continue (13.5433328 , 18.6088943 ) (13.5453628 , 18.6129424 )
<br>continue (13.5474018 , 18.6169987 ) (13.5494508 , 18.6210632 )
<br>continue (13.5515086 , 18.6251325 ) (13.5535772 , 18.6292082 )
<br>continue (13.5556542 , 18.6332996 ) (13.5577429 , 18.6373981 )
<br>continue (13.5598408 , 18.6415044 ) (13.5619489 , 18.6456182 )
<br>continue (13.5640669 , 18.6497377 ) (13.5661958 , 18.6538678 )
<br>continue (13.5683355 , 18.6580066 ) (13.5704857 , 18.6621496 )
<br>continue (13.5726463 , 18.6663076 ) (13.5748181 , 18.6704725 )
<br>continue (13.5769998 , 18.6746433 ) (13.5791935 , 18.6788257 )
<br>continue (13.5813978 , 18.6830186 ) (13.5836136 , 18.6872189 )
<br>continue (13.5858407 , 18.6914292 ) (13.5880800 , 18.6956417 )
<br>continue (13.5903301 , 18.6998759 ) (13.5925920 , 18.7041127 )
<br>continue (13.5948653 , 18.7083589 ) (13.5971520 , 18.7126123 )
<br>continue (13.5994497 , 18.7168416 ) (13.6017591 , 18.7167174 )
<br>continue (13.6040823 , 18.7210062 ) (13.6064168 , 18.7296665 )
<br>continue (13.6087645 , 18.7334982 ) (13.6111251 , 18.7383992 )
<br>continue (13.6134983 , 18.7433132 ) (13.6158838 , 18.7482317 )
<br>continue (13.6182835 , 18.7531594 ) (13.6206960 , 18.7581142 )
<br>continue (13.6231221 , 18.7630629 ) (13.6255625 , 18.7680391 )
<br>continue (13.6280158 , 18.7730141 ) (13.6304838 , 18.7780038 )
<br>continue (13.6329652 , 18.7830126 ) (13.6354616 , 18.7880218 )
<br>continue (13.6379718 , 18.7930573 ) (13.6404963 , 18.7980966 )
<br>continue (13.6430359 , 18.8031500 ) (13.6455912 , 18.8082162 )
<br>continue (13.6481609 , 18.8132926 ) (13.6507455 , 18.8183811 )
<br>continue (13.6533466 , 18.8234835 ) (13.6559630 , 18.8285902 )
<br>continue (13.6585952 , 18.8337279 ) (13.6612427 , 18.8388661 )
<br>continue (13.6639072 , 18.8440242 ) (13.6665882 , 18.8491877 )
<br>continue (13.6692853 , 18.8543793 ) (13.6713201 , 18.8582681 )
<br>continue (13.6726815 , 18.8608745 ) (13.6740469 , 18.8634738 )
<br>continue (13.6754172 , 18.8660834 ) (13.6767914 , 18.8686938 )
<br>continue (13.6781704 , 18.8713110 ) (13.6795533 , 18.8739280 )
<br>continue (13.6809407 , 18.8765532 ) (13.6823328 , 18.8791788 )
<br>continue (13.6837295 , 18.8818138 ) (13.6851297 , 18.8844455 )
<br>continue (13.6865353 , 18.8870858 ) (13.6879452 , 18.8897281 )
<br>continue (13.6893604 , 18.8923743 ) (13.6907798 , 18.8950204 )
<br>continue (13.6922034 , 18.8976770 ) (13.6936320 , 18.9003360 )
<br>continue (13.6950656 , 18.9029969 ) (13.6965032 , 18.9056621 )
<br>continue (13.6979465 , 18.9083306 ) (13.6993937 , 18.9110035 )
<br>continue (13.7008464 , 18.9136870 ) (13.7023038 , 18.9163571 )
<br>continue (13.7037658 , 18.9188367 ) (13.7052332 , 18.9141273 )
<br>continue (13.7067050 , 18.9239374 ) (13.7081829 , 18.9271259 )
<br>continue (13.7096651 , 18.9298414 ) (13.7111523 , 18.9316968 )
<br>continue (13.7126447 , 18.9348107 ) (13.7141419 , 18.9379254 )
<br>continue (13.7156449 , 18.9410473 ) (13.7171527 , 18.9441734 )
<br>continue (13.7186661 , 18.9472965 ) (13.7201849 , 18.9504356 )
<br>continue (13.7217084 , 18.9535767 ) (13.7232372 , 18.9567155 )
<br>continue (13.7247722 , 18.9598677 ) (13.7263123 , 18.9630179 )
<br>continue (13.7278575 , 18.9661691 ) (13.7294086 , 18.9693225 )
<br>continue (13.7309655 , 18.9724927 ) (13.7325280 , 18.9756735 )
<br>continue (13.7340954 , 18.9788462 ) (13.7356691 , 18.9820271 )
<br>continue (13.7372483 , 18.9852137 ) (13.7388337 , 18.9883993 )
<br>continue (13.7404243 , 18.9915953 ) (13.7420209 , 18.9947985 )
<br>continue (13.7436234 , 18.9980008 ) (13.7452318 , 19.0012078 )
<br>continue (13.7468466 , 19.0044225 ) (13.7484671 , 19.0076408 )
<br>continue (13.7500932 , 19.0108688 ) (13.7517263 , 19.0140965 )
<br>continue (13.7533647 , 19.0173334 ) (13.7550100 , 19.0205619 )
<br>continue (13.7566612 , 19.0238109 ) (13.7583191 , 19.0270585 )
<br>continue (13.7599827 , 19.0303109 ) (13.7616535 , 19.0335742 )
<br>continue (13.7633299 , 19.0368323 ) (13.7650133 , 19.0399218 )
<br>continue (13.7667035 , 19.0362747 ) (13.7683998 , 19.0462992 )
<br>continue (13.7701028 , 19.0499384 ) (13.7718130 , 19.0532364 )
<br>continue (13.7735290 , 19.0565301 ) (13.7752528 , 19.0598274 )
<br>continue (13.7769829 , 19.0631351 ) (13.7787198 , 19.0664477 )
<br>continue (13.7804642 , 19.0697677 ) (13.7822153 , 19.0730930 )
<br>continue (13.7839736 , 19.0764171 ) (13.7857390 , 19.0797529 )
<br>continue (13.7875122 , 19.0830918 ) (13.7892916 , 19.0864403 )
<br>continue (13.7910791 , 19.0897910 ) (13.7928733 , 19.0931473 )
<br>continue (13.7946755 , 19.0965117 ) (13.7964855 , 19.0998781 )
<br>continue (13.7983025 , 19.1032479 ) (13.8001271 , 19.1066162 )
<br>continue (13.8019598 , 19.1100204 ) (13.8037998 , 19.1134026 )
<br>continue (13.8056476 , 19.1163061 ) (13.8075039 , 19.1129669 )
<br>continue (13.8093678 , 19.1163640 ) (13.8112398 , 19.1269651 )
<br>continue (13.8131198 , 19.1304598 ) (13.8150083 , 19.1339042 )
<br>continue (13.8169045 , 19.1373481 ) (13.8188096 , 19.1407969 )
<br>continue (13.8207228 , 19.1442426 ) (13.8226440 , 19.1477099 )
<br>continue (13.8245742 , 19.1511741 ) (13.8265134 , 19.1546521 )
<br>continue (13.8284607 , 19.1574231 ) (13.8304167 , 19.1615010 )
<br>continue (13.8323818 , 19.1655726 ) (13.8343565 , 19.1687032 )
<br>continue (13.8363393 , 19.1680681 ) (13.8383314 , 19.1778408 )
<br>continue (13.8403326 , 19.1819968 ) (13.8423433 , 19.1861181 )
<br>continue (13.8443635 , 19.1901607 ) (13.8463928 , 19.1943836 )
<br>continue (13.8484318 , 19.1985041 ) (13.8504802 , 19.2026751 )
<br>continue (13.8525385 , 19.2068204 ) (13.8546066 , 19.2107976 )
<br>continue (13.8566848 , 19.2091488 ) (13.8587723 , 19.2192239 )
<br>continue (13.8608708 , 19.2235017 ) (13.8629789 , 19.2277411 )
<br>continue (13.8650975 , 19.2319307 ) (13.8672264 , 19.2360538 )
<br>continue (13.8693655 , 19.2342980 ) (13.8715157 , 19.2406098 )
<br>continue (13.8736763 , 19.2467233 ) (13.8758481 , 19.2530550 )
<br>continue (13.8780304 , 19.2573313 ) (13.8802235 , 19.2615617 )
<br>continue (13.8824283 , 19.2658040 ) (13.8846442 , 19.2649075 )
<br>continue (13.8868713 , 19.2740832 ) (13.8891100 , 19.2786680 )
<br>continue (13.8913601 , 19.2829846 ) (13.8936220 , 19.2852658 )
<br>continue (13.8958958 , 19.2885997 ) (13.8981814 , 19.2959081 )
<br>continue (13.9004791 , 19.3001033 ) (13.9027897 , 19.2963207 )
<br>continue (13.9051118 , 19.3061610 ) (13.9074468 , 19.3129516 )
<br>continue (13.9097945 , 19.3137559 ) (13.9121545 , 19.3219728 )
<br>continue (13.9145277 , 19.3230738 ) (13.9169143 , 19.3304500 )
<br>continue (13.9193135 , 19.3321787 ) (13.9217260 , 19.3390249 )
<br>continue (13.9241526 , 19.3413633 ) (13.9265925 , 19.3460867 )
<br>continue (13.9290458 , 19.3509700 ) (13.9315138 , 19.3553310 )
<br>continue (13.9339952 , 19.3596193 ) (13.9364911 , 19.3642413 )
<br>continue (13.9390018 , 19.3686953 ) (13.9415263 , 19.3732065 )
<br>continue (13.9440664 , 19.3777370 ) (13.9466212 , 19.3822821 )
<br>continue (13.9491909 , 19.3868003 ) (13.9517760 , 19.3913509 )
<br>continue (13.9543766 , 19.3958113 ) (13.9569925 , 19.3994483 )
<br>continue (13.9596247 , 19.3985425 ) (13.9622732 , 19.4098228 )
<br>continue (13.9649372 , 19.4150116 ) (13.9676182 , 19.4205612 )
<br>continue (13.9703157 , 19.4261208 ) (13.9723500 , 19.4302999 )
<br>continue (13.9737114 , 19.4330960 ) (13.9750769 , 19.4358774 )
<br>continue (13.9764472 , 19.4386831 ) (13.9778214 , 19.4414832 )
<br>continue (13.9792000 , 19.4442638 ) (13.9805833 , 19.4470894 )
<br>continue (13.9819707 , 19.4498801 ) (13.9833628 , 19.4526980 )
<br>continue (13.9847590 , 19.4555249 ) (13.9861602 , 19.4583499 )
<br>continue (13.9875657 , 19.4611066 ) (13.9889757 , 19.4639985 )
<br>continue (13.9903904 , 19.4668252 ) (13.9918093 , 19.4695496 )
<br>continue (13.9932334 , 19.4685427 ) (13.9946620 , 19.4666039 )
<br>continue (13.9960951 , 19.4780147 ) (13.9975336 , 19.4810055 )
<br>continue (13.9989760 , 19.4838747 ) (14.0004254 , 19.4867215 )
<br>continue (14.0018764 , 19.4895833 ) (14.0033356 , 19.4924377 )
<br>continue (14.0047941 , 19.4953037 ) (14.0062649 , 19.4981611 )
<br>continue (14.0077350 , 19.5010276 ) (14.0092129 , 19.5038942 )
<br>continue (14.0106942 , 19.5067722 ) (14.0121832 , 19.5096098 )
<br>continue (14.0136755 , 19.5125255 ) (14.0151711 , 19.5153270 )
<br>continue (14.0166741 , 19.5179612 ) (14.0181844 , 19.5103158 )
<br>continue (14.0196977 , 19.5226060 ) (14.0212141 , 19.5268988 )
<br>continue (14.0227376 , 19.5298515 ) (14.0242681 , 19.5327697 )
<br>continue (14.0258013 , 19.5356781 ) (14.0273415 , 19.5385901 )
<br>continue (14.0288883 , 19.5415040 ) (14.0304378 , 19.5444242 )
<br>continue (14.0319939 , 19.5473346 ) (14.0335564 , 19.5501976 )
<br>continue (14.0351254 , 19.5506488 ) (14.0367007 , 19.5463597 )
<br>continue (14.0382783 , 19.5588451 ) (14.0398621 , 19.5619677 )
<br>continue (14.0414559 , 19.5649212 ) (14.0430517 , 19.5678660 )
<br>continue (14.0446534 , 19.5707948 ) (14.0462610 , 19.5737313 )
<br>continue (14.0478782 , 19.5760159 ) (14.0494971 , 19.5689025 )
<br>continue (14.0511216 , 19.5819447 ) (14.0527555 , 19.5854691 )
<br>continue (14.0543947 , 19.5885029 ) (14.0560392 , 19.5905782 )
<br>continue (14.0576927 , 19.5819262 ) (14.0593475 , 19.5872326 )
<br>continue (14.0610112 , 19.5988499 ) (14.0626835 , 19.6033803 )
<br>continue (14.0643606 , 19.6063629 ) (14.0660425 , 19.6089545 )
<br>continue (14.0677328 , 19.6026662 ) (14.0694313 , 19.6146165 )
<br>continue (14.0711342 , 19.6183611 ) (14.0728415 , 19.6205961 )
<br>continue (14.0745605 , 19.6154211 ) (14.0762835 , 19.6271196 )
<br>continue (14.0780143 , 19.6304916 ) (14.0797491 , 19.6250661 )
<br>continue (14.0814949 , 19.6358893 ) (14.0832445 , 19.6351807 )
<br>continue (14.0850050 , 19.6381657 ) (14.0867690 , 19.6430257 )
<br>continue (14.0885436 , 19.6431878 ) (14.0903216 , 19.6464931 )
<br>continue (14.0921098 , 19.6520157 ) (14.0939047 , 19.6521266 )
<br>continue (14.0957062 , 19.6557068 ) (14.0975141 , 19.6592148 )
<br>continue (14.0993318 , 19.6623315 ) (14.1011557 , 19.6655508 )
<br>continue (14.1029891 , 19.6684654 ) (14.1048284 , 19.6718684 )
<br>continue (14.1066770 , 19.6752392 ) (14.1085346 , 19.6786077 )
<br>continue (14.1103978 , 19.6819589 ) (14.1122698 , 19.6851792 )
<br>continue (14.1141504 , 19.6882983 ) (14.1160396 , 19.6913872 )
<br>continue (14.1179338 , 19.6944768 ) (14.1198396 , 19.6970722 )
<br>continue (14.1217535 , 19.7004924 ) (14.1236753 , 19.7038607 )
<br>continue (14.1256049 , 19.7076149 ) (14.1275421 , 19.7113429 )
<br>continue (14.1294901 , 19.7150697 ) (14.1314454 , 19.7187651 )
<br>continue (14.1334112 , 19.7225548 ) (14.1353871 , 19.7263008 )
<br>continue (14.1373699 , 19.7300121 ) (14.1393627 , 19.7331724 )
<br>continue (14.1413620 , 19.7260873 ) (14.1433740 , 19.7411150 )
<br>continue (14.1453922 , 19.7451054 ) (14.1474228 , 19.7488829 )
<br>continue (14.1494624 , 19.7526635 ) (14.1515108 , 19.7562192 )
<br>continue (14.1535679 , 19.7603195 ) (14.1556366 , 19.7641259 )
<br>continue (14.1577136 , 19.7679450 ) (14.1598017 , 19.7717563 )
<br>continue (14.1619008 , 19.7755674 ) (14.1640077 , 19.7792246 )
<br>continue (14.1661280 , 19.7832180 ) (14.1682558 , 19.7870744 )
<br>continue (14.1703967 , 19.7909195 ) (14.1725446 , 19.7947755 )
<br>continue (14.1747051 , 19.7986269 ) (14.1768781 , 19.8024864 )
<br>continue (14.1790603 , 19.8063527 ) (14.1812546 , 19.8101952 )
<br>continue (14.1834578 , 19.8140951 ) (14.1856753 , 19.8175482 )
<br>continue (14.1879013 , 19.8101954 ) (14.1901411 , 19.8254240 )
<br>continue (14.1923890 , 19.8296474 ) (14.1946531 , 19.8335765 )
<br>continue (14.1969247 , 19.8372785 ) (14.1992120 , 19.8413033 )
<br>continue (14.2015091 , 19.8449392 ) (14.2038186 , 19.8375109 )
<br>continue (14.2061429 , 19.8524615 ) (14.2084763 , 19.8570250 )
<br>continue (14.2108240 , 19.8610360 ) (14.2131856 , 19.8655177 )
<br>continue (14.2155583 , 19.8684958 ) (14.2179443 , 19.8636190 )
<br>continue (14.2203435 , 19.8787568 ) (14.2227555 , 19.8837142 )
<br>continue (14.2251826 , 19.8881858 ) (14.2276219 , 19.8927414 )
<br>continue (14.2300758 , 19.8972882 ) (14.2325438 , 19.9018501 )
<br>continue (14.2350257 , 19.9056991 ) (14.2375211 , 19.8993928 )
<br>continue (14.2400323 , 19.9155163 ) (14.2425563 , 19.9203126 )
<br>continue (14.2450954 , 19.9245760 ) (14.2476517 , 19.9294546 )
<br>continue (14.2502199 , 19.9243574 ) (14.2528069 , 19.9363632 )
<br>continue (14.2554076 , 19.9434501 ) (14.2580216 , 19.9480808 )
<br>continue (14.2606556 , 19.9430217 ) (14.2633022 , 19.9551440 )
<br>continue (14.2659681 , 19.9620316 ) (14.2686482 , 19.9569557 )
<br>continue (14.2713466 , 19.9694995 ) (14.2733810 , 19.9748131 )
<br>continue (14.2747419 , 19.9742044 ) (14.2761078 , 19.9608701 )
<br>continue (14.2774763 , 19.9808784 ) (14.2788519 , 19.9835351 )
<br>continue (14.2802300 , 19.9723197 ) (14.2816128 , 19.9821511 )
<br>continue (14.2830003 , 19.9902071 ) (14.2843924 , 19.9777216 )
<br>continue (14.2857890 , 19.9916781 ) (14.2871902 , 19.9928712 )
<br>continue (14.2885957 , 19.9868423 ) (14.2900057 , 19.9963093 )
<br>continue (14.2914199 , 19.9935046 ) (14.2928384 , 19.9939929 )
<br>continue (14.2942634 , 20.0022636 ) (14.2956924 , 20.0007183 )
<br>continue (14.2971256 , 20.0020766 ) (14.2985627 , 20.0042983 )
<br>continue (14.3000060 , 20.0061766 ) (14.3014532 , 20.0100866 )
<br>continue (14.3029064 , 20.0125706 ) (14.3043634 , 20.0157891 )
<br>continue (14.3058263 , 20.0189006 ) (14.3072927 , 20.0217103 )
<br>continue (14.3087650 , 20.0244384 ) (14.3102429 , 20.0268528 )
<br>continue (14.3118725 , 20.0293305 ) (14.3133610 , 20.0305693 )
<br>continue (14.3147055 , 20.0326304 ) (14.3162032 , 20.0353612 )
<br>continue (14.3177041 , 20.0375271 ) (14.3192123 , 20.0405246 )
<br>continue (14.3207257 , 20.0430874 ) (14.3222441 , 20.0457581 )
<br>continue (14.3237676 , 20.0485773 ) (14.3252981 , 20.0514084 )
<br>continue (14.3268313 , 20.0542169 ) (14.3283714 , 20.0570686 )
<br>continue (14.3299183 , 20.0598890 ) (14.3314698 , 20.0627139 )
<br>continue (14.3330259 , 20.0655078 ) (14.3345884 , 20.0684068 )
<br>continue (14.3361554 , 20.0712185 ) (14.3377287 , 20.0740576 )
<br>continue (14.3393083 , 20.0767111 ) (14.3408940 , 20.0796739 )
<br>continue (14.3424839 , 20.0825855 ) (14.3440817 , 20.0854138 )
<br>continue (14.3456834 , 20.0882416 ) (14.3472910 , 20.0911485 )
<br>continue (14.3489062 , 20.0939512 ) (14.3505271 , 20.0968945 )
<br>continue (14.3521536 , 20.0997587 ) (14.3537855 , 20.1026246 )
<br>continue (14.3554247 , 20.1054882 ) (14.3570692 , 20.1081500 )
<br>continue (14.3587208 , 20.1112219 ) (14.3603794 , 20.1140947 )
<br>continue (14.3620431 , 20.1169633 ) (14.3637135 , 20.1194657 )
<br>continue (14.3653906 , 20.1226578 ) (14.3670744 , 20.1246864 )
<br>continue (14.3687628 , 20.1079964 ) (14.3704594 , 20.1291974 )
<br>continue (14.3721624 , 20.1341749 ) (14.3738734 , 20.1371137 )
<br>continue (14.3755886 , 20.1399064 ) (14.3773135 , 20.1426732 )
<br>continue (14.3790425 , 20.1456314 ) (14.3807809 , 20.1484749 )
<br>continue (14.3825249 , 20.1516002 ) (14.3842763 , 20.1544532 )
<br>continue (14.3860332 , 20.1573357 ) (14.3877990 , 20.1602143 )
<br>continue (14.3895718 , 20.1631742 ) (14.3913515 , 20.1660931 )
<br>continue (14.3931398 , 20.1689507 ) (14.3949330 , 20.1718532 )
<br>continue (14.3967362 , 20.1748177 ) (14.3985459 , 20.1770657 )
<br>continue (14.4003618 , 20.1806862 ) (14.4021874 , 20.1832485 )
<br>continue (14.4040191 , 20.1863200 ) (14.4058601 , 20.1886871 )
<br>continue (14.4077086 , 20.1923304 ) (14.4095646 , 20.1948332 )
<br>continue (14.4114278 , 20.1978539 ) (14.4132998 , 20.2011197 )
<br>continue (14.4151804 , 20.2040768 ) (14.4170679 , 20.2070068 )
<br>continue (14.4189638 , 20.2098337 ) (14.4208696 , 20.2128200 )
<br>continue (14.4227818 , 20.2149720 ) (14.4247036 , 20.2177569 )
<br>continue (14.4266349 , 20.2216510 ) (14.4285737 , 20.2246224 )
<br>continue (14.4305201 , 20.2279387 ) (14.4324770 , 20.2314885 )
<br>continue (14.4344427 , 20.2345606 ) (14.4364155 , 20.2345582 )
<br>continue (14.4383999 , 20.2213670 ) (14.4403911 , 20.2452280 )
<br>continue (14.4423935 , 20.2475774 ) (14.4444040 , 20.2527024 )
<br>continue (14.4464238 , 20.2560826 ) (14.4484528 , 20.2589428 )
<br>continue (14.4504924 , 20.2635011 ) (14.4525408 , 20.2670581 )
<br>continue (14.4545979 , 20.2704876 ) (14.4566666 , 20.2740955 )
<br>continue (14.4587451 , 20.2778474 ) (14.4608332 , 20.2814165 )
<br>continue (14.4629308 , 20.2846092 ) (14.4650391 , 20.2886182 )
<br>continue (14.4671580 , 20.2921584 ) (14.4692858 , 20.2956514 )
<br>continue (14.4714252 , 20.2982726 ) (14.4735760 , 20.2879339 )
<br>continue (14.4757365 , 20.2980192 ) (14.4772559 , 20.3089502 )
<br>continue (14.4781262 , 20.3105017 ) (14.4789977 , 20.3119676 )
<br>continue (14.4798717 , 20.3133695 ) (14.4807469 , 20.3147765 )
<br>continue (14.4816246 , 20.3161310 ) (14.4825034 , 20.3177496 )
<br>continue (14.4833847 , 20.3191612 ) (14.4842671 , 20.3206319 )
<br>continue (14.4851519 , 20.3220996 ) (14.4860378 , 20.3235589 )
<br>continue (14.4869261 , 20.3249798 ) (14.4878155 , 20.3264181 )
<br>continue (14.4887072 , 20.3278768 ) (14.4896013 , 20.3290349 )
<br>continue (14.4904964 , 20.3306553 ) (14.4913939 , 20.3319251 )
<br>continue (14.4922937 , 20.3336158 ) (14.4931945 , 20.3339563 )
<br>continue (14.4940975 , 20.3359860 ) (14.4950015 , 20.3370621 )
<br>continue (14.4959091 , 20.3343388 ) (14.4968176 , 20.2968387 )
<br>continue (14.4977283 , 20.3340909 ) (14.4986399 , 20.3417886 )
<br>continue (14.4995551 , 20.3449705 ) (14.5004711 , 20.3460559 )
<br>continue (14.5013893 , 20.3480559 ) (14.5023097 , 20.3494818 )
<br>continue (14.5032308 , 20.3500664 ) (14.5041554 , 20.3523004 )
<br>continue (14.5050808 , 20.3538479 ) (14.5060096 , 20.3551268 )
<br>continue (14.5069391 , 20.3566645 ) (14.5078707 , 20.3577697 )
<br>continue (14.5088043 , 20.3593085 ) (14.5097414 , 20.3580837 )
<br>continue (14.5106790 , 20.3546802 ) (14.5116187 , 20.3185528 )
<br>continue (14.5125617 , 20.3591058 ) (14.5135053 , 20.3656847 )
<br>continue (14.5144508 , 20.3678079 ) (14.5153996 , 20.3697139 )
<br>continue (14.5163502 , 20.3709756 ) (14.5173028 , 20.3722908 )
<br>continue (14.5182572 , 20.3728290 ) (14.5192135 , 20.3738477 )
<br>continue (14.5201716 , 20.3753222 ) (14.5211329 , 20.3618900 )
<br>continue (14.5220959 , 20.3429909 ) (14.5230607 , 20.3780259 )
<br>continue (14.5240285 , 20.3822521 ) (14.5249981 , 20.3840623 )
<br>continue (14.5259695 , 20.3849142 ) (14.5269425 , 20.3861080 )
<br>continue (14.5279185 , 20.3852668 ) (14.5288974 , 20.3482832 )
<br>continue (14.5298780 , 20.3793602 ) (14.5308602 , 20.3911860 )
<br>continue (14.5318454 , 20.3934017 ) (14.5328321 , 20.3945265 )
<br>continue (14.5338216 , 20.3884802 ) (14.5348127 , 20.3550188 )
<br>continue (14.5358066 , 20.3949112 ) (14.5368020 , 20.4000388 )
<br>continue (14.5378015 , 20.3985655 ) (14.5388011 , 20.3605734 )
<br>continue (14.5398048 , 20.3970994 ) (14.5408098 , 20.4041459 )
<br>continue (14.5418175 , 20.3801268 ) (14.5428279 , 20.3867718 )
<br>continue (14.5438397 , 20.4061540 ) (14.5448540 , 20.3707647 )
<br>continue (14.5458722 , 20.4046548 ) (14.5468917 , 20.3780922 )
<br>continue (14.5479125 , 20.4026101 ) (14.5489370 , 20.3793697 )
<br>continue (14.5499640 , 20.3919418 ) (14.5509935 , 20.3926553 )
<br>continue (14.5520242 , 20.3864245 ) (14.5530585 , 20.3867287 )
<br>continue (14.5540953 , 20.3849895 ) (14.5551344 , 20.3895871 )
<br>continue (14.5561758 , 20.3906477 ) (14.5572196 , 20.3941102 )
<br>continue (14.5582657 , 20.3976990 ) (14.5593152 , 20.4004219 )
<br>continue (14.5603670 , 20.4027438 ) (14.5614210 , 20.4040845 )
<br>continue (14.5624773 , 20.4054856 ) (14.5635369 , 20.4036014 )
<br>continue (14.5645986 , 20.4052421 ) (14.5656637 , 20.4067086 )
<br>continue (14.5667297 , 20.4084930 ) (14.5678001 , 20.4099683 )
<br>continue (14.5688726 , 20.4115671 ) (14.5699471 , 20.4133512 )
<br>continue (14.5710248 , 20.4149165 ) (14.5721057 , 20.4165273 )
<br>continue (14.5731885 , 20.4180899 ) (14.5742744 , 20.4188862 )
<br>continue (14.5753622 , 20.4213070 ) (14.5764531 , 20.4225904 )
<br>continue (14.5775469 , 20.4245413 ) (14.5786438 , 20.4261117 )
<br>continue (14.5797436 , 20.4268294 ) (14.5808463 , 20.4286938 )
<br>continue (14.5819508 , 20.4307641 ) (14.5830593 , 20.4326315 )
<br>continue (14.5841695 , 20.4342939 ) (14.5852836 , 20.4359926 )
<br>continue (14.5863994 , 20.4350215 ) (14.5875190 , 20.4393369 )
<br>continue (14.5886414 , 20.4410386 ) (14.5897665 , 20.4425097 )
<br>continue (14.5908942 , 20.4443834 ) (14.5920257 , 20.4460657 )
<br>continue (14.5931597 , 20.4477075 ) (14.5942964 , 20.4494823 )
<br>continue (14.5954356 , 20.4511805 ) (14.5965784 , 20.4527521 )
<br>continue (14.5977248 , 20.4545188 ) (14.5988736 , 20.4562102 )
<br>continue (14.6000260 , 20.4578530 ) (14.6011807 , 20.4593320 )
<br>continue (14.6023389 , 20.4610732 ) (14.6035005 , 20.4625755 )
<br>continue (14.6046644 , 20.4644780 ) (14.6058317 , 20.4660871 )
<br>continue (14.6070023 , 20.4679604 ) (14.6081761 , 20.4698926 )
<br>continue (14.6093532 , 20.4717131 ) (14.6105335 , 20.4734777 )
<br>continue (14.6117169 , 20.4752228 ) (14.6129035 , 20.4768886 )
<br>continue (14.6140932 , 20.4779709 ) (14.6152860 , 20.4806501 )
<br>continue (14.6164829 , 20.4823477 ) (14.6176827 , 20.4833112 )
<br>continue (14.6188855 , 20.4860179 ) (14.6200923 , 20.4877788 )
<br>continue (14.6213020 , 20.4895301 ) (14.6225145 , 20.4913487 )
<br>continue (14.6237309 , 20.4930196 ) (14.6249511 , 20.4946611 )
<br>continue (14.6261740 , 20.4968147 ) (14.6274017 , 20.4967111 )
<br>continue (14.6286321 , 20.5000063 ) (14.6298651 , 20.5021095 )
<br>continue (14.6311027 , 20.5038295 ) (14.6323439 , 20.5057377 )
<br>continue (14.6335876 , 20.5074983 ) (14.6348358 , 20.5092524 )
<br>continue (14.6360875 , 20.5108835 ) (14.6373426 , 20.5128149 )
<br>continue (14.6386011 , 20.5145672 ) (14.6398638 , 20.5164157 )
<br>continue (14.6411299 , 20.5181485 ) (14.6424002 , 20.5198684 )
<br>continue (14.6436737 , 20.5217576 ) (14.6449514 , 20.5233870 )
<br>continue (14.6462321 , 20.5253890 ) (14.6475170 , 20.5271271 )
<br>continue (14.6488058 , 20.5288288 ) (14.6500986 , 20.5306665 )
<br>continue (14.6513943 , 20.5313255 ) (14.6526949 , 20.5331276 )
<br>continue (14.6539993 , 20.5360128 ) (14.6553075 , 20.5375943 )
<br>continue (14.6566194 , 20.5392304 ) (14.6579350 , 20.5388323 )
<br>continue (14.6592552 , 20.4997974 ) (14.6605790 , 20.5359564 )
<br>continue (14.6619073 , 20.5463916 ) (14.6632400 , 20.5491021 )
<br>continue (14.6645762 , 20.5511724 ) (14.6659167 , 20.5534818 )
<br>continue (14.6672614 , 20.5549658 ) (14.6686095 , 20.5574565 )
<br>continue (14.6699627 , 20.5591070 ) (14.6713201 , 20.5613051 )
<br>continue (14.6726815 , 20.5620408 ) (14.6740469 , 20.5635622 )
<br>continue (14.6754172 , 20.5673329 ) (14.6767914 , 20.5690197 )
<br>continue (14.6781704 , 20.5713019 ) (14.6795533 , 20.5733046 )
<br>continue (14.6809407 , 20.5742352 ) (14.6823328 , 20.5770794 )
<br>continue (14.6837295 , 20.5792221 ) (14.6851297 , 20.5811631 )
<br>continue (14.6865353 , 20.5829917 ) (14.6879452 , 20.5840961 )
<br>continue (14.6893604 , 20.5869842 ) (14.6907798 , 20.5889716 )
<br>continue (14.6922034 , 20.5909010 ) (14.6936320 , 20.5928671 )
<br>continue (14.6950656 , 20.5948220 ) (14.6965032 , 20.5967798 )
<br>continue (14.6979465 , 20.5987538 ) (14.6993937 , 20.6000897 )
<br>continue (14.7008464 , 20.6025656 ) (14.7023038 , 20.6040075 )
<br>continue (14.7037658 , 20.6065217 ) (14.7052332 , 20.6084400 )
<br>continue (14.7067050 , 20.6097476 ) (14.7081829 , 20.6084437 )
<br>continue (14.7096651 , 20.6143168 ) (14.7111523 , 20.6161371 )
<br>continue (14.7126447 , 20.6180552 ) (14.7141419 , 20.6197102 )
<br>continue (14.7156449 , 20.6216406 ) (14.7171527 , 20.6233866 )
<br>continue (14.7186661 , 20.6253605 ) (14.7201849 , 20.6272387 )
<br>continue (14.7217084 , 20.6290686 ) (14.7232372 , 20.6310172 )
<br>continue (14.7247722 , 20.6329493 ) (14.7263123 , 20.6358666 )
<br>continue (14.7278575 , 20.6378195 ) (14.7294086 , 20.6398221 )
<br>continue (14.7309655 , 20.6418582 ) (14.7325280 , 20.6441091 )
<br>continue (14.7340954 , 20.6461556 ) (14.7356691 , 20.6484028 )
<br>continue (14.7372483 , 20.6508369 ) (14.7388337 , 20.6529392 )
<br>continue (14.7404243 , 20.6553545 ) (14.7420209 , 20.6572097 )
<br>continue (14.7436234 , 20.6596104 ) (14.7452318 , 20.6622900 )
<br>continue (14.7468466 , 20.6646367 ) (14.7484671 , 20.6668318 )
<br>continue (14.7500932 , 20.6689981 ) (14.7517263 , 20.6706928 )
<br>continue (14.7533647 , 20.6738470 ) (14.7550100 , 20.6746487 )
<br>continue (14.7566612 , 20.6781136 ) (14.7583191 , 20.6795678 )
<br>continue (14.7599827 , 20.6818554 ) (14.7616535 , 20.6846693 )
<br>continue (14.7633299 , 20.6863243 ) (14.7650133 , 20.6889667 )
<br>continue (14.7667035 , 20.6917273 ) (14.7683998 , 20.6939578 )
<br>continue (14.7701028 , 20.6965825 ) (14.7718130 , 20.6988620 )
<br>continue (14.7735290 , 20.6983887 ) (14.7752528 , 20.7029803 )
<br>continue (14.7769829 , 20.7023246 ) (14.7787198 , 20.7080563 )
<br>continue (14.7804642 , 20.7107714 ) (14.7822153 , 20.7125917 )
<br>continue (14.7839736 , 20.7117955 ) (14.7857390 , 20.7169380 )
<br>continue (14.7875122 , 20.7180949 ) (14.7892916 , 20.6802816 )
<br>continue (14.7910791 , 20.7107740 ) (14.7928733 , 20.7250835 )
<br>continue (14.7946755 , 20.7279721 ) (14.7964855 , 20.7307873 )
<br>continue (14.7983025 , 20.7331496 ) (14.8001271 , 20.7343166 )
<br>continue (14.8019598 , 20.7365913 ) (14.8037998 , 20.7365034 )
<br>continue (14.8056476 , 20.7411282 ) (14.8075039 , 20.7433601 )
<br>continue (14.8093678 , 20.7450778 ) (14.8112398 , 20.7467448 )
<br>continue (14.8131198 , 20.7503210 ) (14.8150083 , 20.7513184 )
<br>continue (14.8169045 , 20.7544794 ) (14.8188096 , 20.7545448 )
<br>continue (14.8207228 , 20.7579828 ) (14.8226440 , 20.7603506 )
<br>continue (14.8245742 , 20.7609203 ) (14.8265134 , 20.7608630 )
<br>continue (14.8284607 , 20.7671920 ) (14.8304167 , 20.7684230 )
<br>continue (14.8323818 , 20.7708568 ) (14.8343565 , 20.7707696 )
<br>continue (14.8363393 , 20.7750271 ) (14.8383314 , 20.7409078 )
<br>continue (14.8403326 , 20.7653936 ) (14.8423433 , 20.7822110 )
<br>continue (14.8443635 , 20.7863288 ) (14.8463928 , 20.7873675 )
<br>continue (14.8484318 , 20.7913435 ) (14.8504802 , 20.7941750 )
<br>continue (14.8525385 , 20.7969063 ) (14.8546066 , 20.7991904 )
<br>continue (14.8566848 , 20.8008319 ) (14.8587723 , 20.8027659 )
<br>continue (14.8608708 , 20.8022720 ) (14.8629789 , 20.7681482 )
<br>continue (14.8650975 , 20.8009691 ) (14.8672264 , 20.8126392 )
<br>continue (14.8693655 , 20.8166680 ) (14.8715157 , 20.8142412 )
<br>continue (14.8736763 , 20.8202484 ) (14.8758481 , 20.8211946 )
<br>continue (14.8780304 , 20.7753510 ) (14.8802235 , 20.8264252 )
<br>continue (14.8824283 , 20.8244959 ) (14.8846442 , 20.8306111 )
<br>continue (14.8868713 , 20.7879274 ) (14.8891100 , 20.8327649 )
<br>continue (14.8913601 , 20.8304068 ) (14.8936220 , 20.7970640 )
<br>continue (14.8958958 , 20.8264510 ) (14.8981814 , 20.8122101 )
<br>continue (14.9004791 , 20.7998611 ) (14.9027897 , 20.7995478 )
<br>continue (14.9051118 , 20.7714035 ) (14.9074468 , 20.7669881 )
<br>continue (14.9097945 , 20.7344481 ) (14.9121545 , 20.7290676 )
<br>continue (14.9145277 , 20.7377370 ) (14.9157195 , 20.7101576 )
<br>continue (14.9169143 , 20.7110022 ) (14.9193135 , 20.7135526 )
<br>continue (14.9217260 , 20.7158968 ) (14.9241526 , 20.7189466 )
<br>continue (14.9265925 , 20.7213018 ) (14.9290458 , 20.7236549 )
<br>continue (14.9315138 , 20.7257830 ) (14.9339952 , 20.7273337 )
<br>continue (14.9364911 , 20.7295802 ) (14.9390018 , 20.7318135 )
<br>continue (14.9415263 , 20.7338661 ) (14.9440664 , 20.7357656 )
<br>continue (14.9466212 , 20.7377699 ) (14.9491909 , 20.7405059 )
<br>continue (14.9517760 , 20.7427976 ) (14.9543766 , 20.7461073 )
<br>continue (14.9569925 , 20.7490644 ) (14.9596247 , 20.7509767 )
<br>continue (14.9622732 , 20.7533884 ) (14.9649372 , 20.7555752 )
<br>continue (14.9676182 , 20.7580076 ) (14.9703157 , 20.7602954 )
<br>continue (14.9730299 , 20.7607514 ) (14.9757617 , 20.7655436 )
<br>continue (14.9785101 , 20.7684462 ) (14.9812762 , 20.7702308 )
<br>continue (14.9840604 , 20.7728479 ) (14.9868622 , 20.7763284 )
<br>continue (14.9896825 , 20.7785574 ) (14.9925208 , 20.7814900 )
<br>continue (14.9953781 , 20.7845740 ) (14.9982541 , 20.7868514 )
<br>continue (15.0011494 , 20.7879439 ) (15.0040633 , 20.7905133 )
<br>continue (15.0070006 , 20.7922193 ) (15.0099520 , 20.7955767 )
<br>continue (15.0129258 , 20.7996775 ) (15.0151711 , 20.7979714 )
<br>continue (15.0166741 , 20.7999967 ) (15.0181844 , 20.7997405 )
<br>continue (15.0196977 , 20.8025848 ) (15.0212141 , 20.8009252 )
<br>continue (15.0227376 , 20.8011453 ) (15.0242681 , 20.8036728 )
<br>continue (15.0258013 , 20.8088177 ) (15.0273415 , 20.8110574 )
<br>continue (15.0288883 , 20.8069620 ) (15.0304378 , 20.8030695 )
<br>continue (15.0319939 , 20.8133920 ) (15.0335564 , 20.8146351 )
<br>continue (15.0351254 , 20.8120911 ) (15.0367007 , 20.8109219 )
<br>continue (15.0382783 , 20.8118893 ) (15.0398621 , 20.8209334 )
<br>continue (15.0414559 , 20.8188061 ) (15.0430517 , 20.8199421 )
<br>continue (15.0446534 , 20.8238376 ) (15.0462610 , 20.8235531 )
<br>continue (15.0478782 , 20.8273874 ) (15.0494971 , 20.8288282 )
<br>continue (15.0511216 , 20.8271335 ) (15.0527555 , 20.8326301 )
<br>continue (15.0543947 , 20.8344119 ) (15.0560392 , 20.8301937 )
<br>continue (15.0576927 , 20.8307463 ) (15.0593475 , 20.8301122 )
<br>continue (15.0610112 , 20.8318217 ) (15.0626835 , 20.8354809 )
<br>continue (15.0643606 , 20.8368835 ) (15.0660425 , 20.8386595 )
<br>continue (15.0677328 , 20.8350770 ) (15.0694313 , 20.8373400 )
<br>continue (15.0711342 , 20.8342417 ) (15.0728415 , 20.8375283 )
<br>continue (15.0745605 , 20.8385054 ) (15.0757659 , 20.8437609 )
<br>continue (15.0766295 , 20.8388094 ) (15.0780143 , 20.8481778 )
<br>continue (15.0797491 , 20.8388406 ) (15.0814949 , 20.8488728 )
<br>continue (15.0832445 , 20.8455956 ) (15.0850050 , 20.8494162 )
<br>continue (15.0867690 , 20.8509940 ) (15.0885436 , 20.8540438 )
<br>continue (15.0903216 , 20.8505031 ) (15.0921098 , 20.8559827 )
<br>continue (15.0939047 , 20.8539479 ) (15.0957062 , 20.8539014 )
<br>continue (15.0975141 , 20.8589165 ) (15.0993318 , 20.8542752 )
<br>continue (15.1011557 , 20.8613448 ) (15.1029891 , 20.8609031 )
<br>continue (15.1048284 , 20.8670840 ) (15.1066770 , 20.8635783 )
<br>continue (15.1085346 , 20.8667000 ) (15.1103978 , 20.8483710 )
<br>continue (15.1122698 , 20.8731369 ) (15.1141504 , 20.8770234 )
<br>continue (15.1160396 , 20.8784707 ) (15.1179338 , 20.8848713 )
<br>continue (15.1198396 , 20.8845119 ) (15.1217535 , 20.8832296 )
<br>continue (15.1236753 , 20.8819170 ) (15.1256049 , 20.8859402 )
<br>continue (15.1275421 , 20.8909295 ) (15.1294901 , 20.8866487 )
<br>continue (15.1314454 , 20.8909706 ) (15.1334112 , 20.8960091 )
<br>continue (15.1353871 , 20.8996061 ) (15.1373699 , 20.8959372 )
<br>continue (15.1393627 , 20.8995951 ) (15.1413620 , 20.9009300 )
<br>continue (15.1433740 , 20.9051882 ) (15.1453922 , 20.9020657 )
<br>continue (15.1474228 , 20.9028139 ) (15.1494624 , 20.9089333 )
<br>continue (15.1515108 , 20.9084765 ) (15.1535679 , 20.9084158 )
<br>continue (15.1556366 , 20.9069867 ) (15.1577136 , 20.9133285 )
<br>continue (15.1591760 , 20.9101960 ) (15.1600121 , 20.9170104 )
<br>continue (15.1619008 , 20.9075934 ) (15.1640077 , 20.9037734 )
<br>continue (15.1661280 , 20.9110545 ) (15.1682558 , 20.9094826 )
<br>continue (15.1703967 , 20.9170120 ) (15.1725446 , 20.9130207 )
<br>continue (15.1747051 , 20.9162580 ) (15.1768781 , 20.9131930 )
<br>continue (15.1792788 , 20.9175061 ) (15.1810342 , 20.9240431 )
<br>continue (15.1830163 , 20.9212864 ) (15.1856753 , 20.9137567 )
<br>continue (15.1879013 , 20.9228702 ) (15.1901411 , 20.9211483 )
<br>continue (15.1923890 , 20.9167033 ) (15.1946531 , 20.9208276 )
<br>continue (15.1969247 , 20.9268126 ) (15.1992120 , 20.9203903 )
<br>continue (15.2015091 , 20.9264796 ) (15.2038186 , 20.9357992 )
<br>continue (15.2061429 , 20.9294127 ) (15.2084763 , 20.9278225 )
<br>continue (15.2108240 , 20.9314748 ) (15.2131856 , 20.9396437 )
<br>continue (15.2155583 , 20.9431148 ) (15.2179443 , 20.9425872 )
<br>continue (15.2203435 , 20.9500767 ) (15.2227555 , 20.9509988 )
<br>continue (15.2251826 , 20.9486648 ) (15.2276219 , 20.9482058 )
<br>continue (15.2300758 , 20.9476973 ) (15.2325438 , 20.9547625 )
<br>continue (15.2350257 , 20.9516425 ) (15.2375211 , 20.9547117 )
<br>continue (15.2400323 , 20.9500584 ) (15.2425563 , 20.9520107 )
<br>continue (15.2450954 , 20.9576734 ) (15.2476517 , 20.9622063 )
<br>continue (15.2502199 , 20.9673141 ) (15.2522874 , 20.9663978 )
<br>continue (15.2535851 , 20.9563479 ) (15.2554076 , 20.9664733 )
<br>continue (15.2580216 , 20.9619112 ) (15.2606556 , 20.9651523 )
<br>continue (15.2633022 , 20.9652752 ) (15.2659681 , 20.9609796 )
<br>continue (15.2686482 , 20.9631348 ) (15.2713466 , 20.9633275 )
<br>continue (15.2740608 , 20.9677421 ) (15.2767926 , 20.9655749 )
<br>continue (15.2795392 , 20.9619077 ) (15.2823071 , 20.9568071 )
<br>continue (15.2850913 , 20.9503564 ) (15.2878913 , 20.9541729 )
<br>continue (15.2907134 , 20.9585926 ) (15.2935504 , 20.9719208 )
<br>continue (15.2958353 , 20.9749856 ) (15.2972680 , 20.9721165 )
<br>continue (15.2992850 , 20.9806852 ) (15.3021794 , 20.9857388 )
<br>continue (15.3050933 , 20.9882626 ) (15.3080284 , 20.9888451 )
<br>continue (15.3109820 , 20.9918098 ) (15.3139579 , 20.9977515 )
<br>continue (15.3163520 , 21.0013938 ) (15.3178545 , 21.0014036 )
<br>continue (15.3199696 , 20.9990948 ) (15.3230065 , 20.9975905 )
<br>continue (15.3260633 , 21.0006943 ) (15.3291435 , 20.9894352 )
<br>continue (15.3322465 , 20.9904172 ) (15.3353716 , 21.0073845 )
<br>continue (15.3385182 , 21.0069908 ) (15.3416877 , 21.0053318 )
<br>continue (15.3448813 , 21.0134248 ) (15.3480984 , 21.0157185 )
<br>continue (15.3513401 , 21.0042014 ) (15.3546039 , 21.0138094 )
<br>continue (15.3578948 , 21.0175456 ) (15.3612102 , 21.0058195 )
<br>continue (15.3645510 , 21.0063468 ) (15.3679185 , 21.0196084 )
<br>continue (15.3713099 , 21.0178367 ) (15.3747300 , 21.0063706 )
<br>continue (15.3781762 , 21.0126813 ) (15.3816511 , 21.0153272 )
<br>continue (15.3851539 , 21.0105359 ) (15.3886854 , 20.9915584 )
<br>continue (15.3922448 , 20.9563151 ) (15.3958329 , 20.9851882 )
<br>continue (15.3994522 , 20.9978933 ) (15.4031016 , 21.0158556 )
<br>continue (15.4067837 , 20.9968721 ) (15.4104955 , 21.0223135 )
<br>continue (15.4142394 , 21.0222047 ) (15.4180144 , 21.0215109 )
<br>continue (15.4218243 , 21.0271061 ) (15.4256679 , 21.0152727 )
<br>continue (15.4295456 , 21.0248236 ) (15.4334578 , 21.0262241 )
<br>continue (15.4374065 , 21.0303274 ) (15.4413903 , 21.0164613 )
<br>continue (15.4454127 , 21.0290571 ) (15.4494707 , 21.0221481 )
<br>continue (15.4535675 , 21.0338721 ) (15.4577048 , 21.0354687 )
<br>continue (15.4618810 , 21.0099679 ) (15.4660962 , 20.9840066 )
<br>continue (15.4703546 , 21.0193030 ) (15.4746547 , 21.0184895 )
<br>continue (15.4789977 , 21.0059282 ) (15.4833847 , 21.0111914 )
<br>continue (15.4878155 , 20.9634934 ) (15.4922937 , 21.0164097 )
<br>continue (15.4968176 , 21.0031759 ) (15.5013893 , 20.9911616 )
<br>continue (15.5060096 , 20.9684398 ) (15.5106790 , 20.9497798 )
<br>continue (15.5153996 , 20.9306123 ) (15.5201716 , 20.5187147 )
<br>continue (15.5249981 , 20.5149828 ) (15.5298780 , 20.5088732 )
<br>continue (15.5348127 , 20.5026895 ) (15.5398048 , 20.4965167 )
<br>continue (15.5448540 , 20.4890922 ) (15.5499640 , 20.4819935 )
<br>continue (15.5551344 , 20.4695196 ) (15.5603670 , 20.4653689 )
<br>continue (15.5656637 , 20.4524790 ) (15.5710248 , 20.4397668 )
<br>continue (15.5764531 , 20.4273950 ) (15.5819508 , 20.4169112 )
<br>continue (15.5875190 , 20.4100744 ) (15.5931597 , 20.4012568 )
<br>continue (15.5988736 , 20.3955636 ) (15.6046644 , 20.3886029 )
<br>continue (15.6105335 , 20.3827572 ) (15.6158838 , 20.3761773 )
<br>continue (15.6219081 , 20.3694322 ) (15.6286321 , 20.3543073 )
<br>continue (15.6348358 , 20.3504622 ) (15.6411299 , 20.3373556 )
<br>continue (15.6475170 , 20.3322476 ) (15.6539993 , 20.3164550 )
<br>continue (15.6585952 , 20.3008007 ) (15.6639072 , 20.2870590 )
<br>continue (15.6706410 , 20.2683418 ) (15.6774801 , 20.2477458 )
<br>continue (15.6844288 , 20.2425990 ) (15.6914908 , 20.2318864 )
<br>continue (15.6986694 , 20.2238651 ) (15.7059689 , 20.2216289 )
<br>continue (15.7133931 , 20.1938231 ) (15.7209461 , 20.1687242 )
<br>continue (15.7286329 , 20.1404385 ) (15.7364579 , 20.1072712 )
<br>continue (15.7444268 , 20.1031348 ) (15.7525447 , 20.1033898 )
<br>continue (15.7608174 , 20.1028748 ) (15.7675506 , 20.1023320 )
<br>continue (15.7726700 , 20.0828479 ) (15.7778508 , 20.0244241 )
<br>continue (15.7866244 , 19.9959514 ) (15.7955797 , 19.9650485 )
<br>continue (15.8047226 , 19.9331090 ) (15.8140630 , 19.9264220 )
<br>continue (15.8226440 , 19.9209928 ) (15.8323818 , 19.9055285 )
<br>continue (15.8433524 , 19.8730683 ) (15.8515085 , 19.8498471 )
<br>continue (15.8598201 , 19.8266249 ) (15.8693655 , 19.8017786 )
<br>continue (15.8802235 , 19.7733768 ) (15.8913601 , 19.7440281 )
<br>continue (15.9027897 , 19.7066073 ) (15.9133396 , 19.6723264 )
<br>continue (15.9241526 , 19.6358988 ) (15.9352417 , 19.6031699 )
<br>continue (15.9479040 , 19.5812323 ) (15.9609467 , 19.5585046 )
<br>continue (15.9743938 , 19.5305784 ) (15.9882699 , 19.4824727 )
<br>continue (15.9982541 , 19.4486510 ) (16.0055280 , 19.4271399 )
<br>continue (16.0144239 , 19.4018320 ) (16.0235035 , 19.3761200 )
<br>continue (16.0319939 , 19.3522018 ) (16.0398621 , 19.3302289 )
<br>continue (16.0478782 , 19.3079525 ) (16.0552177 , 19.2876509 )
<br>continue (16.0618481 , 19.2693807 ) (16.0672271 , 19.2461043 )
<br>continue (16.0747324 , 19.2139237 ) (16.0850050 , 19.1704315 )
<br>continue (16.0966111 , 19.1220399 ) (16.1076034 , 19.0769092 )
<br>continue (16.1150944 , 19.0465551 ) (16.1211789 , 17.6391991 )
<br>continue (16.1285156 , 17.5295684 ) (16.1347921 , 17.4372264 )
<br>continue (16.1419637 , 17.3312064 ) (16.1535679 , 17.1636239 )
<br>continue (16.1650662 , 16.9692034 ) (16.1718990 , 16.8543482 )
<br>continue (16.1792788 , 16.7225695 ) (16.1892432 , 16.5336645 )
<br>continue (16.1957862 , 16.4120568 ) (16.2070740 , 16.2067905 )
<br>continue (16.2174655 , 16.0226717 ) (16.2210672 , 15.9599413 )
<br>continue (16.2293388 , 15.7813512 ) (16.2377724 , 15.6005237 )
<br>continue (16.2456064 , 15.4356819 ) (16.2567129 , 15.2070487 )
<br>continue (16.2673055 , 14.9943570 ) (16.2759698 , 14.7987223 )
<br>continue (16.2859284 , 14.5310628 ) (16.2978436 , 14.2190644 )
<br>continue (16.3089121 , 13.9369976 ) (16.3205741 , 13.6476827 )
<br>continue (16.3313139 , 13.3881549 ) (16.3413692 , 13.1509343 )
<br>continue (16.3500405 , 12.9508027 ) (16.3549320 , 12.8396239 )
<br>continue (16.3612102 , 12.6987923 ) (16.3682553 , 12.4682923 )
<br>continue (16.3726745 , 12.3112294 ) (16.3806055 , 12.0335586 )
<br>continue (16.3929606 , 11.6114940 ) (16.4056758 , 11.1899262 )
<br>continue (16.4199161 , 10.7326810 ) (16.4338514 , 10.2998297 )
<br>continue (16.4446053 ,  9.9753257 ) (16.4531562 ,  9.7229785 )
<br>continue (16.4606228 ,  9.5066902 ) (16.4682203 ,  9.2903934 )
<br>continue (16.4785607 ,  8.9416311 ) (16.4869261 ,  8.4270799 )
<br>continue (16.4940975 ,  7.9941810 ) (16.5060096 ,  7.2913992 )
<br>continue (16.5182572 ,  6.5892987 )continue ( 22.38, -10.0000)
<br>print on
<br># 
<br>save performance "hii_hiU_StaticSphere_noGrains.per"
<br>save overview "hii_hiU_StaticSphere_noGrains.ovr"
<br>save dr "hii_hiU_StaticSphere_noGrains.dr"
<br># 
<br># 
<br># 
<br># 
<br>#
<br># 
<br># 
<br># H II region
</kbd><p>
This model was added to have at least one sim with a very high
ionization parameter and a grain-free static closed geometry
to maximize line trapping.  
</p><hr><kbd><h2>hii_icf.in</h2>  </kbd><h2><I>HII region with negative He/H ICF
</I></h2><kbd><br>title HII region with negative He/H ICF
<br>#
<br># commands controlling continuum =========
<br># this is the result of this command
<br># table star mihalas 46000
<br># and makes it possible to run these orion sims without
<br># installing the stellar atmosphere files 
<br>table SED "star_mihalas_46000.dat" 
<br>ionization parameter -2.
<br># add the CMB after hot star shape & luminosity specified
<br>CMB 
<br>#
<br># commands for density & abundances =========
<br>hden 3
<br>init file "ism.ini"
<br>abundances ism no grains
<br>grains no qheat single 
<br>metals and grains 0.320
<br>#
<br># commands controlling geometry  =========
<br>stop efrac -3
<br>stop temperature 15
<br>sphere
<br>#
<br># other commands for details     =========
<br>failures 1
<br>#
<br># commands controlling output    =========
<br>save performance "hii_icf.per"
<br>save overview "hii_icf.ovr" last
<br>save dr "hii_icf.dr" last
<br>#
<br># hii_icf.in
<br># class hii 
<br># ========================================
</kbd><p>
<p>
This is an example of an H II region irradiated
by a hard stellar continuum - one of the Mihalas NLTE stars.
The hard continuum produces a negative He/H ionization
correction factor, as discussed in Ballantyne, Ferland & Martin (2000).
>>refer	HeI	icf by Ballantyne,D.R.,  Ferland, G.J., & Martin, P.G., 2000, ApJ 536, 773-777
<p>
</p><hr><kbd><h2>hii_paris.in</h2>  </kbd><h2><I>"New" Paris meeting HII region
</I></h2><kbd><br>title "New" Paris meeting HII region
<br># "standard" HII region model of the Pequignot Meudon Conference
<br>#
<br># commands controlling continuum =========
<br>black body, T = 40000 K radius = 12.113943
<br># add the CMB after hot star shape & luminosity specified
<br>CMB 
<br>#
<br># commands for density & abundances =========
<br>hden = 2
<br>init file="ism.ini"
<br>element aluminium on
<br>element helium abundance -1
<br>element carbon abundance -3.6576
<br>element nitrogen abundance -4.39794
<br>element oxygen abundance -3.481146
<br>element neon abundance -4.30103
<br>element magnesium abundance -8
<br>element aluminium abundance -8
<br>element silicon abundance -8
<br>element sulphur abundance -5.04576
<br>element chlorine abundance -7
<br>element argon abundance -8
<br>element iron abundance -8
<br>#
<br># commands controlling geometry  =========
<br>radius = 18.477121
<br>sphere
<br># next two to make sure we pick up all possible H recombination
<br>set temperature floor 1000
<br># make sure sim goes very deep into cold gas
<br>stop temperature 100K 
<br>stop efrac -2 
<br>#
<br># other commands for details     =========
<br># must iterate since fine structure lines are optically thick
<br>iterate   
<br>database h-like element hydrogen levels resolved 10
<br>#
<br># commands controlling output    =========
<br>normalize to "Ca B" 4861.32A
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>print column densities 
<br>print line optical depths 
<br>print line faint 0.01
<br>print line sum
<br>Blnd 5875.66A
<br>blnd 2326
<br>blnd 1909
<br>n  2  121.769m
<br>N  2  6583.45
<br>N  2 6548.05
<br>n  3  57.3238m
<br>blnd  3727
<br>o  3  5006.84
<br>o  3  4958.91
<br>O  3  51.8004m
<br>O  3  88.3323m
<br>Ne 2  12.8101m
<br>Ne 3  15.5509m
<br>Ne 3 3868.76A
<br>Ne 3 3967.47A
<br>Blnd  6720
<br>S  3  18.7078m
<br>S  3  33.4704m
<br>S  3  9530.62A
<br>S  3  9068.62
<br>s  4  10.5076m
<br>end of lines
<br>save performance "hii_paris.per"
<br>save overview last "hii_paris.ovr"
<br>save each cooling last "hii_paris.cole"
<br>save cooling last "hii_paris.col"
<br>save hydrogen 21 cm last "hii_paris.21cm"
<br>save results last "hii_paris.rlt"
<br>save dr last "hii_paris.dr"
<br>save linelist "hii_paris.lin" "LineList_HII.dat" last no hash column
<br># this is to confirm that this commnand works
<br>save lines emissivity "hii_paris.str" last 
<br>H  1  4861.32A
<br>end lines
<br>#
<br>table lines "LineList_HII.dat"
<br># hii_paris.in
<br># class hii 
<br># ========================================
<br># 
</kbd><p>
This is one of the "standard" models computed at the Paris and Lexington
meetings on photoionization and shock calculations.  a bable in hazy
compares the predictions of the current version of CLOUDY with predictions
of a few of the other codes.  It is necessary to iterate since some
fine structure lines are optically thick.   The set of lines entered
with the print line sum command is used to obtain the total luminosity
in detected lines, a measure of the Stoy temperature.
<p>
<br>Checks:
<br>-	Hb close to case B, Q(H) 4861, intensities.
<br>-	Enter answers in Table Error! Reference source not found..
<p>
</p><hr><kbd><h2>hii_Um3.in</h2>  </kbd><h2><I>H II region sim from Christophe Morriset's ionization paramter family
</I></h2><kbd><br>title H II region sim from Christophe Morriset's ionization paramter family
<br>set save prefix "hii_Um3"
<br>Blackbody 56000
<br>ionization parameter = -3.000
<br>hden = 3
<br>abundances HII region
<br>cosmic ray background
<br>element limit off -8
<br>print line optical depth
<br>iterate
<br>#
<br>#
<br>save last continuum ".con" units microns
<br>save last overview ".ovr"
<br>save performance ".per"
<br>#
<br># hii_Um3.in
<br># class hii
<br># ===========================
</kbd><p>
This is one of three tests suggested by Christophe Morisset to span
the range of ionization parameter on a BPT diagram
</p><hr><kbd><h2>hii_Um35.in</h2>  </kbd><h2><I>H II region sim from Christophe Morriset's ionization paramter family
</I></h2><kbd><br>title H II region sim from Christophe Morriset's ionization paramter family
<br>set save prefix "hii_Um35"
<br>Blackbody 56000
<br>ionization parameter = -3.5
<br>hden = 3
<br>abundances HII region
<br>cosmic ray background
<br>element limit off -8
<br>print line optical depth
<br>iterate
<br>#
<br>#
<br>save last continuum ".con" units microns
<br>save last overview ".ovr"
<br>save performance ".per"
<br>#
<br># hii_Um3.in
<br># class hii
<br># ===========================
</kbd><p>
This is one of three tests suggested by Christophe Morisset to span
the range of ionization parameter on a BPT diagram
</p><hr><kbd><h2>hii_Um385.in</h2>  </kbd><h2><I>H II region sim from Christophe Morriset's ionization paramter family
</I></h2><kbd><br>title H II region sim from Christophe Morriset's ionization paramter family
<br>set save prefix "hii_Um385"
<br>Blackbody 56000
<br>ionization parameter = -3.85
<br>hden = 3
<br>abundances HII region
<br>cosmic ray background
<br>element limit off -8
<br>print line optical depth
<br>iterate
<br>#
<br>#
<br>save last continuum ".con" units microns
<br>save last overview ".ovr"
<br>save performance ".per"
<br>#
<br># hii_Um3.in
<br># class hii
<br># ===========================
</kbd><p>
This is one of three tests suggested by Christophe Morisset to span
the range of ionization parameter on a BPT diagram
</p><hr><kbd><h2>hlike_c.in</h2>  </kbd><h2><I>H-like C VI case B
</I></h2><kbd><br>title H-like C VI case B
<br>#
<br># commands controlling continuum =========
<br>table agn 
<br>ionization parameter 3
<br>#
<br># commands for density & abundances =========
<br>hden = 8
<br>init file="ism.ini"
<br>element carbon abundance 1
<br>set eden 9
<br>#
<br># commands controlling geometry  =========
<br>set dr -18
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>case b hummer no photoionization
<br>no induced processes (OK)
<br>constant temperature = 1.e5
<br>#
<br># commands controlling output    =========
<br>save overview "hlike_c.ovr"
<br>save performance "hlike_c.per"
<br>save results "hlike_c.rlt"
<br>#
<br># hlike_c.in
<br># class limit 
<br># ========================================
<br># 
<br> 
<br>This test case compares the predictions of the multi-level H-like CVI atom
<br>with the Storey and Hummer (1995) results.  The set dr command sets the
<br>zone thickness to 1 cm.  The case b command sets Lyman line optical depths
<br>to very large values. 
<br>Checks:
<br>-	Neutral fractions
<br>-	H* emissivity
<br>-	Relative line intensities
</kbd><p>
</p><hr><kbd><h2>hlike_o.in</h2>  </kbd><h2><I>H-like O VIII case B
</I></h2><kbd><br>title H-like O VIII case B
<br>#
<br># commands controlling continuum =========
<br>table agn 
<br>ionization parameter 4
<br>#
<br># commands for density & abundances =========
<br>hden = 8
<br>init file="ism.ini"
<br>element oxygen abundance 1
<br>set eden 9
<br>#
<br># commands controlling geometry  =========
<br># set following so the n^2 dr is unity
<br>set dr -18
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>case b hummer no photoionization
<br>no induced processes (OK)
<br>constant temperature = 1.e5
<br>#
<br># commands controlling output    =========
<br>save overview "hlike_o.ovr"
<br>save performance "hlike_o.per"
<br>save results "hlike_o.rlt"
<br>#
<br># caseb_o.in
<br># class limit 
<br># ========================================
<br># 
<br> 
<br>This test case compares the predictions of the multi-level H-like O VIII atom
<br>with the Storey and Hummer (1995) results.  The set dr command sets the
<br>zone thickness to 1 cm.  The case b command sets Lyman line optical depths
<br>to very large values. 
<br>Checks:
<br>-	Neutral fractions
<br>-	H* emissivity
<br>-	Relative line intensities
</kbd><p>
</p><hr><kbd><h2>igm_lalpha.in</h2>  </kbd><h2><I>Ly alpha forest cloud
</I></h2><kbd><br>title Ly alpha forest cloud
<br>#
<br># commands controlling continuum =========
<br># ionized by cosmic background
<br># plus quasar/starburst continuum 
<br>cmb z=2
<br>table hm05 z = 2
<br>#
<br># commands for density & abundances =========
<br>hden -2
<br>#
<br># commands controlling geometry  =========
<br>stop "H" column density 15
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>print line faint -1
<br>set save prefix "igm_lalpha"
<br>save performance ".per"
<br>save overview last ".ovr"
<br>save dr last ".dr"
<br>save results last ".rlt"
<br>#
<br># on 05 aug 29 changed from old background command to
<br># cmb 2 plus hm05 z=2 background - all results changed substantially
<br># igm_lalpha.in
<br># class igm 
<br># ========================================
<br># 
<br>  
<br>This example demonstrates the behavior of the code in the low-density limit. 
<br>The ionizing source is the cosmic background at a redshift of z = 2. 
<br>The cloud is assumed to be optically thin to ionizing radiation,
<br>in keeping with the Gunn-Peterson test, so the double command is included,
<br>and an iteration is performed to converge the optical depth scale. 
<br>Continuum fluorescent excitation of lines is important because the cloud
<br>is optically thin.
</kbd><p>
This sim corrects line intensities for isotropic continua.  Its sister sim,
igm_lalpha_noisosub.in, computes intensities uncorrected for isotropic continua.
</p><hr><kbd><h2>igm_lalpha_hm12.in</h2>  </kbd><h2><I>Ly alpha forest cloud
</I></h2><kbd><br>title Ly alpha forest cloud
<br>#
<br># commands controlling continuum =========
<br># ionized by cosmic background
<br># plus quasar/starburst continuum 
<br>cmb z=2
<br>table hm12 z = 2
<br>#
<br># commands for density & abundances =========
<br>hden -2
<br>#
<br># commands controlling geometry  =========
<br>stop neutral column density 15
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>print line faint -1
<br>set save prefix "igm_lalpha_hm12"
<br>save performance ".per"
<br>save overview last ".ovr"
<br>save dr last ".dr"
<br>save results last ".rlt"
<br>#
<br># igm_lalpha_hm12.in
<br># class igm 
<br># ========================================
<br># 
<br>  
<br>This example demonstrates the behavior of the code in the low-density limit. 
<br>The ionizing source is the cosmic background at a redshift of z = 2. 
<br>The cloud is assumed to be optically thin to ionizing radiation,
<br>in keeping with the Gunn-Peterson test, so the double command is included,
<br>and an iteration is performed to converge the optical depth scale. 
<br>Continuum fluorescent excitation of lines is important because the cloud
<br>is optically thin.
</kbd><p>
This sim corrects line intensities for isotropic continua.  Its sister sim,
igm_lalpha_noisosub_hm12.in, computes intensities uncorrected for isotropic continua.
</p><hr><kbd><h2>igm_lalpha_noisosub.in</h2>  </kbd><h2><I>Ly alpha forest cloud
</I></h2><kbd><br>title Ly alpha forest cloud
<br>#
<br># commands controlling continuum =========
<br># ionized by cosmic background
<br># plus quasar/starburst continuum 
<br>cmb z=2
<br>table hm05 z = 2
<br>#
<br># commands for density & abundances =========
<br>hden -2
<br>#
<br># commands controlling geometry  =========
<br>stop neutral column density 15
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>print line faint -1
<br>no lines isotropic continuum subtraction
<br>set save prefix "igm_lalpha_noisosub"
<br>save performance ".per"
<br>save overview last ".ovr"
<br>save dr last ".dr"
<br>save results last ".rlt"
<br>#
<br># on 05 aug 29 changed from old background command to
<br># cmb 2 plus hm05 z=2 background - all results changed substantially
<br># igm_lalpha_noisosub.in
<br># class igm 
<br># ========================================
<br># 
<br>  
<br>This example demonstrates the behavior of the code in the low-density limit. 
<br>The ionizing source is the cosmic background at a redshift of z = 2. 
<br>The cloud is assumed to be optically thin to ionizing radiation,
<br>in keeping with the Gunn-Peterson test, so the double command is included,
<br>and an iteration is performed to converge the optical depth scale. 
<br>Continuum fluorescent excitation of lines is important because the cloud
<br>is optically thin.
</kbd><p>
This sim computes line intensities not corrected for isotropic continua
(see the "no lines..." command above).  Its sister sim, igm_lalpha.in,
computes intensities corrected for isotropic continua.
</p><hr><kbd><h2>igm_lalpha_noisosub_hm12.in</h2>  </kbd><h2><I>Ly alpha forest cloud
</I></h2><kbd><br>title Ly alpha forest cloud
<br>#
<br># commands controlling continuum =========
<br># ionized by cosmic background
<br># plus quasar/starburst continuum 
<br>cmb z=2
<br>table hm12 z = 2
<br>#
<br># commands for density & abundances =========
<br>hden -2
<br>#
<br># commands controlling geometry  =========
<br>stop neutral column density 15
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>print line faint -1
<br>no lines isotropic continuum subtraction
<br>set save prefix "igm_lalpha_noisosub_hm12"
<br>save performance ".per"
<br>save overview last ".ovr"
<br>save dr last ".dr"
<br>save results last ".rlt"
<br>#
<br># igm_lalpha_noisosub_hm12.in
<br># class igm 
<br># ========================================
<br># 
<br>  
<br>This example demonstrates the behavior of the code in the low-density limit. 
<br>The ionizing source is the cosmic background at a redshift of z = 2. 
<br>The cloud is assumed to be optically thin to ionizing radiation,
<br>in keeping with the Gunn-Peterson test, so the double command is included,
<br>and an iteration is performed to converge the optical depth scale. 
<br>Continuum fluorescent excitation of lines is important because the cloud
<br>is optically thin.
</kbd><p>
This sim computes line intensities not corrected for isotropic continua
(see the "no lines..." command above).  Its sister sim, igm_lalpha_hm12.in,
computes intensities corrected for isotropic continua.
</p><hr><kbd><h2>igm_perseus.in</h2>  </kbd><h2><I>Perseus cluster
</I></h2><kbd><br>title Perseus cluster
<br># model of IGM in Perseus galaxy cluster inspired by Hitommi spectroscopy
<br>set save prefix "igm_perseus"
<br>#
<br># assume gas is in collisional equilibrium
<br>coronal 4.6e7K
<br>#
<br># commands for density & abundances =========
<br>hden -1.5
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># adjust models to get higher accuracy
<br>database H-like element iron resolved levels 10
<br>database H-like element iron collapsed levels 50
<br>database He-like element iron resolved levels 10
<br>database He-like element iron collapsed levels 50
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>print line column
<br>print line sort wavelength
<br>print line faint -2
<br>#print line sort intensity
<br>normalize "Fe25" 1.85040A  1
<br>save overview ".ovr" 
<br>save performance ".per" 
<br>save element oxygen ionization ".oxy" 
<br>save element iron ionization ".fe" 
<br>save performance ".per"
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>#
<br>****************************
<br># agn_erseus.in, hot gas in the Perseus galaxy cluster
<br># class igm
<br># ==================================
<br>#
</kbd><p>
This is inspired by Hitomi observations of the Fe complex in Perseus
and has been developed by Priyanka Chakraborty as part of her thesis.
</p><hr><kbd><h2>igm_primal.in</h2>  </kbd><h2><I>cloud with primordial abundances exposed to background at Z=10
</I></h2><kbd><br>title cloud with primordial abundances exposed to background at Z=10
<br>#
<br># commands controlling continuum =========
<br>background, redshift= 10
<br># background due to agn from Haardt & Madau 1996 ApJ, 461, 20
<br># this sets both continuum shape and intensity, actually for z=2
<br>table HM96 old
<br>#
<br># other commands for details     =========
<br># put in a velocity field to stop Lya from causing stability problems
<br>turbulence 20 km/s
<br># do a second iteration to establish that it is optically thick downstream
<br>iterate
<br># this sim should run cleanly - do not accept problems
<br>failures 2 
<br>#
<br># commands for density & abundances =========
<br># this log of the hydrogen density
<br>hden 5
<br># stored set of primordial abundances 
<br>abundances primordial
<br>#
<br># commands controlling geometry  =========
<br># we want to shielded face to not be exposed to empty space, but rather
<br># be just very deep in a dense cloud - this prevents lines from freely
<br># radiating from the shielded face
<br>double optical depths 
<br># set a lower temperature stopping criterion - default is 4000K
<br>stop temperature 30
<br>#
<br># commands controlling output    =========
<br># don't want to print lots of faint hydrogen lines
<br>print line faint -3
<br># some output files with info we want to save 
<br>save performance "igm_primal.per"
<br>save temperature history "igm_primal_tem.his"
<br>save ionizing continuum "igm_primal.ion"
<br>save hydrogen conditions "igm_primal.mol"
<br>save heating "igm_primal.het"
<br>save dr "igm_primal.dr"
<br>save cooling "igm_primal.col"
<br>save overview "igm_primal.ovr"
<br>save results last "igm_primal.rlt"
<br>#
<br># igm_primal.in
<br># class hii pdr igm
<br># ========================================
<br> 
<br>This is a high redshift cloud irradiated by the cosmic background and AGN light.
<br>H- absorption of the z=10 cosmic background is a MAJOR heating agent
<br>This model is very sensitive to treatment of Lya destruction, since resulting
<br>J-bar is major destruction process for H-, which is the H2 formation route.
<br>Lya ots oscillations could develop and are damped by not reevaluating H-
<br>photo rate after first n times, as in hmole.c 
</kbd><p>
</p><hr><kbd><h2>igm_z3.in</h2>  </kbd><h2><I>redshift 1000 recombination epoch
</I></h2><kbd><br>title redshift 1000 recombination epoch
<br>#
<br># commands controlling continuum =========
<br># a true blackbody radiation field, in strict thermodynamic equilibrium
<br>blackbody 3000 STE
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>abundances primordial
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>case b 
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize lines to "Ca B" 4861.32A
<br>print ages
<br>print departure coef element hydrogen
<br>print line faint -5
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save overview "igm_z3.ovr"
<br>save performance "igm_z3.per"
<br>save dr "igm_z3.dr"
<br>#
<br># igm_z3.in
<br># class limit igm
<br># ========================================
<br># 
</kbd><p>
This is a model of the universe near the recombination epoch, at
a redshift of a thousand.  The gas is exposed to a true blackbody at
3000 K, and the abundances are primordial.  
<p>
<p>
</p><hr><kbd><h2>igm_z3_thick.in</h2>  </kbd><h2><I>redshift 1000 recombination epoch
</I></h2><kbd><br>title redshift 1000 recombination epoch
<br>#
<br># commands controlling continuum =========
<br># A true blackbody radiation field, in strict thermodynamic equilibrium.
<br># This is a resolved variant of igm_z3, which should have uniform conditions.
<br>blackbody 3000 STE
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>abundances primordial
<br>#
<br># commands controlling geometry  =========
<br># stop zone 1
<br>stop thickness 16
<br>stop temperature 0
<br>#
<br># other commands for details     =========
<br>case b 
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize lines to "Ca B" 4861.32A
<br>print ages
<br>print departure coef element hydrogen
<br>print line faint -5
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save overview "igm_z3_thick.ovr"
<br>save performance "igm_z3_thick.per"
<br>save dr "igm_z3_thick.dr"
<br>#
<br># igm_z3_thick.in
<br># class limit igm
<br># ========================================
<br># 
</kbd><p>
This is a model of the universe near the recombination epoch, at
a redshift of a thousand.  The gas is exposed to a true blackbody at
3000 K, and the abundances are primordial.  
<p>
This is a spatially-resolved variant of igm_z3, which should have uniform
conditions throughout the depth.
</p><hr><kbd><h2>ism.in</h2>  </kbd><h2><I>cloud irradiated by ism background
</I></h2><kbd><br>title cloud irradiated by ism background
<br>#
<br># commands controlling continuum =========
<br># this uses the Black continuum with no H-ionizing radiation,
<br># and with background cosmic rays
<br>cmb
<br>table ism
<br>extinguish by a column of 22
<br># need cosmic rays to provide ionization to the chemistry
<br>cosmic rays, background
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>init file="ism.ini"
<br>abundances ism 
<br>#
<br># commands controlling geometry  =========
<br># set sphere since matter in all directions
<br>sphere 
<br>stop temperature linear 10
<br>stop thickness 0.1 linear parsecs
<br>#
<br># other commands for details     =========
<br># this prevents continuum pumping from exciting H0
<br>Database H-like Lyman pumping off
<br># this is to converge optical depths
<br>iterate
<br># this should have no effect since T is larger than 100 K
<br>set temperature floor 100K
<br>#
<br># commands controlling output    =========
<br># this model has no heavy element molecules, because H2 does not
<br># really fully form, since Lyman bands are not self-shielded
<br>normalize to 157.636m "C  2"
<br>print line pump
<br>save performance "ism.per"
<br>save overview "ism.ovr" last
<br>save dr "ism.dr" 
<br>save heating "ism.het" 
<br>save coolign "ism.col" 
<br>save continuum "ism.con"  units microns last
<br>save continuum "ism.con-no-iso"  units microns last no isotropic
<br>#
<br># ism.in
<br># class ism 
<br># ========================================
</kbd><p>
TODO - look at temperature struture - it has jitter at about the
level of convergence, up and down.  Temp jitter caused by eden jitter.
This model is nearly isothermal, jitter measures noise in solver,
and is great chance to pin this down.
<p>
This is a test of the behavior of the code in the extreme of
photoionization by a relatively hard continuum, at low densities.
The continuum is the galactic background, attenuated by a column density
of 10^22 cm-2.  Ionization by galactic background cosmic rays is included. 
Database H-like Lyman pumping off appears since this region is deep in the ISM, and the Lyman lines
are quite thick.  This example checks whether the ionization balance,
thermal balance, and electron density sum, are performed correctly in
this limit.
<p>
<br>Checks:
<br>-	Numerical stability of solution
<br>-	Thickness exact 
<p>
</p><hr><kbd><h2>ism_cosmicray.in</h2>  </kbd><h2><I>background cosmic ray ionization by suprathermal electrons only
</I></h2><kbd><br>title background cosmic ray ionization by suprathermal electrons only
<br>#
<br># commands controlling continuum =========
<br># background CR H0 ionization rate should be 2.5e-17 s^-1,
<br># Williams et al. ApJ, 503, 689
<br>cosmic rays, background
<br># this will be VERY faint black 50000
<br>ionization parameter -25
<br>black 50000 
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>set temperature floor 1000 K
<br># turn off molecules to test only ions 
<br>no molecules 
<br># must turn off charge transfer and its heating, which would dominate,
<br># since we want to test cr heating and ionization
<br>no charge transfer
<br>no ctheat
<br># must turn of  photoionization by recombining species,
<br># since we want to test cr heating and ionization
<br>no photoionization
<br># any time photoionization is turned off, it is best to also
<br># turn off induced processes, which include pumping in the lyman lines
<br>no induced processes
<br>#
<br># commands controlling output    =========
<br>print ages
<br>save overview "ism_cosmicray.ovr"
<br>save performance "ism_cosmicray.per"
<br>#
<br># ism_cosmicray.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This test conditions of cosmic ray ionization.  Molecules and charge transfer
are disabled so that analytical estimates can be made.  
<p>
</p><hr><kbd><h2>ism_grid.in</h2>  </kbd><h2><I>interstellar cloud irradiated by ism background
</I></h2><kbd><br>title interstellar cloud irradiated by ism background
<br>#
<br># commands controlling continuum =========
<br># this uses the Black continuum with no H-ionizing radiation,
<br># and with background cosmic rays
<br>table ism
<br>extinguish by a column of 22
<br>cosmic rays background linear 0.1266
<br>#
<br># commands for density & abundances =========
<br>hden 0 vary
<br>grid from -3 to 2 in 0.5 dex steps sequential
<br>init file="ism.ini"
<br># this turns on ism abundances and grains
<br>abundances ism
<br>#
<br># commands controlling geometry  =========
<br># set sphere since matter in all directions
<br>sphere 
<br>stop temperature linear 10
<br>stop thickness 0.1 linear parsecs
<br>stop zone 1 
<br>#
<br># other commands for details     =========
<br># this prevents continuum pumping from exciting H0
<br>Database H-like Lyman pumping off
<br>#
<br># commands controlling output    =========
<br># this model has no heavy element molecules, because H2 does not
<br># really fully form, since Lyman bands are not self-shielded
<br>normalize to 157.636m "C  2"
<br>save performance "ism_grid.per"
<br>save pressure "ism_grid.pre" last no hash
<br>save grid "ism_grid.grd" last no hash
<br>save averages "ism_grid.avr" last no hash
<br>temperature hydrogen 1 
<br>end of averages
<br>save overview "ism_grid.ovr" last
<br>save dr "ism_grid.dr"
<br>save heating "ism_grid.het"  last no hash
<br>save coolign "ism_grid.col"  last no hash
<br>save xspec mtable "ism_grid.fit" range 0.1 3 keV
<br>save temperature "ism_grid.tem"  last no hash
<br>#
<br># sert tempe hydro 1 9942 .05 grid 8575 6468 3606 776 304 169 103 66.2 44.1 31.3
<br>#
<br># ism_grid.in
<br># class ism 
<br># ========================================
</kbd><p>
this shows an S-curve calculation - make plot showing density as X-axis
and gas pressure (nT) as y-axis
<p>
the gas is ionized by the galactic background.  the density varies between
1e-3 and 100 cm-3.  this is the full range found in the diffuse ism.
The components that are produced are 
CNM - cold neutral medium, density ~ 40 cm-3
WNM - n ~ 0.5 cm-3, 
WIM - warm ionized medium, n ~ 0.25 cm-3
HIM - hot ionized medium, n ~ 1e-3 cm-3, calculation DOES NOT 
      reproduce observed temperature of HIM - we get ~1e4K but
      observed is ~1e6 K.  HIM is shock, not photo, ionized
<p>
<p>
</p><hr><kbd><h2>ism_hot_brems.in</h2>  </kbd><h2><I>generate continuum due to hot ism in high Z,z starburst
</I></h2><kbd><br>title generate continuum due to hot ism in high Z,z starburst
<br># 
<br># commands controlling continuum =========
<br># this sets up coronal equilibrium for temperature and continuum
<br># cloud is predominantly collisionally ionized
<br>coronal equilibrium, t = 1.e6 K
<br>#
<br># commands for density & abundances =========
<br># log of hydrogen density (cm-3), by default a constant density model
<br>hden 1
<br># chemical composition for a well-evolved star cluster with high Z
<br># the starburst command generates scale factors that will be used to
<br># multiply the old solar composition, used in ver 84.  this is maintain
<br># record of physical changes
<br>abundances old solar 84 
<br>abundances starburst Z=10 Zsun
<br>#
<br># commands controlling geometry  =========
<br># the log of the total hydrogen column density, cm-2
<br>stop column density 21
<br>#
<br># other commands for details     =========
<br>#  continuum is plotted in Hzay, we me must iterate to predict this
<br>iterate
<br># 
<br># commands controlling output    =========
<br># normalize to O 7 Lya
<br>normalize to "O  7" 21.6020 
<br># this shortens the printout somewhat
<br>print line faint 1
<br># output options
<br>save performance "ism_hot_brems.per"
<br>save continuum last "ism_hot_brems.con" no title, units keV
<br>save sulphur ionization "ism_hot_brems.sul"
<br>save overview last "ism_hot_brems.ovr"
<br>save species data sources "ism_hot_brems.dsource"
<br># this is only to document the problem described above
<br>save dr last "ism_hot_brems.dr"
<br>#
<br># ism_hot_brems.in
<br># class ism 
<br># ========================================
<br># 
</kbd><p>
This model generates a large column constant density cloud
similar to the hot phase of the interstellar medium. 
The continuum is punched to generate one of the figures in Part 2 of Hazy.
<p>
There is a strange feature between 1.7e-3A and 2.2e-3A that is the N emission
(head starting at 1.7e-3A with O absorption at 2.2e-3A.  This model is
strongly enriched in heavies so many metal edges, esp O, are optically thick.
<p>
>>TODO	1	the guess of the thickness of the first zone is badly too small,
because this model is collisionally ionized, and it used Stromgren
length - better to use collisional balance and dr - as result of this
the model takes far too many zones
</p><hr><kbd><h2>ism_jura.in</h2>  </kbd><h2><I>check rate H2 forms on grain surfaces 
</I></h2><kbd><br>title check rate H2 forms on grain surfaces 
<br>#
<br># commands controlling continuum =========
<br># first continuum is FIR hot grain continuum produced in 
<br># unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity 2.7 (total)
<br># this is hot star continuum
<br>black 30000
<br>intensity  1.90 range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br>cosmic rays, background
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>grains ism, abundance log 0.16 no qheat 
<br>init file="ism.ini"
<br>abundances he= -1.01 c= -3.52 n=-8 o=-3.30 ne=-8 mg=-5.89
<br>continue si= -6.10 s= -5.10 cl=-7 ar=-8 fe= -6.60
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br># stop when gas is fully neutral
<br>stop efrac -10
<br># stop when gas is cold
<br>stop temperature 10 linear
<br>stop zone 1 
<br>#
<br># other commands for details     =========
<br># set the gas temperature
<br>constant temperature 100 K
<br>Database H-like Lyman pumping off
<br>#
<br># commands controlling output    =========
<br>normalize to "c  2" 157.636m 
<br># uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>save overview "ism_jura.ovr"
<br>save performance "ism_jura.per"
<br>save hydrogen 21 cm last "ism_jura.21cm"
<br>#
<br># ism_jura.in
<br># class limit  
<br># ========================================
<br># 
</kbd><p>
This model started out life as the Tielens & Hollenbach 1985 pdr.  The
density was set to unity and the incident radiation field adjusted so
that the two default grains have temperatures near 100K.  The model
asserts that the H2 formation rate on grain surfaces is close to the
# >>refer	H2	grain physics	Jura, M., 1975, ApJ, 197, 575
rate.
</p><hr><kbd><h2>ism_opacity.in</h2>  </kbd><h2><I>generate standard ISM opacity curve
</I></h2><kbd><br>title generate standard ISM opacity curve
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -3
<br>#
<br># commands for density & abundances =========
<br>grains no qheat
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save overview "ism_opacity.ovr"
<br>save performance "ism_opacity.per"
<br>save total opacity last "ism_opacity.opc" units kev
<br>#
<br># ism_opacity.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This example creates the file ism_opacity.opc which tabulates
the total opacity of the gas as a function of energy.  These
plots are used in ISM studies to understand the transmission
characteristics along a line of sight.  The opacity depends on 
the dust to gas ratio, the gas phase abundances, and the level
of ionization, all of which can be changed by altering parameters
given above.
<p>
The model is of a 1 cm think parcel of gas which is optically thin 
in the Lyman continuum and Lyman lines.  As a result the hydrogen
emission line spectrum is close to case C.  The model iterates
so that the predicted ionization and emission know about this.
</p><hr><kbd><h2>ism_set_cr_rate.in</h2>  </kbd><h2><I>background cosmic ray ionization by suprathermal electrons only
</I></h2><kbd><br>title background cosmic ray ionization by suprathermal electrons only
<br>#
<br># commands controlling continuum =========
<br>cosmic ray rate -16
<br># this will be VERY faint black 50000
<br>ionization parameter -25
<br>black 50000 
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>element hydrogen ionization 1 0.00000001
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>constant temperature 1000 K
<br># turn off molecules to test only ions 
<br># >>chng23 mar 04, add "heavy" option
<br>no molecules heavy 
<br># must turn off charge transfer and its heating, which would dominate,
<br># since we want to test cr heating and ionization
<br>no charge transfer
<br>no ctheat
<br># must turn of  photoionization by recombining species,
<br># since we want to test cr heating and ionization
<br>no photoionization
<br># any time photoionization is turned off, it is best to also
<br># turn off induced processes, which include pumping in the lyman lines
<br>no induced processes
<br>#
<br># commands controlling output    =========
<br>print ages
<br>save overview "ism_set_cr_rate.ovr"
<br>save performance "ism_set_cr_rate.per"
<br>#
<br># ism_set_cr_rate.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This test conditions of cosmic ray ionization.  Molecules and charge transfer
are disabled so that analytical estimates can be made.  
<p>
</p><hr><kbd><h2>limit_casea_h_den13.in</h2>  </kbd><h2><I>case A
</I></h2><kbd><br>title case A
<br># 
<br># Seaton, M.J, 1959 MN 119, 90, 
<br># 4pi j(beta) 5.56E-26
<br># for this model total H-beta=4.745
<br># b(2)=3.73E-3 (3)=3.69E-2 (4)=0.091 (5)=0.145 (6)=0.193
<br># n.b. very different results if not l-mixed
<br>#
<br># commands controlling continuum =========
<br>black body, T = 50000 K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>init file="honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop lyman optical depth -6
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature = 10000 K
<br>iterate
<br>#
<br># commands controlling output    =========
<br># this should make the predicted totl Hbeta near unity for case a
<br>normalize to "H  1" 4861.32A = 1.417
<br>print populations h-like 
<br>print departure coefficients
<br>save overview "limit_casea_h_den13.ovr"
<br>save performance "limit_casea_h_den13.per"
<br>#
<br># limit_casea_h_den13.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
Case A is a mathematical fiction; when the Lyman lines are
optically thin continuum pumping must be important if the gas
is ionized.  Fluorescence is turned off with the
no induced processes command.  The density is set to a
very high value (1015 cm-3) so that the 2s-2p states are well l-mixed,
in keeping with standard case A assumptions.  As a result,
collisional excitation would dominate the level populations,
and hydrogen collisions must be turned off with the hydrogen collisions off
command.  The Ly* optical depth is set to a small value.
The set dr command sets the zone thickness to 1 cm.
The abundances are set to a very small value so that the
electron density is equal to the hydrogen density. 
<br>Checks:
<br>-	Departure coefficients for H, He levels
<br>-	Neutral fractions
<br>-	H* emissivity
<p>
</p><hr><kbd><h2>limit_casea_h_den_temp.in</h2>  </kbd><h2><I>Test model H in Case A limit
</I></h2><kbd><br>title Test model H in Case A limit
<br># grid over nebular range of density and temperature to check Case A H
<br>#
<br># commands controlling continuum =========
<br># create H+ 
<br>laser 2 Ryd
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>init "honly.ini"
<br>hden 2. vary
<br>grid 2 6 2 sequential
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>no scattering escape
<br>case A hummer no Pdest no photoionization
<br>no induced processes
<br>constant temperature 4. vary
<br>grid 5000K to 20000K step 5000K linear
<br>#
<br># commands controlling output    =========
<br>database H-like print levels
<br>database H-like resolved levels 20
<br>database H-like collapsed levels 30
<br>save grid "limit_casea_h_den_temp.grd"
<br>save overview "limit_casea_h_den_temp.ovr"
<br>save performance "limit_casea_h_den_temp.per"
<br># 
<br># fixit the wavelength range is adjusted to avoid the Lyman lines
<br># the Lyman a / 2 photon ratio is wrong at high Temperature -
<br># is there a temperature dependent branching ratio to n=2 out
<br># of the collapsed level?
<br># 
<br># limit_casea_h_den_temp.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
this tests the predicted H I and He I spectra in the Case B limit.
The grid is over both density and temperature.
<p>
</p><hr><kbd><h2>limit_caseb_h_den10_temp45.in</h2>  </kbd><h2><I>the best we can do to predict the H I emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the H I emission spectrum 
<br>#
<br>set save prefix "limit_caseb_h_den10_temp45"
<br># commands controlling continuum =========
<br>laser 1.4
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 10  
<br>set eden 10
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>database h-like resolved levels 30
<br>database h-like collapsed levels 70
<br>constant temperature 3e4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure h-like hydrogen
<br>print line faint 0.01
<br>print line column
<br>save overview ".ovr"
<br>save performance ".per"
<br>save diffuse continuum ".dif" last no title units microns
<br>save continuum ".con" last no title units microns
<br>#
</kbd><p>
<p>
</p><hr><kbd><h2>limit_caseb_h_den2_temp37.in</h2>  </kbd><h2><I>the best we can do to predict the H I emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the H I emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>laser 1.4
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 100 linear 
<br>set eden 2
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>database h-like resolved levels 30
<br>database h-like collapsed levels 70
<br>database h-like keep fine structure
<br>constant temper 3.7
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure h-like hydrogen
<br>print line faint -4
<br>print line column
<br>save overview "limit_caseb_h_den2_temp37.ovr"
<br>save performance "limit_caseb_h_den2_temp37.per"
<br>save diffuse continuum "limit_caseb_h_den2_temp37.dif" last no title units microns
<br>save continuum "limit_caseb_h_den2_temp37.con" last no title units microns
<br>#
<br>#
<br># limit_caseb_h_den2_temp37.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is close to the best and most complete model of H I
that the code can do.  The predicted results still
deviate from the tabulated "Ca B" results because of the
principal quantum number specifications (30/70 here; 100/1 in table).
<p>
</p><hr><kbd><h2>limit_caseb_h_den2_temp4.in</h2>  </kbd><h2><I>the best we can do to predict the H I emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the H I emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>laser 1.4
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 100 linear 
<br>set eden 2
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>database h-like resolved levels 30
<br>database h-like collapsed levels 70
<br>constant temper 4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure h-like hydrogen
<br>print line faint 0.01
<br>print line column
<br>save overview "limit_caseb_h_den2_temp4.ovr"
<br>save performance "limit_caseb_h_den2_temp4.per"
<br>save diffuse continuum "limit_caseb_h_den2_temp4.dif" last no title units microns
<br>save continuum "limit_caseb_h_den2_temp4.con" last no title units microns
<br>#
<br>#
<br># limit_caseb_h_den2_temp4.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is close to the best and most complete model of H I
that the code can do.  The predicted results still
deviate from the tabulated "Ca B" results because of the
principal quantum number specifications (30/70 here; 100/1 in table).
<p>
</p><hr><kbd><h2>limit_caseb_h_den2_temp45.in</h2>  </kbd><h2><I>the best we can do to predict the H I emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the H I emission spectrum 
<br>#
<br>set save prefix "limit_caseb_h_den2_temp45"
<br># commands controlling continuum =========
<br>laser 1.4
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 100 linear 
<br>set eden 2
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>database h-like resolved levels 30
<br>database h-like collapsed levels 70
<br>constant temperature 3e4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure h-like hydrogen
<br>print line faint 0.01
<br>print line column
<br>save overview ".ovr"
<br>save performance ".per"
<br>save diffuse continuum ".dif" last no title units microns
<br>save continuum ".con" last no title units microns
<br>#
</kbd></p><hr><kbd><h2>limit_caseb_h_den2_temp5.in</h2>  </kbd><h2><I>the best we can do to predict the H I emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the H I emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>laser 1.4
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 100 linear 
<br>set eden 2
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>database h-like resolved levels 30
<br>database h-like collapsed levels 70
<br>constant temper 5
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure h-like hydrogen
<br>print line faint 0.01
<br>print line column
<br>save overview "limit_caseb_h_den2_temp5.ovr"
<br>save performance "limit_caseb_h_den2_temp5.per"
<br>save diffuse continuum "limit_caseb_h_den2_temp5.dif" last no title units microns
<br>save continuum "limit_caseb_h_den2_temp5.con" last no title units microns
<br>#
<br>#
<br># limit_caseb_h_den2_temp5.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is close to the best and most complete model of H I
that the code can do.  The predicted results still
deviate from the tabulated "Ca B" results because of the
principal quantum number specifications (30/70 here; 100/1 in table).
<p>
</p><hr><kbd><h2>limit_caseb_h_den2_temp5_coronal.in</h2>  </kbd><h2><I>the best we can do to predict the H I emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the H I emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>coronal 5
<br>#
<br># commands for density & abundances =========
<br>hden 100 linear 
<br>set eden 2
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>database h-like resolved levels 30
<br>database h-like collapsed levels 70
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure h-like hydrogen
<br>print line faint 0.01
<br>print line column
<br>save overview "limit_caseb_h_den2_temp5_coronal.ovr"
<br>save performance "limit_caseb_h_den2_temp5_coronal.per"
<br>save diffuse continuum "limit_caseb_h_den2_temp5_coronal.dif" last no title units microns
<br>save continuum "limit_caseb_h_den2_temp5_coronal.con" last no title units microns
</kbd></p><hr><kbd><h2>limit_caseb_h_den4_temp4.in</h2>  <br>set save prefix "limit_caseb_h_den4_temp4"
<br>#
<br># Gary tripped over a bug when this command is issued before
<br># the 'init "honly.ini"' below.
<br># Keep this command up here to always exercise the fix.
<br>#
<br>save species bands ".band" "FeII_bands.ini" "Fe+"
<br>constant temperature 1e4
<br>hden 4
<br>set eden 4
<br>init "honly.ini"
<br>laser 5
<br>ionization -2
<br>stop zone 1
<br>case B hummer
<br>print departure hydrogen H-like
<br>print departure helium H-like
<br>print line faint -6
<br>print lines column
<br>print lines sort wavelength
<br>atom H-like hydrogen levels resolved 30
<br>atom H-like hydrogen levels collapsed 170
<br>save performance ".per"
</kbd></p><hr><kbd><h2>limit_caseb_h_den4_temp45.in</h2>  </kbd><h2><I>the best we can do to predict the H I emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the H I emission spectrum 
<br>#
<br>set save prefix "limit_caseb_h_den4_temp45"
<br># commands controlling continuum =========
<br>laser 1.4
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 10000 linear 
<br>set eden 4
<br>init file "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>database h-like resolved levels 30
<br>database h-like collapsed levels 70
<br>constant temperature 3e4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure h-like hydrogen
<br>print line faint 0.01
<br>print line column
<br>save overview ".ovr"
<br>save performance ".per"
<br>save diffuse continuum ".dif" last no title units microns
<br>save continuum ".con" last no title units microns
<br>#
</kbd></p><hr><kbd><h2>limit_caseb_h_den4_temp4_Fuji.in</h2>  <br>set save prefix "limit_caseb_h_den4_temp4_Fuji"
<br>constant temperature 1e4
<br>hden 4
<br>database collisions h-like hydrogen Fujimoto
<br>set eden 4
<br>init "honly.ini"
<br>laser 5
<br>ionization -2
<br>stop zone 1
<br>case B hummer
<br>print departure hydrogen H-like
<br>print departure helium H-like
<br>print line faint -6
<br>print lines column
<br>print lines sort wavelength
<br>atom H-like hydrogen levels resolved 30
<br>atom H-like hydrogen levels collapsed 170
<br>save performance ".per"
</kbd></p><hr><kbd><h2>limit_caseb_h_den4_temp4_VR62.in</h2>  <br>set save prefix "limit_caseb_h_den4_temp4_VR62"
<br>constant temperature 1e4
<br>hden 4
<br>database collisions h-like hydrogen van regemorter
<br>set eden 4
<br>init "honly.ini"
<br>laser 5
<br>ionization -2
<br>stop zone 1
<br>case B hummer
<br>print departure hydrogen H-like
<br>print departure helium H-like
<br>print line faint -6
<br>print lines column
<br>print lines sort wavelength
<br>atom H-like hydrogen levels resolved 30
<br>atom H-like hydrogen levels collapsed 170
<br>save performance ".per"
</kbd></p><hr><kbd><h2>limit_caseb_h_den4_temp4_VS80.in</h2>  <br>set save prefix "limit_caseb_h_den4_temp4_VS80"
<br>constant temperature 1e4
<br>hden 4
<br>database collisions h-like hydrogen vriens
<br>set eden 4
<br>init "honly.ini"
<br>laser 5
<br>ionization -2
<br>stop zone 1
<br>case B hummer
<br>print departure hydrogen H-like
<br>print departure helium H-like
<br>print line faint -6
<br>print lines column
<br>print lines sort wavelength
<br>atom H-like hydrogen levels resolved 30
<br>atom H-like hydrogen levels collapsed 170
<br>save performance ".per"
</kbd></p><hr><kbd><h2>limit_caseb_h_hs87.in</h2>  </kbd><h2><I>"Case B from Hummer and Storey"
</I></h2><kbd><br>title "Case B from Hummer and Storey"
<br>init "honly.ini"
<br>laser 1.1
<br>ionization parameter -1
<br>constant temperature 4
<br>case b hummer no photoionization no pdest
<br>database h-like element hydrogen levels resolved 40
<br>database h-like element hydrogen collapsed levels 70
<br>no induced processes
<br>no level2
<br>no scattering escape
<br>set dr -20
<br>hden 4  
<br>stop zone 1
<br>iterate
<br>print populations h-like
<br>print departure h-like
<br>save overview "limit_caseb_h_hs87.ovr"
<br>save performance "limit_caseb_h_hs87.per"
<br># 
<br>#
<br># limit_caseb_h_hs87.in
<br># class limit
</kbd><p>
</p><hr><kbd><h2>limit_caseb_h_lot.in</h2>  </kbd><h2><I>log density case B, T=500 log n=2
</I></h2><kbd><br>title log density case B, T=500 log n=2
<br>#
<br># commands controlling continuum =========
<br>black body, T = 2.e5 K
<br>ionization parameter -1
<br>#
<br># commands for density & abundances =========
<br>hden = 2
<br>init file="honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature = 500
<br># want H and he fully stripped so we can check H He spectra
<br>case b hummer no photoionization no pdest
<br>no induced processes (OK) 
<br>iterate
<br>#
<br># commands controlling output    =========
<br>#
<br># does not agree with Hummer & Storey, as explained by Ferguson & Ferland
<br># until 03 jun 02, used small atom, which had smaller differences
<br># turn on large atom to get best answer
<br>database h-like levels resolved 20
<br>#
<br>save overview "limit_caseb_h_lot.ovr"
<br>save performance "limit_caseb_h_lot.per"
<br>save results "limit_caseb_h_lot.rlt" last
<br>#
</kbd><p>
# limit_caseb_h_lot.in
# class limit 
# ========================================
# 
<p>
This tests the ionization and emission line spectrum for 
H case B at a low density and temperature.
</p><hr><kbd><h2>limit_caseb_h_n8.in</h2>  </kbd><h2><I>h_caseb_n8 high density case B
</I></h2><kbd><br>title h_caseb_n8 high density case B
<br>#
<br># commands controlling continuum =========
<br>black body, T = 2.e5 K
<br>ionization parameter -1
<br>#
<br># commands for density & abundances =========
<br>hden = 8
<br>init file="honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br># this will not affect the main model, but will test CR heating rate
<br>cosmic ray background
<br>case b hummer no photoionization no Pdest 
<br>no scattering escape
<br>no induced processes (OK)
<br>constant temperature = 20000
<br>iterate 
<br>database h-like resolve levels 20
<br>#
<br># commands controlling output    =========
<br>save overview "limit_caseb_h_n8.ovr"
<br>save performance "limit_caseb_h_n8.per"
<br>save results "limit_caseb_h_n8.rlt"
<br>save ionizing continuum "limit_caseb_h_n8.cion"
<br>#
<br>#
<br># limit_caseb_h_n8.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This test case compares the predictions of the multi-level hydrogen atom
with the Storey and Hummer (1995) results.  The set dr command sets the
zone thickness to 1 cm.  The case b command sets Lyman line optical depths
to very large values. 
<br>Checks:
<br>-	Neutral fractions
<br>-	H* emissivity
<br>-	Relative line intensities
<p>
high density causes disagreemeent with HS - collisions
</p><hr><kbd><h2>limit_caseb_he2_den8.in</h2>  </kbd><h2><I>limit_caseb_he2_den8 He II case B
</I></h2><kbd><br>title limit_caseb_he2_den8 He II case B
<br>#
<br># commands controlling continuum =========
<br>table agn 
<br>ionization parameter 0
<br>#
<br># commands for density & abundances =========
<br>hden = 8
<br>element helium abundance 1
<br>init file="ism.ini"
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>database h-like element helium levels resolved 30 
<br>case b hummer no photoionization no Pdest 
<br>no induced processes (OK)
<br>constant temperature = 5e4 K
<br>#
<br># commands controlling output    =========
<br>save overview "limit_caseb_he2_den8.ovr"
<br>save performance "limit_caseb_he2_den8.per"
<br>save results "limit_caseb_he2_den8.rlt"
<br>#
<br>#
<br># limit_caseb_he2_den8.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This test case compares the predictions of the multi-level hydrogen atom
with the Storey and Hummer (1995) results.  The set dr command sets the
zone thickness to 1 cm.  The case b command sets Lyman line optical depths
to very large values. 
<br>Checks:
<br>-	Neutral fractions
<br>-	H* emissivity
<br>-	Relative line intensities
<p>
</p><hr><kbd><h2>limit_caseb_he_den.in</h2>  </kbd><h2><I>Test model H and He atoms in Case B limit
</I></h2><kbd><br>title Test model H and He atoms in Case B limit
<br># grid over nebular range of density and temperature to check Case B H & He
<br>#
<br># commands controlling continuum =========
<br>laser 5 Ryd
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>init "hheonly.ini"
<br>hden 2. vary
<br>grid 2 6 2 sequential
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>normalize to "He 2" 4685.68A
<br>case b hummer no Pdest no photoionization
<br>no scattering escape 
<br># prevent H I excited levels from being predicted
<br>database H-like element hydrogen resolved levels 3
<br>constant temperature 4.
<br>#
<br># commands controlling output    =========
<br>database H-like print levels 
<br>database H-like resolved levels 15
<br>save grid "limit_caseb_he_den.grd"
<br>save overview "limit_caseb_he_den.ovr"
<br>save performance "limit_caseb_he_den.per"
<br># 
<br># 
<br># limit_caseb_he_den.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
this tests the predicted He II spectra in the Case B limit.
<p>
this effectively turns off hydrogen to avoid the problem with every
other heII line lying beneath an HI line.  this is done by reducing
the number of levels for H I.
<p>
this asserts the values are within 9% for the standard T = 1e4K and
a range of densities.  Actually they are all nearly within a few
percent except at the lowest temperature of 5000K.
</p><hr><kbd><h2>limit_caseb_he_den2_temp4.in</h2>  </kbd><h2><I>the best we can do to predict the HeI emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the HeI emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 90 linear 
<br>set eden 2
<br>element helium abundance -1
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -2.95424
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 30
<br>database he-like collapsed levels 70
<br>database he-like gbar vriens
<br>constant temper 4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "Blnd" 4471.50A
<br>print departure he-like helium
<br>print line faint 0.01
<br># save fits last "limit_caseb_he_den2_temp4.fit"
<br>save overview "limit_caseb_he_den2_temp4.ovr"
<br>save performance "limit_caseb_he_den2_temp4.per"
<br>save diffuse continuum "limit_caseb_he_den2_temp4.dif" last no title units microns
<br>save continuum "limit_caseb_he_den2_temp4.con" last no title units microns
<br>save line list ratio column "limit_caseb_he_den2_temp4.rat" "linelist_he1.dat" last no hash
<br>#
<br>save line populations "limit_caseb_he_den2_temp4.lpop" "linelist_he1.dat" last no hash
<br># default row option: ratio
<br>save line populations "limit_caseb_he_den2_temp4.row.lpop" "linelist_he1.dat" row last no hash
<br>save line populations "limit_caseb_he_den2_temp4.row_lower.lpop" "linelist_he1.dat" row lower last no hash
<br>save line populations "limit_caseb_he_den2_temp4.row_upper.lpop" "linelist_he1.dat" row upper last no hash
<br>save line populations "limit_caseb_he_den2_temp4.row_ratio.lpop" "linelist_he1.dat" row ratio last no hash
<br>save line populations "limit_caseb_he_den2_temp4.row_tspin.lpop" "linelist_he1.dat" row tspin last no hash
<br>#
<br>#
<br># limit_caseb_he_den2_temp4.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is close to the best and most complete model of He I
that the code can do.  The predicted results still
deviate from the tabulated "Ca B" results because of the
principal quantum number specifications (30/70 here; 100/1 in table).
<p>
</p><hr><kbd><h2>limit_caseb_he_den4_temp4.in</h2>  </kbd><h2><I>the best we can do to predict the HeI emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the HeI emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 9000 linear 
<br>set eden 4
<br>element helium abundance -1
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -6.95424
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 30
<br>database he-like collapsed levels 70
<br>database he-like gbar vriens
<br>constant temper 4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "Blnd" 4471.50A
<br>print departure he-like helium
<br>print line faint 0.01
<br># save fits last "limit_caseb_he_den4_temp4.fit"
<br>save overview "limit_caseb_he_den4_temp4.ovr"
<br>save performance "limit_caseb_he_den4_temp4.per"
<br>save diffuse continuum "limit_caseb_he_den4_temp4.dif" last no title units microns
<br>save continuum "limit_caseb_he_den4_temp4.con" last no title units microns
<br>save line list ratio column "limit_caseb_he_den4_temp4.rat" "linelist_he1.dat" last no hash
<br>#
<br>#
<br># limit_caseb_he_den4_temp4.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is close to the best and most complete model of He I
that the code can do.  The predicted results still
deviate from the tabulated "Ca B" results because of the
principal quantum number specifications (30/70 here; 100/1 in table).
<p>
</p><hr><kbd><h2>limit_caseb_he_den4_temp4_Fuji.in</h2>  </kbd><h2><I>the best we can do to predict the HeI emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the HeI emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 9000 linear 
<br>set eden 4
<br>element helium abundance -1
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -6.95424
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 30
<br>database he-like collapsed levels 70
<br>database collisions he-like helium Fujimoto
<br>constant temper 4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "Blnd" 4471.50A
<br>print departure he-like helium
<br>print line faint 0.01
<br>save overview "limit_caseb_he_den4_temp4_Fuji.ovr"
<br>save performance "limit_caseb_he_den4_temp4_Fuji.per"
<br>save diffuse continuum "limit_caseb_he_den4_temp4_Fuji.dif" last no title units microns
<br>save continuum "limit_caseb_he_den4_temp4_Fuji.con" last no title units microns
<br>save line list ratio column "limit_caseb_he_den4_temp4_Fuji.rat" "linelist_he1.dat" last no hash
<br>#
<br>#
<br># limit_caseb_he_den4_temp4.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is close to the best and most complete model of He I
that the code can do.  The predicted results still
deviate from the tabulated "Ca B" results because of the
principal quantum number specifications (30/70 here; 100/1 in table).
<p>
</p><hr><kbd><h2>limit_caseb_he_den4_temp4_VR62.in</h2>  </kbd><h2><I>the best we can do to predict the HeI emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the HeI emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 9000 linear 
<br>set eden 4
<br>element helium abundance -1
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -6.95424
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 30
<br>database he-like collapsed levels 70
<br>database collisions he-like helium van regemorter
<br>constant temper 4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "Blnd" 4471.50A
<br>print departure he-like helium
<br>print line faint 0.01
<br>save overview "limit_caseb_he_den4_temp4_VR62.ovr"
<br>save performance "limit_caseb_he_den4_temp4_VR62.per"
<br>save diffuse continuum "limit_caseb_he_den4_temp4_VR62.dif" last no title units microns
<br>save continuum "limit_caseb_he_den4_temp4_VR62.con" last no title units microns
<br>save line list ratio column "limit_caseb_he_den4_temp4_VR62.rat" "linelist_he1.dat" last no hash
<br>#
<br>#
<br># limit_caseb_he_den4_temp4.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is close to the best and most complete model of He I
that the code can do.  The predicted results still
deviate from the tabulated "Ca B" results because of the
principal quantum number specifications (30/70 here; 100/1 in table).
<p>
</p><hr><kbd><h2>limit_caseb_he_den4_temp4_VS80.in</h2>  </kbd><h2><I>the best we can do to predict the HeI emission spectrum 
</I></h2><kbd><br>title the best we can do to predict the HeI emission spectrum 
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 9000 linear 
<br>set eden 4
<br>element helium abundance -1
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -6.95424
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 30
<br>database he-like collapsed levels 70
<br>database collisions he-like helium Vriens  
<br>constant temper 4
<br>case b no photoionzation no pdest 
<br>no scattering escape
<br>no induced processes
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "Blnd" 4471.50A
<br>print departure he-like helium
<br>print line faint 0.01
<br># save fits last "limit_caseb_he_den4_temp4.fit"
<br>save overview "limit_caseb_he_den4_temp4_VS80.ovr"
<br>save performance "limit_caseb_he_den4_temp4_VS80.per"
<br>save diffuse continuum "limit_caseb_he_den4_temp4_VS80.dif" last no title units microns
<br>save continuum "limit_caseb_he_den4_temp4_VS80.con" last no title units microns
<br>save line list ratio column "limit_caseb_he_den4_temp4_VS80.rat" "linelist_he1.dat" last no hash
<br>#
<br>#
<br># limit_caseb_he_den4_temp4.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is close to the best and most complete model of He I
that the code can do.  The predicted results still
deviate from the tabulated "Ca B" results because of the
principal quantum number specifications (30/70 here; 100/1 in table).
<p>
</p><hr><kbd><h2>limit_caseb_he_den_temp.in</h2>  </kbd><h2><I>Test model He atoms in Case B limit
</I></h2><kbd><br>title Test model He atoms in Case B limit
<br># grid over nebular range of density and temperature to check Case B H & He
<br>#
<br># commands controlling continuum =========
<br>laser 5 Ryd
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>init "hheonly.ini"
<br>hden 2. vary
<br>grid 6 2 -2 sequential
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>normalize to "He 2" 4685.68A
<br>case b hummer no Pdest no photoionization
<br>no scattering escape 
<br># prevent H I excited levels from being predicted
<br>database H-like element hydrogen resolved levels 3
<br>constant temperature 4. vary
<br>grid 5000K to 20000K step 5000K linear
<br>#
<br># commands controlling output    =========
<br>database H-like print levels 
<br>database H-like resolved levels 20
<br>save grid "limit_caseb_he_den_temp.grd"
<br>save overview "limit_caseb_he_den_temp.ovr"
<br>save performance "limit_caseb_he_den_temp.per"
<br># 
<br># 
<br># limit_caseb_he_den_temp.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
this tests the predicted He II spectra in the Case B limit.
<p>
this effectively turns off hydrogen to avoid the problem with every
other heII line lying beneath an HI line.  this is done by reducing
the number of levels for H I.
<p>
this asserts the values are within 15% for a range of density and temperature.
Actually they are all nearly within a few percent except at the lowest
temperature.  The error greater than 10% occurs at the lowest temperature
of 5000K.
</p><hr><kbd><h2>limit_caseb_hhe_den.in</h2>  </kbd><h2><I>Test model H and He atoms in Case B limit
</I></h2><kbd><br>title Test model H and He atoms in Case B limit
<br># grid over nebular range of density and temperature to check Case B H & He
<br>#
<br># commands controlling continuum =========
<br># create H+ and He+
<br>laser 2.0 Ryd
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>init "hheonly.ini"
<br>hden 2. vary
<br>grid 2 6 2 sequential
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>print line precision 5
<br>database he-like element helium resolved levels 10
<br>no scattering escape
<br>case b hummer no Pdest no photoionization
<br>constant temperature 4.
<br>#
<br># commands controlling output    =========
<br>database H-like print levels
<br>save grid "limit_caseb_hhe_den.grd"
<br>save overview "limit_caseb_hhe_den.ovr"
<br>save performance "limit_caseb_hhe_den.per"
<br># 
<br># Case B helium doesn't work well with Hummer option
<br># 
<br># limit_caseb_hhe_den.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
this tests the predicted H I and He I spectra in the Case B limit.
<p>
the grid is over density at the standard temperature of 1e4 K.
</p><hr><kbd><h2>limit_caseb_hhe_den_temp.in</h2>  </kbd><h2><I>Test model H and He atoms in Case B limit
</I></h2><kbd><br>title Test model H and He atoms in Case B limit
<br># grid over nebular range of density and temperature to check Case B H & He
<br>#
<br># commands controlling continuum =========
<br># create H+ and He+
<br>laser 2 Ryd
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>init "hheonly.ini"
<br>hden 2. vary
<br>grid 2 6 2 ncpus 4
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>print line precision 5
<br>database he-like element helium resolved levels 10
<br>database h-like element hydrogen resolved levels 15
<br>no scattering escape
<br>case b hummer no Pdest no photoionization
<br>constant temperature 4. vary
<br>grid 5000K to 20000K step 5000K linear
<br>#
<br># commands controlling output    =========
<br>database H-like print levels
<br>save grid "limit_caseb_hhe_den_temp.grd"
<br>save overview "limit_caseb_hhe_den_temp.ovr"
<br>save performance "limit_caseb_hhe_den_temp.per"
<br># 
<br># Case B helium doesn't work well with Hummer option
<br># 
<br># limit_caseb_hhe_den_temp.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
this tests the predicted H I and He I spectra in the Case B limit.
The grid is over both density and temperature.
<p>
</p><hr><kbd><h2>limit_casec_h_den2.in</h2>  </kbd><h2><I>H only optically thin in Lyman continuum
</I></h2><kbd><br>title H only optically thin in Lyman continuum
<br>#
<br># commands controlling continuum =========
<br>blackbody 40000
<br>ionization -2
<br>#
<br># commands controlling geometry  =========
<br>stop thickness 16 
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>init file "honly.ini"  
<br>#
<br># other commands for details     =========
<br>iterate
<br>constant temper 10000
<br>no level2
<br>#
<br># commands controlling output    =========
<br>print line inward
<br>save performance "limit_casec_h_den2.per"
<br>save overview "limit_casec_h_den2.ovr"  last
<br>save fine optical depths last "limit_casec_h_den2.fin" range 0.9 1.02 every 1
<br>save optical depths last "limit_casec_h_den2.opt" 
<br>save continuum "limit_casec_h_den2.con"  last units microns
<br>save dr "limit_casec_h_den2.dr"  last
<br>#
<br># limit_casec_h_den2.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a pure hydrogen cloud that is optically thin in the Lyman continuum.
The asserts check the emission in several H I lines and continua.
This should be close to what really happens in a low column density
cloud exposed to a continuum source that does not have strong Lyman lines.
(The continuum source used is a pure blackbody, and so has no lines).
So this is an example of "Case C" emission 
>>refer	H	case C	Ferland, G.J. 1999, PASP, 111, 1524
<p>
</p><hr><kbd><h2>limit_casec_h_den5.in</h2>  </kbd><h2><I>case C
</I></h2><kbd><br>title case C
<br>#
<br># commands controlling continuum =========
<br>black body, T = 50000 K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden = 5
<br>init file="hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>set dr -10
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>stop lyman optical depth -6
<br>constant temperature = 10000 K
<br>#
<br># commands controlling output    =========
<br>print h-like populations element hydrogen
<br>print line pump 
<br>print departure coefficients element hydrogen 
<br>save overview "limit_casec_h_den5.ovr"
<br>save performance "limit_casec_h_den5.per"
<br>#
<br># limit_casec_h_den5.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
<p>
This is Case C, what really happens when optically thin gas is
irradiated by a continuum with Lyman line continuum fluorescence allowed.
<br>Checks:
<br>-	Departure coefficients for H, He levels
<br>-	Neutral fractions
<br>-	H* emissivity
Case C is described in
<p>
>>refer	H	case C	Ferland, G.J. 1999, PASP, 111, 1524
<p>
</p><hr><kbd><h2>limit_compton_hi_t.in</h2>  </kbd><h2><I>test high-T Compton energy exchange
</I></h2><kbd><br>title test high-T Compton energy exchange
<br>#
<br># commands controlling continuum =========
<br># as hot as STE bb can be on IEEE 32-bit cpu
<br># equilibrium temperature should also be 2.51e7
<br># since gas radiated by true blackbody will equilibriate
<br># at its temperature 
<br>blackbody 7.4 STE 
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>database h-like element oxygen resolved levels 5
<br>database h-like element oxygen collapsed levels 30
<br>set temperature convergence 0.0001
<br>iterate
<br>print h-like departure element oxygen
<br>#
<br># commands controlling output    =========
<br>save overview "limit_compton_hi_t.ovr"
<br>save performance "limit_compton_hi_t.per"
<br>#
<br># limit_compton_hi_t.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is the highest Compton temperature that can be computed in
LTE on an IEEE 32-bit processor.  This tests the code in the
high-temperature Compton limit. Temperatures as high as 10^10 K
can be computed successfully on CPUs with longer word lengths,
such as a Cray or the new 64 bit processors. 
<p>
<br>Checks:
<br>-	The equilibrium temperature should be exactly 107.4 K (2.51239107 K).
<p>
</p><hr><kbd><h2>limit_compton_lo_t.in</h2>  </kbd><h2><I>test low-T Compton energy exchange
</I></h2><kbd><br>title test low-T Compton energy exchange
<br>#
<br># commands controlling continuum =========
<br>black linear 3 lte
<br>brems 5
<br>ionizat -5
<br>#
<br># commands for density & abundances =========
<br>hden -10
<br>init file "hheonly.ini"
<br>eden -3
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>set temperature convergence 0.0001
<br>iterate 3
<br>#
<br># commands controlling output    =========
<br>save overview "limit_compton_lo_t.ovr"
<br>save performance "limit_compton_lo_t.per"
<br>#
<br># limit_compton_lo_t.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the code in the low temperature Compton limit.  The gas is
illuminated by a 3 K blackbody in thermodynamic equilibrium. 
The equilibrium temperature should be exactly 3 K. 
It is necessary to add an extra component of free electrons to
test the code in this limit with the eden command.  
If eden is pushed up too high, ee brems cooling will be artificially
boosted compared to other cooling terms and start cooling the gas below 3 K.
This is why eden was set to 1e-3 cm^-3 on 20141105.
</p><hr><kbd><h2>limit_compton_mid_t.in</h2>  </kbd><h2><I>mid-T Compton energy exchange
</I></h2><kbd><br>title mid-T Compton energy exchange
<br># test of thermal equil in limit_compton_mid_t limit; temp should EXACTLY equal 2E5K
<br># check continuum partition;
<br># energy range, photon densities, luminosities, follow
<br># 0.25-1.  Q=26.6470 L=15.8190     c 1-1.807  Q=26.8867 L=16.3766
<br># 1.807-4  Q=27.3042 L=17.0948     c 4-20     Q=27.2041 L=17.3179
<br># 20 --    Q=22.9038 L=22.9038     c total lumin 17.5597
<br># nufnu(912A) = 1.8029E+16
<br>#
<br># commands controlling continuum =========
<br>black body t = 2.e5 K lte
<br>#
<br># commands for density & abundances =========
<br>hden = 6
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>stop lyman continuum optical depth = -6
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>print line faint .1
<br>print departure coef element hydrogen
<br>save overview "limit_compton_mid_t.ovr"
<br>save performance "limit_compton_mid_t.per"
<br>#
<br># limit_compton_mid_t.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This tests the behavior of the code in the Compton limit.
The incident continuum is a blackbody in strict thermodynamic equilibrium.
Strict thermodynamic equilibrium is expected for all constituents of the gas.
The input stream also lists the expected photon fluxes for the incident
continuum; this tests the normalization of the continuum,
and its distribution. Grains are included to confirm their behavior
in the LTE limit. The set dr command sets the zone thickness to 1 cm. 
<p>
<br>Checks:
<br>-	Luminosity, photon flux, over various energy intervals, 4*J at 912143.
<br>-	Electron temperature exactly 2*105 K.
<br>-	Grain temperature forced to 2*105 K by radiative processes.
<p>
</p><hr><kbd><h2>limit_conserve.in</h2>  </kbd><h2><I>test that energy is limit_conserved
</I></h2><kbd><br>title test that energy is limit_conserved
<br>#
<br># commands controlling continuum =========
<br># primary continuum is a hot blackbody
<br>black body, temp=5.5
<br>intensity total -4
<br># add cosmic background 
<br>background
<br>#
<br># commands controlling geometry  =========
<br># don't stop the calculation until all energy used up
<br># in order to check energy conservation 
<br>stop temperature 3 linear
<br># cloud will go very deep with temperature near 3K without this
<br>stop thickness 18.1 
<br>#
<br># commands for density & abundances =========
<br>metals -0.5
<br>hden 1.0
<br>constant pressure
<br>#
<br># other commands for details     =========
<br>iterate 
<br># want a clean calculation
<br>failures 3
<br># this allows for more molecular gas beyond what we model
<br>double optical depths
<br>#
<br># commands controlling output    =========
<br>save performance "limit_conserve.per"
<br>save pressure "limit_conserve.pre"
<br>save pressure history "limit_conserve.his"
<br>save cooling "limit_conserve.col"
<br>save heating "limit_conserve.het" 
<br>save dr "limit_conserve.dr"
<br>save overview "limit_conserve.ovr1"
<br>save overview last "limit_conserve.ovr"
<br>save results "limit_conserve.rlt"
<br>save element carbon "limit_conserve.car"
<br>save element neon "limit_conserve.ne" 
<br>save element magnesium "limit_conserve.mag"
<br>save element silicon "limit_conserve.sil"
<br>#
<br># limit_conserve.in
<br># class hii pdr  
<br># ========================================
</kbd><p>
This checks that energy is limit_conserved. The code always checks
that it did not radiate more energy than was absorbed.  This
calculation extends well past the photo-dissociation zone into
fully molecular gas, so that all of the incident radiation is absorbed.  
Grains, CMB, & CRs are not present so that only the incident radiation field
powers the gas.
<p>
Small changes can affect this model to surprising extents because 
of the presence of a major thermal front at the H0 - H+ transition region.
</p><hr><kbd><h2>limit_eden.in</h2>  </kbd><h2><I>Martin Gaskell's funny model
</I></h2><kbd><br>title Martin Gaskell's funny model
<br># used to test that electron density convergence is ok
<br># hydrogen line spectrum strongly pumped by continuum
<br># all elements > H have HIGH abundances 
<br># ionization of elements Fe, Mg, Si strongly affected
<br># by charge transfer
<br>#
<br># commands controlling continuum =========
<br>black 4000
<br>lumin 27.2
<br>#
<br># commands for density & abundances =========
<br>hden 5.138
<br>abundances all 1000
<br>#
<br># commands controlling geometry  =========
<br>radius 15
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temper 5500
<br>#
<br># commands controlling output    =========
<br>print line faint -3
<br>save overview "limit_eden.ovr"
<br>save performance "limit_eden.per"
<br>#
<br># limit_eden.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is mainly a test of the ability of the code to converge a model
with a very strange electron density. The electrons are mainly contributed
by heavy elements, and the gas is only slightly ionized. 
<p>
Ionization of elements Fe, Mg, Si strongly affected by charge transfer
with other heavy elements.
<p>
<br>Checks:
<br>-	Electron density is correct.
<br>-	Hydrogen line spectrum strongly pumped by continuum.
<p>
</p><hr><kbd><h2>limit_h_induc.in</h2>  </kbd><h2><I>constant temper black body limit from Ferland and Rees 1988
</I></h2><kbd><br>title constant temper black body limit from Ferland and Rees 1988
<br># tests whether departure coef are forced to unity by induced processes
<br>#
<br># commands controlling continuum =========
<br>black body, t = 50000 lte
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>init file="hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop lyman continuum optical depth -6
<br>set dr -10
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate 
<br>constant temper 50000
<br>#
<br># commands controlling output    =========
<br>print populations h-like element hydrogen
<br>print heating
<br>print departure coef element hydrogen
<br>print line faint -1
<br>save overview "limit_h_induc.ovr"
<br>save performance "limit_h_induc.per"
<br>#
<br># limit_h_induc.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This example tests whether induced processes force level populations
of hydrogen to LTE when they are irradiated by a
blackbody in strict thermodynamic equilibrium.  The density is
low enough value for radiation to dominate the rate equations
coupling levels with each other and the continuum.  The expectation
is for all departure coefficients to equal unity.
<p>
<br>Checks:
<br>-	Departure coefficients exactly unity.
<br>-	Grain temperatures are exactly 5*104 K.
<p>
</p><hr><kbd><h2>limit_hi_ion.in</h2>  </kbd><h2><I>very high ionization parameter limit
</I></h2><kbd><br>title very high ionization parameter limit
<br># commands controlling continuum =========
<br>table agn 
<br>ionization parameter 15
<br># commands controlling geometry  =========
<br>hden 0
<br>stop zone 1
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save overview "limit_hi_ion.ovr"
<br>save performance "limit_hi_ion.per"
<br>save heating "limit_hi_ion.het"
<br>save cooling "limit_hi_ion.col"
<br># 
<br># 
<br># func_hi_ion.in 
<br># class function 
<br># ========================================
<br># 
</kbd><p>
This tests a limit of very high ionization
<p>
 
</p><hr><kbd><h2>limit_laser_1.in</h2>  </kbd><h2><I>test of H ionization in optically thin limit
</I></h2><kbd><br>title test of H ionization in optically thin limit
<br>#
<br># commands controlling continuum =========
<br>laser 1.5 Ryd 
<br>phi(h) 10
<br>#
<br># commands for density & abundances =========
<br>hden 1
<br>init file="hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>constant temperature = 4
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>save overview "limit_laser_1.ovr"
<br>save performance "limit_laser_1.per"
<br>save convergence reason "limit_laser_1.cvr"
<br>#
<br># limit_laser_1.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks the calculation of the hydrogen photoionization equilibrium.
The continuum is a laser peaked at 1.5 Ryd, where the hydrogen
photoionization cross section is 2.09*10-18 cm-2. 
<p>
<br>Checks:
<br>-	The hydrogen neutral fraction is nearly 2.00*10-4 (not exact
	since laser has finite width).
<br>-	Hb emissivity close to high density case A.  The predicted
	H  1 4861 intensity should be nearly 2.2 times the expected
	case B intensity.
<p>
H cross section is 2.09E-18 cm^2, rec coef is 4.18E-14
answer is neutral fraction 2.00E-4
also checks that only 3 iterations needed
</p><hr><kbd><h2>limit_laser_2.in</h2>  </kbd><h2><I>test of H and HeI ionization in optically thin limit
</I></h2><kbd><br>title test of H and HeI ionization in optically thin limit
<br>#
<br># commands controlling continuum =========
<br>laser 2.0 Ryd
<br>intensity -0.3604
<br>#
<br># commands for density & abundances =========
<br>hden 1
<br>init file="hheonly.ini"
<br>abundances all -10
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature = 4
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>save overview "limit_laser_2.ovr"
<br>save performance "limit_laser_2.per"
<br>#
<br># limit_laser_2.in
<br># class limit  
<br># ========================================
<br># 
</kbd><p>
This checks the calculation of the hydrogen and helium photoionization
equilibrium. The continuum is a laser peaked at 2.0 Ryd, and so can
only ionize hydrogen and atomic helium. 
<p>
<br>Checks:
<br>-	The hydrogen neutral fraction is nearly Ho/H+=4.51*10-4
	(not exact since laser has finite width).
<br>-	Hb emissivity close to high density case A.  The predicted H  1 4861
	intensity should be nearly 2.2 times the expected case B intensity.
<br>-	Helium ionization should be Heo/He+ = 6.61*10-4.
<p>
H cross section is 0.927E-18 cm^2, rec coef is 4.18E-13
answer is Ho/H+ = 4.51e-4
HeI cross section is 6.54E-18 cm^2, rec coef is 4.32E-13
answer is Heo/He+ = 6.61e-5
</p><hr><kbd><h2>limit_laser_200.in</h2>  </kbd><h2><I>ionization in Auger-dominated limit
</I></h2><kbd><br>title ionization in Auger-dominated limit
<br>#
<br># commands controlling continuum =========
<br>laser 200 Ryd
<br>phi(h) 10
<br>#
<br># commands for density & abundances =========
<br>hden 1
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>iterate  to convergence 
<br>constant temperature = 5
<br>#
<br># commands controlling output    =========
<br>save overview "limit_laser_200.ovr"
<br>save performance "limit_laser_200.per"
<br>#
<br># limit_laser_200.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks the calculation of ionization
equilibrium.  The continuum is a laser peaked at 200 Ryd.
It asserts ionization of C, O, and Fe.  their ionization is dominated
by the Auger effect.
<p>
<br>Checks:
Auger OK
</p><hr><kbd><h2>limit_laser_200_low.in</h2>  </kbd><h2><I>test ionization in Auger-dominated limit
</I></h2><kbd><br>title test ionization in Auger-dominated limit
<br>#
<br># commands controlling continuum =========
<br>laser 200 Ryd
<br>phi(h) 5
<br>#
<br># commands for density & abundances =========
<br>hden 1
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>iterate  to convergence 
<br>constant temperature = 4
<br>#
<br># commands controlling output    =========
<br>save overview "limit_laser_200_low.ovr"
<br>save performance "limit_laser_200_low.per"
<br>#
<br># 
<br># 
<br># 
<br># 
<br># limit_laser_200_low.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks the calculation of ionization
equilibrium.  The continuum is a laser peaked at 200 Ryd.
It asserts ionization of C, O, and Fe.  their ionization is dominated
by the Auger effect.
<p>
<br>Checks:
Auger OK
</p><hr><kbd><h2>limit_laser_3.in</h2>  </kbd><h2><I>test H and He ionization in optically thin limit
</I></h2><kbd><br>title test H and He ionization in optically thin limit
<br>#
<br># commands controlling continuum =========
<br>laser 4.3 Ryd
<br>phi(h) 10
<br>#
<br># commands for density & abundances =========
<br>hden 1
<br>abundances all -10
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>iterate  to convergence 
<br>constant temperature = 4
<br>#
<br># commands controlling output    =========
<br>save overview "limit_laser_3.ovr"
<br>save performance "limit_laser_3.per"
<br>#
<br># limit_laser_3.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks the calculation of the hydrogen and helium photoionization
equilibrium.  The continuum is a laser peaked at 4.3 Ryd, where it
can fully ionize both hydrogen and helium. 
<p>
<br>Checks:
<br>-	The hydrogen neutral fraction is nearly 4.18*10-4
	(not exact since laser has finite width).
<br>-	Helium ion: The ratio He+/He++ should be 1.69*10-3 and
	the ratio Heo/He+ should be 2.86*10-4.
<br>-	Hb emissivity should be close to high-density case A.  The predicted
	H  1 4861 intensity should be nearly 2.2 times the expected
	case B intensity.
<p>
H cross section is 1.0E-18 cm^2, rec coef is 4.18E-13
answer is n(Ho)/n(H+)=4.18e-3
HeI cross section is 1.51E-18 cm^2, rec coef is 4.32e-13
answer is n(Heo)/n(He+)=2.86e-4, so Heo/He = 4.83e-7
HeII cross section is 1.30E-18 cm^2, rec coef is 2.20e-12
answer is n(He+)/n(He2+)=1.69e-3
</p><hr><kbd><h2>limit_lowd0.in</h2>  </kbd><h2><I>test low density limit
</I></h2><kbd><br>title test low density limit
<br># this and limit_lowdm6 should get same results
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>abundances old solar 84 
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 4861.32A 0.86
<br>print line sort wavelength range 100 1m
<br>save overview "limit_lowd0.ovr"
<br>save performance "limit_lowd0.per"
<br>save cooling last "limit_lowd0.col"
<br>save continuum last "limit_lowd0.con"
<br>#
<br># all asserts for both sims are in this file
<br>init file="lowd.dat"
<br>#
<br># limit_lowd0.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
this test case is paired with lowdm6.in
both tests read in the same set of asserts, those contained in
the file lowd.dat, and they should get exactly the same answer
<p>
this is also the test of the print lines intensity command 
</p><hr><kbd><h2>limit_lowden.in</h2>  </kbd><h2><I>test optically thin model that extends to very low densities
</I></h2><kbd><br>title test optically thin model that extends to very low densities
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter 0
<br>#
<br># commands for density & abundances =========
<br>hden -2 to the -2 power
<br>init file="ism.ini"
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br># this will take density down to 1e-8, below stated limit
<br>radius 10 13 
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>save performance "limit_lowden.per"
<br>save overview "limit_lowden.ovr" last
<br>#
<br># limit_lowden.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This model is optically thin, with density falling off as inverse square law,
so ionization and temperature should be nearly constant.
if outer radius increased by 2 dex problem with level3 will appear,
several li seq lines (OVI, NeVIII) will fluctuate when density about
1e-9
<p>
We do not assert H lines since the cloud is optically thin and takes
at least three iterations to converge optical depth scale, 
That is not the purpose of this sim
</p><hr><kbd><h2>limit_lowdm6.in</h2>  </kbd><h2><I>test low density limit
</I></h2><kbd><br>title test low density limit
<br># this and limit_lowd0 should get same results
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden -6
<br>abundances old solar 84 
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>normalize to "H  1" 4861.32A 0.86
<br>print line sort wavelength range 100 1m
<br>save overview "limit_lowdm6.ovr"
<br>save performance "limit_lowdm6.per"
<br>save cooling last "limit_lowdm6.col"
<br>save continuum last "limit_lowdm6.con"
<br>#
<br># all asserts are in this file
<br>init file="lowd.dat"
<br>#
<br># limit_lowdm6.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
this test case is paired with lowd0.in
both tests read in the same set of asserts, those contained in
the file lowd.dat, and they should get exactly the same answer
<p>
this also tests the print line sort range command
</p><hr><kbd><h2>limit_lowion.in</h2>  </kbd><h2><I>test conditions of very low ionization matrix solver
</I></h2><kbd><br>title test conditions of very low ionization matrix solver
<br>#
<br># commands controlling continuum =========
<br>blackbody 50000
<br>ionization parameter -30
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>no molecules
<br>constant temperature 100
<br>#
<br># commands controlling output    =========
<br>save overview "limit_lowion.ovr"
<br>save performance "limit_lowion.per"
<br>#
<br># limit_lowion.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This model test very low ionization solution of hydrogen and helium.
<p>
</p><hr><kbd><h2>limit_lte_h_t50_cion.in</h2>  </kbd><h2><I>collisionally ionized H in LTE limit
</I></h2><kbd><br>title collisionally ionized H in LTE limit
<br>#
<br># commands controlling continuum =========
<br>black body, T = 50000 K
<br>ionization parameter -8
<br>#
<br># commands for density & abundances =========
<br>hden = 20
<br>set eden 20
<br>init file="hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop lyman optical depth -6
<br>set dr -10
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>constant temperature = 50000 K
<br># want pure collisional model
<br>no induced processes  (OK) 
<br>database h-like collisional excitation off 
<br>database h-like collisions l-mixing off 
<br>database he-like collisional excitation off 
<br>database he-like collisions l-mixing off 
<br>database he-like collapsed levels 20
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print h-like departure coefficients hydrogen
<br>print he-like departure coefficients helium
<br>print populations h-like hydrogen 
<br>save overview "limit_lte_h_t50_cion.ovr"
<br>save performance "limit_lte_h_t50_cion.per"
<br>#
<br># limit_lte_h_t50_cion.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is the limiting case pure hydrogen collisional ionization,
There are no excitation or l-mixing collisions, so this tests whether 
collisional ionization - three body recombination
works in detailed balance.
<p>
</p><hr><kbd><h2>limit_lte_h_t50_coll.in</h2>  </kbd><h2><I>collisionally excited H in LTE limit
</I></h2><kbd><br>title collisionally excited H in LTE limit
<br>#
<br># commands controlling continuum =========
<br>black body, T = 50000 K
<br>ionization parameter -8
<br>#
<br># commands for density & abundances =========
<br>hden = 20
<br>init file="hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop lyman optical depth -6
<br>stop zone 1
<br>set dr 0
<br>set eden 20 
<br>#
<br># other commands for details     =========
<br>no induced processes  (OK) 
<br>database h-like collisions l-mixing off 
<br>database he-like collapsed levels 20
<br>database he-like collisions l-mixing off 
<br>constant temperature = 50000 K
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print h-like departure coefficients hydrogen
<br>print h-like populations hydrogen
<br>print he-like departure coefficients helium
<br>save overview "limit_lte_h_t50_coll.ovr"
<br>save performance "limit_lte_h_t50_coll.per"
<br>#
<br># limit_lte_h_t50_coll.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks that the model H atom goes to LTE at high densities. 
<p>
chng 06 aug 24, had not included collisional ionization, and so he-like
departure coefficients were very large, around 202.  comments said there
were problems.  turned on collisional ionization, no problems noted
<p>
chng 06 jul 22
with RP changes in high-n n-changing collisions the rates are now much
smaller - needed to change density to be far higher and several 
quantities changed.  at lower density (1e18 cm-3) the populations are very
unphysical and runaway maser now occurs.  this is only a homework problem
and intended to only test n-changing collisions.  with higher density
this test is done.
<p>
</p><hr><kbd><h2>limit_lte_he1_coll.in</h2>  </kbd><h2><I>He atom at high densities 
</I></h2><kbd><br>title He atom at high densities 
<br>#
<br># commands controlling continuum =========
<br>laser 2
<br>ionization -3
<br>#
<br># commands for density & abundances =========
<br>hden 18
<br>set eden 18
<br>element helium abundance -1
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -10 
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 10
<br>database he-like collapsed levels 20
<br>constant temper 20000 K
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure helium 
<br>normalize to "Blnd" 4471.50A
<br>print line faint -2
<br>save overview "limit_lte_he1_coll.ovr"
<br>save performance "limit_lte_he1_coll.per"
<br>#
<br># limit_lte_he1_coll.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test whether he-like ion populations go to lte in high density limit.
The level populations should be in LTE, and the departure coefficients
should be unity.
<p>
</p><hr><kbd><h2>limit_lte_he1_nomole_iso_force.in</h2>  </kbd><h2><I>He atom in LTE at high densities, with no molecules, iso forced to LTE
</I></h2><kbd><br>title He atom in LTE at high densities, with no molecules, iso forced to LTE
<br>#
<br># commands controlling continuum =========
<br>blackbody 50000 STE
<br>#
<br># commands for density & abundances =========
<br>hden 1
<br># a high he abundance so that it dominates 
<br>element helium abundance 18
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br># atom he-like levels 7
<br># atom he-like collapsed levels 30
<br>no molecules
<br>database h-like levels LTE
<br>database he-like levels LTE
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure helium 
<br>print he-like population helium 
<br>print h-like departure helium 
<br>print h-like population helium 
<br>print h-like departure hydrogen 
<br>normalize to "Blnd" 4471.50A
<br>print line faint -2
<br>save overview "limit_lte_he1_nomole_iso_force.ovr"
<br>save performance "limit_lte_he1_nomole_iso_force.per"
<br>save heating "limit_lte_he1_nomole_iso_force.het" 
<br>save cooling "limit_lte_he1_nomole_iso_force.col" 
<br>save dr "limit_lte_he1_nomole_iso_force.dr" 
<br>#
<br># limit_lte_he1_nomole_iso_force.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test whether a gas dominated by He goes to LTE in high-density limit.
The level populations should be in LTE, the departure coefficients
should be unity, and the temperature equal to the BB temp.
<p>
</p><hr><kbd><h2>limit_lte_he1_nomole_ste.in</h2>  </kbd><h2><I>He atom in LTE at high densities, with no molecules
</I></h2><kbd><br>title He atom in LTE at high densities, with no molecules
<br>#
<br># commands controlling continuum =========
<br>blackbody 50000 STE
<br>#
<br># commands for density & abundances =========
<br>hden 1
<br># a high he abundance so that it dominates 
<br>element helium abundance 18
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 7
<br>database he-like collapsed levels 30
<br>no molecules
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure helium 
<br>print he-like population helium 
<br>print h-like departure helium 
<br>print h-like population helium 
<br>print h-like departure hydrogen 
<br>normalize to "Blnd" 4471.50A
<br>print line faint -2
<br>save overview "limit_lte_he1_nomole_ste.ovr"
<br>save performance "limit_lte_he1_nomole_ste.per"
<br>save heating "limit_lte_he1_nomole_ste.het" 
<br>save cooling "limit_lte_he1_nomole_ste.col" 
<br>save dr "limit_lte_he1_nomole_ste.dr" 
<br>save species departure "limit_lte_he1_nomole_ste.dep" last all
<br>#
<br># limit_lte_he1_nomole_ste.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test whether a gas dominated by He goes to LTE in high-density limit.
The level populations should be in LTE, the departure coefficients
should be unity, and the temperature equal to the BB temp.
<p>
</p><hr><kbd><h2>limit_lte_he1_nomole_ste_nocoll.in</h2>  </kbd><h2><I>He atom in LTE at high densities, with no molecules and no collapsed levels
</I></h2><kbd><br>title He atom in LTE at high densities, with no molecules and no collapsed levels
<br>#
<br># commands controlling continuum =========
<br>blackbody 50000 STE
<br>#
<br># commands for density & abundances =========
<br>hden 1
<br># a high he abundance so that it dominates 
<br>element helium abundance 18
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>no molecules
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure helium 
<br>print he-like population helium 
<br>print h-like departure helium 
<br>print h-like population helium 
<br>print h-like departure hydrogen 
<br>normalize to "Blnd" 4471.50A
<br>print line faint -2
<br>save overview "limit_lte_he1_nomole_ste_nocoll.ovr"
<br>save performance "limit_lte_he1_nomole_ste_nocoll.per"
<br>save heating "limit_lte_he1_nomole_ste_nocoll.het" 
<br>save cooling "limit_lte_he1_nomole_ste_nocoll.col" 
<br>save dr "limit_lte_he1_nomole_ste_nocoll.dr" 
<br>#
<br># limit_lte_he1_nomole_ste_nocoll.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test whether a gas dominated by He goes to LTE in high-density limit.
The level populations should be in LTE, the departure coefficients
should be unity, and the temperature equal to the BB temp.
<p>
Level collapse options have been switched off in this, compared
to limit_lte_he1_nomole_ste, so effect of including the collapsed
levels on LTE can be verified.
</p><hr><kbd><h2>limit_lte_he1_nomole_ste_nocoll2.in</h2>  </kbd><h2><I>He atom in LTE for a large range of Te and density, with no molecules and no collapsed levels and no collisions
</I></h2><kbd><br>title He atom in LTE for a large range of Te and density, with no molecules and no collapsed levels and no collisions
<br>#
<br># commands controlling continuum =========
<br>blackbody 4.3 STE vary
<br>grid 3.7 to 6.5 step 0.1 sequential
<br>#
<br># commands for density & abundances =========
<br>hden 1 
<br># a high he abundance so that it dominates 
<br>element helium abundance 18 vary 
<br>grid 4 to 18 2.0
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>no molecules
<br>database h-like collisions off
<br>database he-like collisions off
<br>set dr -10
<br>#
<br># commands controlling output    =========
<br>print he-like departure helium 
<br>print he-like population helium 
<br>print h-like departure helium 
<br>print h-like population helium 
<br>normalize to "Inci" 4860 
<br>print line faint -2
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save grid "limit_lte_he1_nomole_ste_nocoll2.grd"
<br>save overview "limit_lte_he1_nomole_ste_nocoll2.ovr"
<br>save performance "limit_lte_he1_nomole_ste_nocoll2.per"
<br>save heating "limit_lte_he1_nomole_ste_nocoll2.het" 
<br>save cooling "limit_lte_he1_nomole_ste_nocoll2.col" 
<br>save dr "limit_lte_he1_nomole_ste_nocoll2.dr" 
<br>#
<br># >>chng 14 dec 14, Badnell S DR, increase error
<br># limit_lte_he1_nomole_ste_nocoll2.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test whether a gas dominated by He goes to LTE in a range of conditions.
The level populations should be in LTE, the departure coefficients
should be unity, and the temperature equal to the BB temp.
<p>
These are STE calculations with no collapsed levels, no collisions,
and no molecules, so these models should stringently test the
thermodynamic equilibrium limit of radiative coupling terms.
</p><hr><kbd><h2>limit_lte_he1_ste.in</h2>  </kbd><h2><I>He atom in LTE at high densities 
</I></h2><kbd><br>title He atom in LTE at high densities 
<br>#
<br># commands controlling continuum =========
<br>blackbody 50000 STE
<br>#
<br># commands for density & abundances =========
<br>hden 18
<br># a high he abundance so that it dominates 
<br>element helium abundance 1
<br>init file "hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>database he-like resolved levels 7
<br>database he-like collapsed levels 30
<br># atom h2 matrix all
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print he-like departure helium 
<br>print he-like population helium 
<br>print h-like departure helium 
<br>print h-like population helium 
<br>print h-like departure hydrogen 
<br>normalize to "Blnd" 4471.50A
<br>print line faint -2
<br>save overview "limit_lte_he1_ste.ovr"
<br>save performance "limit_lte_he1_ste.per"
<br>save heating "limit_lte_he1_ste.het" 
<br>save cooling "limit_lte_he1_ste.col" 
<br>save dr "limit_lte_he1_ste.dr" 
<br>save species departure "limit_lte_he1_ste.dep" last all
<br>save dominant rates "limit_lte_he1_ste.h2" "H2"
<br>#
<br># limit_lte_he1_ste.in 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test whether a gas dominated by He goes to LTE in high-density limit.
The level populations should be in LTE, the departure coefficients
should be unity, and the temperature equal to the BB temp.
<p>
</p><hr><kbd><h2>limit_lte_hhe_coll_t50.in</h2>  </kbd><h2><I>H, He in LTE at high densities 
</I></h2><kbd><br>title H, He in LTE at high densities 
<br># test from Ferland and Rees 88, collisions drive H to LTE
<br># collisions should drive all departure coef to unity
<br>#
<br># commands controlling continuum =========
<br>black body t = 50000
<br>ionization parameter -5
<br>#
<br># commands for density & abundances =========
<br>hden = 19
<br>init file="hheonly.ini"
<br>set eden 20
<br>#
<br># commands controlling geometry  =========
<br>set dr -10
<br>stop zone 1
<br>stop lyman optical depth -6
<br>#
<br># other commands for details     =========
<br>constant temperature = 50000
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure coefficients h-like hydrogen
<br>print populations h-like hydrogen
<br>print departure coefficients h-like helium
<br>print populations h-like helium
<br>print departure coefficients he-like helium
<br>print populations he-like 
<br>save overview "limit_lte_hhe_coll_t50.ovr"
<br>save performance "limit_lte_hhe_coll_t50.per"
<br>save dr "limit_lte_hhe_coll_t50.dr" last
<br>#
<br># limit_lte_hhe_coll_t50.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This model is a test of the behavior of hydrogen and helium
in the high density, collision dominated, limit.
The temperature is preset, the hydrogen density is set
to a very high value, and the ionization parameter is very low.
The resulting model is collision dominated, so this case
checks that the collision physics occurs in detailed balance.
The predicted departure coefficients should all equal unity.
The set dr command sets the zone thickness to 1 cm.  
<p>
<br>Checks:
<br>-	Hydrogen departure coefficients exactly unity.
<br>-	Helium departure coefficients near unity.  
	(Density not high enough to bring helium departure coefficients
	exactly to unity.)
<br>-	H-, H2, H2+ H3+, and HeH+ departure coefficients exactly unity.
`
</p><hr><kbd><h2>limit_lte_hhe_induc.in</h2>  </kbd><h2><I>radiation dominated H, He gas goes to STE
</I></h2><kbd><br>title radiation dominated H, He gas goes to STE
<br>#
<br># commands controlling continuum =========
<br>black body, t = 50000 STE
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>init file="hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop lyman continuum optical depth -6
<br>set dr -10
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>set temperature convergence 0.002
<br>#
<br># commands controlling output    =========
<br>print populations h-like hydrogen
<br>print heating
<br>print departure coef element hydrogen
<br>print line faint -1
<br>save overview "limit_lte_hhe_induc.ovr"
<br>save performance "limit_lte_hhe_induc.per"
<br>#
<br># limit_lte_hhe_induc.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a H, He-only gas that is optically thin in the Lyman continuum.  It is
irradiated by a blackbody in strict thermodynamic equilibrium.  The tests confirm
that the gas temperature equilibriates close to the black body temperature.
<p>
<p>
</p><hr><kbd><h2>limit_lte_hhe_ste.in</h2>  </kbd><h2><I>H, He in STE
</I></h2><kbd><br>title H, He in STE
<br># from Ferland and Rees 1988
<br># this tests whether thermal processes go to STE
<br>#
<br># commands controlling continuum =========
<br>black body, t = 50000 STE
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>init file="hheonly.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop lyman optical depth -6
<br>set dr -10
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print heating
<br>print populations h-like hydrogen
<br>print departure coef h-like hydrogen
<br>print departure coef he-like helium
<br>save overview "limit_ste_hhe_ste.ovr"
<br>save performance "limit_ste_hhe_ste.per"
<br>#
<br># limit_ste_hhe_ste.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is the ultimate test of the behavior of the code in the
strict thermodynamic equilibrium limit. The temperature is not
held constant, so the resulting equilibrium temperature determines
whether cooling processes are treated properly in the detailed balance limit.
The equilibrium temperature should be exactly 5*104 K, and all
departure coefficients should equal unity. A small amount of
grains are included to check that the grain thermal balance is
handled properly in this limit. 
<p>
<br>Checks:
<br>-	Electron temperature exactly 5*104 K.
<br>-	Departure coefficients unity.
<p>
</p><hr><kbd><h2>limit_lte_hminus.in</h2>  </kbd><h2><I>H- goes to LTE
</I></h2><kbd><br>title H- goes to LTE
<br>#
<br># commands controlling continuum =========
<br># this is a second way to get STE and tests the energy density option
<br>blackbody 5000 energy density 5000K
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>iterate
<br>constant temperature 5000
<br>#
<br># commands controlling output    =========
<br>print populations h-like hydrogen
<br>save overview "limit_lte_hminus.ovr"
<br>save performance "limit_lte_hminus.per"
<br>print departure coef element hydrogen
<br>#
<br># limit_lte_hminus.in
<br># 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks that the negative hydrogen ion goes
to thermodynamic equilibrium when irradiated by
a blackbody in thermodynamic equlibrium.  It was
originally presented in
 
>>refer	H-	test	Ferland, G. J., & Persson, S. E. 1989, ApJ, 347, 656
</p><hr><kbd><h2>limit_lte_metal.in</h2>  </kbd><h2><I>STE with metals
</I></h2><kbd><br>title STE with metals
<br># this tests whether thermal processes go to STE
<br>#
<br># commands controlling continuum =========
<br># a dilution factor of 1 is one way to get STE
<br>black body, t = 20000 dilution 1
<br>#
<br># commands for density & abundances =========
<br>hden 10
<br>abundances starburst 5
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>stop lyman optical depth -6
<br>set dr -10
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print departure coef element hydrogen
<br>print populations h-like hydrogen
<br>save overview "limit_lte_metal.ovr"
<br>save performance "limit_lte_metal.per"
<br>save heating "limit_lte_metal.het" last
<br>save cooling "limit_lte_metal.col" last
<br>#
<br># limit_lte_metal.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This checks that the code goes to strict thermodynamic equilibrium
for the case of a metal rich gas exposed to a true black body. 
The many heavy element lines should dominate cooling, so this is
a test that the multilevel atoms go to LTE in the radiation-dominated limit.
<p>
<br>Checks:
<br>-	Temperature should equilibrate at 20000 K.  
<br>-	Departure coefficients should equal unity.
<p>
</p><hr><kbd><h2>limit_recoil_ion.in</h2>  </kbd><h2><I>test compton recoil ionization of hydrogen 
</I></h2><kbd><br>title test compton recoil ionization of hydrogen 
<br>#
<br># commands controlling continuum =========
<br>laser 2000 ryd
<br>ionization parameter -5
<br>#
<br># commands for density & abundances =========
<br>hden 0
<br>init "honly.ini"
<br>#
<br># commands controlling geometry  =========
<br>set dr 14
<br>stop zone 10
<br>#
<br># other commands for details     =========
<br>iterate
<br>no secondary ionization 
<br>constant temperature 1000
<br>#
<br># commands controlling output    =========
<br>save overview "limit_recoil_ion.ovr"
<br>save performance "limit_recoil_ion.per"
<br>#
<br># 
<br># limit_recoil_ion.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
H ionization is totally due to recoil ionization in this model.
The assert checks the final hydrogen ionization. 
</p><hr><kbd><h2>limit_strom.in</h2>  </kbd><h2><I>pure-H Stromgren sphere
</I></h2><kbd><br>title pure-H Stromgren sphere
<br># the answer is R(Stromgren) = 4.16E17 cm
<br>#
<br># commands controlling continuum =========
<br>blackbody 50000 K
<br>q(h) 49
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>init file "honly.ini"
<br>abundances all -10
<br>#
<br># commands controlling geometry  =========
<br>sphere static
<br>radius 16
<br>stop efrac -0.5
<br>#
<br># other commands for details     =========
<br>no level2
<br>turbulence 20 km/s
<br>constant temper 7500
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save performance "limit_strom.per"
<br>save overview last "limit_strom.ovr"
<br>save results last "limit_strom.rlt"
<br>save dr last "limit_strom.dr"
<br>#
<br># limit_strom.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This case checks that the code computes the geometry and emissivity
correctly for a pure hydrogen spherical shell.  The low temperature
is chosen to avoid collisional ionization.  The model stops at the
Ho-H+ ionization front.  The turbulence is to prevent the Balmer lines
from becoming optically thick.
 
<br>Checks
<br>-	Outer radius should be 4.16391017 cm.
<br>-	Predicted Hb, case B Hb, and Q(H) Hb, all agree.
<p>
</p><hr><kbd><h2>limit_supra.in</h2>  </kbd><h2><I>secondary ionization dominated gas
</I></h2><kbd><br>title secondary ionization dominated gas
<br># like SN envelope
<br>#
<br># commands controlling continuum =========
<br># this continuum will be VERY faint
<br>table agn
<br>ionization parameter -25
<br># secondary ioinzations will dominate
<br>set csupra -5
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>abundances old solar 84 
<br>#
<br># commands controlling geometry  =========
<br>stop temperature 20
<br>stop zone 1
<br>set dr 0 
<br>#
<br># other commands for details     =========
<br>constant temperature 1000 K
<br>iterate convergence
<br>#
<br># commands controlling output    =========
<br>print ages
<br>save overview "limit_supra.ovr"
<br>save performance "limit_supra.per"
<br>save heating "limit_supra.het"
<br>save ionizing continuum "limit_supra.ion" last 
<br>save molecules "limit_supra.mol"
<br>#
<br># 
<br># limit_supra.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This model computes the ionization within cool gas that is totally ionized
by suprathermal secondary electrons.  
<p>
Charge transfer heating is VERY important in this simulation.
<p>
</p><hr><kbd><h2>limit_thick_brems.in</h2>  </kbd><h2><I>optically thick brems
</I></h2><kbd><br>title optically thick brems
<br>#
<br># check that optically thick brems emission approaches the RJ limit
<br>#
<br># commands controlling continuum =========
<br>blackbody 2e5
<br>#
<br># we need to test this command in at least one sim
<br>Xi 3
<br>#
<br># commands for density & abundances =========
<br>hden 6
<br>#
<br># commands controlling geometry  =========
<br>stop column density 20
<br>#
<br># other commands for details     =========
<br>constant temperature 1e4
<br>iterate 3
<br>set nFnu diffuse outward
<br>set nFnu add 2e-8 ryd
<br>set nFnu add 5e-8 ryd
<br>set nFnu add 1e-7 ryd
<br>set nFnu add 2e-7 ryd
<br>set nFnu add 5e-7 ryd
<br>set nFnu add 1e-6 ryd
<br>set nFnu add 2e-6 ryd
<br>set nFnu add 5e-6 ryd
<br>set nFnu add 1e-5 ryd
<br>set nFnu add 2e-5 ryd
<br>set nFnu add 5e-5 ryd
<br>#
<br># commands controlling output    =========
<br>print line faint -10
<br>save continuum "limit_thick_brems.con" last units microns
<br>save optical depth "limit_thick_brems.opd" last
<br>save overview "limit_thick_brems.ovr"
<br>save dr "limit_thick_brems.dr"
<br>#
<br># commands giving the asserts    =========
<br>#
<br>#
<br># limit_thick_brems.in
<br># class limit
<br># ========================================
<br># 
</kbd><p>
At some point we had a major bug affecting the optically thick part of the
radio free-free emission. This sim checks that the optically thick emission
from a plane-parallel slab has the correct Rayleigh-Jeans shape. This implies
that at long wavelengths nuFnu should vary as lambda^3.
</p><hr><kbd><h2>limit_vbhum.in</h2>  </kbd><h2><I>compare with Van Blerkom and Hummer exact RT results
</I></h2><kbd><br>title compare with Van Blerkom and Hummer exact RT results
<br>#
<br># commands controlling continuum =========
<br>blackbody 50000 K
<br>phi(h) 12.30103
<br># commands for density & abundances =========
<br>hden 4
<br>init "honly.ini"
<br>abundances all -10
<br>#
<br># commands controlling geometry  =========
<br>stop efrac -0.5
<br>#
<br># other commands for details     =========
<br>diffuse ots
<br>no level2 lines
<br>constant temper 4
<br>iterate
<br>#
<br># commands controlling output    =========
<br>save performance "limit_vbhum.per"
<br>save overview last "limit_vbhum.ovr"
<br>save dr last "limit_vbhum.dr"
<br>#
<br># 
<br># limit_vbhum.in
<br># 
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
This is a test of the treatment of the diffuse fields, their transfer,
and their effects on the ionization structure of a nebula. The comparison
is made against the exact calculation published by Van Blerkom and
Hummer (1967). The geometry is open, that is, similar to that assumed
in most BLR calculations. 
<p>
>>refer	H	ionization	Van Blerkom, D., & Hummer, D. G. 1967, MNRAS, 137, 353
<p>
The diffuse ots command is entered in order to reproduce the
Van Blerkom and Hummer results.  The default assumption, outward only,
does not agree as well.  I changed the default from OTS to outward only
to be in better agreement with predictions by Harrington and Rubin
at the Lexington meeting.  They have not checked whether their codes
are in agreement with the Van Blerkom and Hummer paper.
<p>
<br>Checks:
<br>-	Neutral fraction at illuminated face 5.8*10-4.
<br>-	Location of ionization front at 7.8*1016 cm.
<br>-	34He 1 486134 and 34CA B 486134 agree;  both slightly lower than 34Q(H) 486134.
<br>-	Answers with OTS agree with 1967 results.
<p>
test hydrogen ground state rec effic against vb+h exact results
this is their case e) - "zero condition"
their answer for H0/Htot at the illuminated edge is approx 5.8E-4,
and a Stromgren radius of approximately 7.7E16 cm
</p><hr><kbd><h2>limit_veryveryfast.in</h2>  </kbd><h2><I>very fast simulation for Purify/valgrind
</I></h2><kbd><br>title very fast simulation for Purify/valgrind
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -2
<br>#
<br>no file opacity
<br>set dr 0 
<br>#
<br># commands for density & abundances =========
<br>hden 9
<br>init file "hheonly.ini"
<br>element oxygen on  
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>no level 2
<br>constant temperature 4
<br>database h-like levels small
<br>database he-like levels small
<br>#
<br># commands controlling output    =========
<br>save overview "limit_veryveryfast.ovr"
<br>save performance "limit_veryveryfast.per"
<br>save dr last "limit_veryveryfast.dr"
<br>#
<br># 
<br># limit_veryveryfast
<br># class limit   
<br># ========================================
<br># 
</kbd><p>
This is meant to be a very fast calculation to 
use when running extensive debug-enabled runtimes.
<p>
<p>
</p><hr><kbd><h2>lya-21cm-constant.in</h2>  </kbd><h2><I>test effect of lya pump on spin temperature
</I></h2><kbd><br>title test effect of lya pump on spin temperature
<br>#
<br># commands controlling continuum =========
<br>#
<br>table ism 
<br>extinguish column 22
<br>CMB, z=0
<br># 
<br># commands for density & abundances =========
<br># set the density and composition, ism with grains
<br>#
<br>hden 2 
<br>abundance ism 
<br>#
<br># other commands for details     =========
<br>#
<br># this is an important ionization source
<br>cosmic rays background  
<br># optical depth
<br>double
<br>iterate
<br>turbulence 3 km/s
<br># stopping criteria
<br>stop temperature 3K linear
<br>stop neutral hydrogen column density 18
<br>#
<br># command exercised =========
<br>#
<br>set lya 21cm constant
<br>#
<br># commands controlling output    =========
<br>#
<br>set save prefix "lya-21cm-constant"
<br>save hydrogen 21cm ".21cm" last
<br>save hydrogen lya ".lya" last
<br>save overview ".ovr" last
<br>#
<br>#
<br>#
<br>#
<br>#
<br># # ========================================
</kbd><p>
This is one of the sims employed by Shaw, Ferland, & Hubeny 2017, ApJ, 843, 149.
It exercises the Snu=constant case to column density of 1e18, while the original
paper used a 1e20 stopping criterion.
</p><hr><kbd><h2>lya-21cm-excitation.in</h2>  </kbd><h2><I>test effect of lya pump on spin temperature
</I></h2><kbd><br>title test effect of lya pump on spin temperature
<br>#
<br># commands controlling continuum =========
<br>#
<br>table ism 
<br>extinguish column 22
<br>CMB, z=0
<br># 
<br># commands for density & abundances =========
<br># set the density and composition, ism with grains
<br>#
<br>hden 2 
<br>abundance ism 
<br>#
<br># other commands for details     =========
<br>#
<br># this is an important ionization source
<br>cosmic rays background  
<br># optical depth
<br>double
<br>iterate
<br>turbulence 3 km/s
<br># stopping criteria
<br>stop temperature 3K linear
<br>stop neutral hydrogen column density 18
<br>#
<br># command exercised =========
<br>#
<br>set lya 21cm excitation
<br>#
<br># commands controlling output    =========
<br>#
<br>set save prefix "lya-21cm-excitation"
<br>save hydrogen 21cm ".21cm" last
<br>save hydrogen lya ".lya" last
<br>save overview ".ovr" last
<br>#
<br>#
<br>#
<br>#
<br>#
<br># # ========================================
</kbd><p>
This is one of the sims employed by Shaw, Ferland, & Hubeny 2017, ApJ, 843, 149.
It exercises the Snu~B(Texc) case to column density of 1e18, while the original
paper used a 1e20 stopping criterion.
</p><hr><kbd><h2>lya-21cm-kinetic.in</h2>  </kbd><h2><I>test effect of lya pump on spin temperature
</I></h2><kbd><br>title test effect of lya pump on spin temperature
<br>#
<br># commands controlling continuum =========
<br>#
<br>table ism 
<br>extinguish column 22
<br>CMB, z=0
<br># 
<br># commands for density & abundances =========
<br># set the density and composition, ism with grains
<br>#
<br>hden 2 
<br>abundance ism 
<br>#
<br># other commands for details     =========
<br>#
<br># this is an important ionization source
<br>cosmic rays background  
<br># optical depth
<br>double
<br>iterate
<br>turbulence 3 km/s
<br># stopping criteria
<br>stop temperature 3K linear
<br>stop neutral hydrogen column density 18
<br>#
<br># command exercised =========
<br>#
<br>set lya 21cm kinetic
<br>#
<br># commands controlling output    =========
<br>#
<br>set save prefix "lya-21cm-kinetic"
<br>save hydrogen 21cm ".21cm" last
<br>save hydrogen lya ".lya" last
<br>save overview ".ovr" last
<br>#
<br>#
<br>#
<br>#
<br>#
<br># # ========================================
</kbd><p>
This is one of the sims employed by Shaw, Ferland, & Hubeny 2017, ApJ, 843, 149.
It exercises the Snu~B(Tkin) case to column density of 1e18, while the original
paper used a 1e20 stopping criterion.
</p><hr><kbd><h2>nlr_lex00.in</h2>  </kbd><h2><I>NLR model for Lexington 2000 Meeting
</I></h2><kbd><br>title NLR model for Lexington 2000 Meeting
<br>#
<br># commands controlling continuum =========
<br>phi(h) 12.47712
<br># shape of continuum is interpolated table 
<br>interpolate (0 -10) (0.08 -10) (0.1 1) (3676 -4.935) (4700 -11)
<br>continue (4750 -20) (7.4e6 -30)
<br>#
<br># commands controlling geometry  =========
<br>stop column 22
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>init file="c84.ini"
<br>abundances He=-1 c=-3.52 n=-4 o=-3.097 ne=-4 na=-9
<br>continue mg=-4.523 al=-8 si=-4.523 s=-4.824 ar=-9 ca=-8 fe=-8 ni=-9
<br>#
<br># other commands for details     =========
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print line faint .01
<br># add sum of these lines to printout for Stoy ratio 
<br>print line sum
<br>H  1 1215.67A
<br>Blnd 5875.66A
<br>blnd 1909
<br>blnd 1549
<br>N  2  6583.45
<br>N  2 6548.05
<br>n  3  57.3238m
<br>blnd  1750
<br>blnd 1486
<br>O  1  6300.30
<br>o  1 63.1679m
<br>blnd  3727
<br>blnd  1666
<br>O  3  51.8004m
<br>o  3  5006.84
<br>o  3  4958.91
<br>blnd  1402
<br>Ne 3  15.5509m
<br>Ne 3 3868.76A
<br>Ne 3 3967.47A
<br>Blnd 2424
<br>Ne 5 3425.88A
<br>Ne 5 3345.82A
<br>blnd 2798
<br>si 2 34.8046m
<br>Blnd 6720
<br>S  3  18.7078m
<br>S  3  9530.62
<br>S  3  9068.62
<br>S  4  10.5076m
<br>end of lines
<br># 
<br>save performance "nlr_lex00.per"
<br>save overview last "nlr_lex00.ovr"
<br>save dr last "nlr_lex00.dr"
<br>save results last "nlr_lex00.rlt"
<br>#
<br># nlr_lex00.in
<br># class nlr 
<br># ========================================
</kbd><p>
This is one of the test cases from the Lexington (1993) Meeting suite of nebulae. 
It is a grain-free NLR model.
</p><hr><kbd><h2>nlr_liner.in</h2>  </kbd><h2><I>NLR liner model
</I></h2><kbd><br>title NLR liner model
<br># a constant pressure (gas+radiation) model of a nlr_liner cloud
<br># in the spirit of Ferland and Netzer 1983
<br>#
<br># commands controlling continuum =========
<br>table agn
<br>ionization parameter -3
<br>#
<br># commands for density & abundances =========
<br>hden 6
<br>init file "ism.ini"
<br>abundances old solar 84 
<br>metals 0.3
<br>#
<br># commands controlling geometry  =========
<br>stop thickness 16.3
<br>stop column density 23
<br>constant pressure
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>save performance "nlr_liner.per"
<br>save overview last "nlr_liner.ovr"
<br>save element nitrogen last "nlr_liner.nit"
<br>save dr last "nlr_liner.dr"
<br>save results last "nlr_liner.rlt"
<br>#
<br># nlr_liner.in
<br># class nlr 
<br># ========================================
</kbd><p>
This is a model somewhat like the Liner parameters proposed by
Ferland and Netzer (1983).  A second iteration is performed to
allow the calculation of the line radiation pressure.
<p>
>>refer	nlr_liner	model	Ferland, G. J., & Netzer, H. 1983, ApJ, 264, 105
<p>
</p><hr><kbd><h2>nlr_liner_grains.in</h2>  </kbd><h2><I>liner model with grains
</I></h2><kbd><br>title liner model with grains
<br># 
<br># a constant pressure (gas+radiation) model of a liner cloud
<br># in the spirit of Ferland and Netzer 1983
<br>#
<br># commands controlling continuum =========
<br>ionization parameter -3
<br>table agn
<br>#
<br># commands for density & abundances =========
<br>hden 6
<br># this turns on both grains and depleted abundances
<br>abundances ism no grains 
<br>grains ism no qheat single
<br>init file "ism.ini"
<br>#
<br># commands controlling geometry  =========
<br>stop column density 23
<br>#
<br># other commands for details     =========
<br>constant pressure
<br>#
<br># commands controlling output    =========
<br>save performance "nlr_liner_grains.per"
<br>save overview last "nlr_liner_grains.ovr"
<br>save dr last "nlr_liner_grains.dr"
<br>save continuum last "nlr_liner_grains.con" units microns 
<br>save results last "nlr_liner_grains.rlt"
<br>#
<br># nlr_liner_grains.in
<br># class nlr 
<br># ========================================
<br># 
</kbd><p>
This is a model somewhat like the Liner parameters proposed by
Ferland and Netzer (1983).  A second iteration is performed to
allow the calculation of the line radiation pressure.
It includes grains and is so more realistic.
<p>
>>refer	liner	model	Ferland, G. J., & Netzer, H. 1983, ApJ, 264, 105
<p>
</p><hr><kbd><h2>nlr_paris.in</h2>  </kbd><h2><I>Paris meeting NLR model
</I></h2><kbd><br>title Paris meeting NLR model
<br>#
<br># commands controlling continuum =========
<br>interpolate (0 -10) (0.073 -10) (0.074 1) (7352 -4)
<br>continue (7400 -15) (7.353e6 -20)
<br>ionization parameter -2
<br>#
<br># commands controlling geometry  =========
<br>stop lyman continuum optical depth 4
<br>#
<br># commands for density & abundances =========
<br>hden 3
<br>init file="c84.ini"
<br>abund He=-1 C=-3.5229 N=-4. O=-3.22185 ne=-3.82391 na=-8 mg=-4.5229 al=-8
<br>continue si=-4.5229 s=-4.82391 ar=-8 ca=-8 fe=-7 ni=-8
<br>#
<br># other commands for details     =========
<br># this large group of lines are turned off so that the model runs
<br># 30 percent faster - lines are mainly fuv and x-ray, which we will
<br># not track in this model
<br>no level2
<br>iterate
<br>database h-like element helium levels resolved 10
<br>#
<br># commands controlling output    =========
<br>save performance "nlr_paris.per"
<br>save overview last "nlr_paris.ovr"
<br>save dr last "nlr_paris.dr"
<br>save results last "nlr_paris.rlt"
<br>#
<br># nlr_paris.in
<br># class nlr 
<br># ========================================
</kbd><p>
<p>
This is the NLR model presented in the Meudon meeting on model nebulae. 
The init file is entered to make the code behave more like version 84.
<p>
<br>Checks:
<br>-	init file works
<p>
</p><hr><kbd><h2>nova_dqher.in</h2>  </kbd><h2><I>cold nova shell
</I></h2><kbd><br>title cold nova shell
<br># Ferland et al. 1984 DQ Her
<br># model of room temperature ionized cloud arund old nova DQ Her
<br># roughly that of 
<br># tests behaviour of code at very low temperatures
<br>#
<br># commands controlling continuum =========
<br># flat continuum, followed by nu^-2 power law
<br>interpolate (0 0) (0.3 0) (8.e6 -14.8)
<br>luminosity total 34
<br>#
<br># commands for density & abundances =========
<br>hden = 2.
<br>abundances nova
<br>grains no qheat single
<br>#
<br># commands controlling geometry  =========
<br>filling factor 0.667
<br>covering factor 0.667
<br>radius 16.5682 , thickness = 16.14613
<br># need this since gas is so cool 
<br>stop temp = 100
<br>#
<br># other commands for details     =========
<br>cosmic rays background 
<br>iterate
<br>turbulence 300
<br>database h-like element hydrogen levels resolved 15
<br>database h-like element helium levels resolved 15
<br>#
<br># commands controlling output    =========
<br>normalize to label="CaBo" 4861.32A intensity 1.169
<br>print line all
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save performance "nova_dqher.per"
<br>save overview last "nova_dqher.ovr"
<br>save results last "nova_dqher.rlt"
<br>save dr last "nova_dqher.dr"
<br>save transmitted continuum "nova_dqher.trn" last
<br>#
<br># nova_dqher.in
<br># class nova 
<br># ========================================
<br># 
</kbd><p>
This tests the code39s behavior in the limit posed by the
metal rich low density nebula surrounding DQ Her (Ferland et al. 1984).
<br>Checks:
<br>-	Thickness exact 
<br>-	Thermal stability
	High-Z gas
	ionization at low temperature
</p><hr><kbd><h2>nova_photos.in</h2>  </kbd><h2><I>dense nova photosphere
</I></h2><kbd><br>title dense nova photosphere
<br>#
<br># commands controlling continuum =========
<br># this is the result of this command
<br># table star kurucz 35000; use old atlas atmosphere
<br># and makes it possible to run sims without
<br># installing the stellar atmosphere files 
<br># set SED of central star
<br>table SED "star_kurucz_35000.dat" 
<br># set luminosity of central star
<br>absolute bolometric magnitude -8.1 
<br>#
<br># commands for density & abundances =========
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>iterate to convergence
<br>#
<br># commands controlling output    =========
<br>print line faint -1
<br>save performance "nova_photos.per"
<br>save overview "nova_photos.ovr" last
<br>save convergence reason "nova_photos.cvg" no hash 
<br>save results "nova_photos.rlt" last
<br>save dr "nova_photos.dr" last
<br>save heat "nova_photos.het" last
<br>save cool "nova_photos.col" last
<br>#
<br># nova_photos.in
<br># class nova 
<br># ========================================
<br># 
</kbd><p>
this model is intensely affected by continuum pumping of atoms.  The
hydrogen ionizaiton is by lyman line pumping, followed by photoionization
from excited states.
</p><hr><kbd><h2>optimize_phymir.in</h2>  </kbd><h2><I>test phymir optimizers
</I></h2><kbd><br>title test phymir optimizers
<br># spectrum computed with hden 5, temp 4
<br># subplex, phymir, powell
<br>#
<br># commands controlling continuum =========
<br>black 40000 K
<br>ionization par -3
<br>#
<br># commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on 
<br>#
<br># commands controlling geometry  =========
<br>Case B 
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>optimize tolerance 0.03
<br>constant temper 4.3 vary
<br>optimize phymir 
<br>optimize iteration 100
<br># the following spectrum was derived by running this sim at hden 5 and t=4
<br># resulting eden was 5.039 and T=4, which we shall assert that we find
<br># >>chng 06 apr 03, backdate to old [OII] As and rederive spectrum
<br>optimize lines
<br>O  2  3728.81 0.1567
<br>O  2  3726.03 0.4087
<br>Blnd  7323 0.4344
<br>Blnd  7332 0.3577
<br>O  3  5006.84 3.8117
<br>O  3  4363.21 0.0368
<br>end of lines
<br>#
<br># commands controlling output    =========
<br>print line faint -2
<br>#
<br>save overview "optimize_phymir.ovr"
<br>save performance "optimize_phymir.per"
<br>#
<br># optimize_phymir.in 
<br># class optimizer 
<br># ========================================
<br># 
</kbd><p>
This checks whether the optimizer can recover a known solution.  The line
spectrum was calculated at T = 1e4 K and and n_H=1e5 cm^-3, 
and resulted in the given electron 
density.  The model optimize_subplex.in is a copy of this file.
<p>
</p><hr><kbd><h2>optimize_subplex.in</h2>  </kbd><h2><I>test subplex optimizer
</I></h2><kbd><br>title test subplex optimizer
<br># spectrum computed with hden 5, temp 4
<br># subplex, phymir, amoeba, powell
<br>#
<br># commands controlling continuum =========
<br>black 40000 K
<br>ionization par -3
<br>#
<br># commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on 
<br>#
<br># commands controlling geometry  =========
<br>Case B
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>constant temper 4.3 vary
<br>optimize subplex
<br>optimize iteration 100
<br>optimize tolerance 0.01
<br># the following spectrum was derived by running this sim at hden 5 and t=4
<br># resulting eden was 5.039 and T=4, which we shall assert that we find
<br># >>chng 06 apr 03, backdate to old [OII] As and rederive spectrum
<br>optimize lines
<br>O  2  3728.81 0.1567
<br>O  2  3726.03 0.4087
<br>Blnd  7323 0.4344
<br>Blnd  7332 0.3577
<br>O  3  5006.84 3.8117
<br>O  3  4363.21 0.0368
<br>end of lines
<br>#
<br># commands controlling output    =========
<br>print line faint -2
<br>#
<br>save overview "optimize_subplex.ovr"
<br>save performance "optimize_subplex.per"
<br>#
<br># optimize_subplex.in
<br># class optimizer 
<br># ========================================
<br># 
</kbd><p>
This checks whether the optimizer can recover a known solution.  The line
spectrum was calculated at T = 1e4 K and and n_H=1e5 cm^-3, 
and resulted in the given electron 
density.  The model optimize_phymir.in is a copy of this file.
<p>
</p><hr><kbd><h2>orion_hii_open.in</h2>  </kbd><h2><I>conditions similar to Orion nebula blister
</I></h2><kbd><br>title conditions similar to Orion nebula blister
<br># orion hii region with open geometry
<br>#
<br># commands controlling continuum =========
<br># SED of central star
<br>table SED "star_kurucz_39600.dat" 
<br># its flux of H-ionizing photons
<br>phi(h) 13.0
<br>#
<br># this is to include velocity field in radiative transfer
<br>turbulence 8 km/sec no pressure 
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>abundances hii region no grains
<br>grains orion
<br>#
<br># commands controlling geometry  =========
<br>cosmic rays, background
<br>constant pressure
<br># this is the account for continued matter beyond i front 
<br>double optical depths
<br>#
<br># other commands for details     =========
<br>iterate 2
<br>#
<br># commands controlling output    =========
<br>print line faint -5
<br># print lines as surface brightness
<br>print lines surface brightness arcsec 
<br>print line optical depths
<br># want to print line intensities are surface brightness, per arcsec^2
<br>print lines surface brightness arcsec
<br>save performance "orion_hii_open.per"
<br>save overview last "orion_hii_open.ovr"
<br>save dr last "orion_hii_open.dr"
<br>save continuum last "orion_hii_open.con" units microns
<br>save transmitted continuum last "orion_hii_open.trn" 
<br>save overview last "orion_hii_open.ovr"
<br>save fine opacity last "orion_hii_open.opc" range 0.7 0.9 ryd
<br>save element nitrogen last no hash "orion_hii_open.nit"
<br>save lines, array "orion_hii_open.lina" units microns last no hash
<br>save line emissivity "orion_hii_open.ems" last no hash emergent
<br>H  1  4861.32A
<br>O  3  5006.84A
<br>Blnd  5199A
<br>O  1  6300.30A
<br>O  1  63.1679m 
<br>end of lines
<br>save linelist "orion_hii_open.lin" "LineList_HII.dat" last no hash emergent absolute
<br>#
<br># orion_hii_open.in
<br># class hii 
<br># ========================================
</kbd><p>
This is a model similar in spirit to the blister geometry HII region
model computed by Baldwin et al. (1991). 
Size-resolved Orion grains are included.
The constant pressure command does a
hydrostatic equilibrium structure.  The predicted emission-line spectrum is
affected by the reddening of the internal grains.  The resulting t2
analysis produces artificial results as a result.
This has an open geometry, the original BFM paper was a closed geometry.
(This makes little difference).  Background cosmic rays are also included
although these should have little effect on warm ionized gas.  The emission
line spectrum is given in surface brightness units, as in the BFM paper.
<p>
</p><hr><kbd><h2>orion_hii_pdr.in</h2>  </kbd><h2><I>constant pressure H+ region/pdr
</I></h2><kbd><br>title constant pressure H+ region/pdr
<br>#
<br># commands controlling continuum =========
<br># the incident continuum is two parts
<br># star and flux of photons striking it
<br># this is the photosphere of the OVI star, its temperature and Q(H)
<br># this is the result of this command
<br># table star kurucz 39600 K
<br># and makes it possible to run these orion sims without
<br># installing the stellar atmosphere files 
<br>table SED "star_kurucz_39600.dat" 
<br>Q(H) 49
<br># this adds the observed hot brems, its temperature and the flux of 
<br># photons striking the cloud
<br>brems 6
<br>phi(h) 10
<br># add cosmic rays, which are important in the pdr
<br>cosmic rays, background
<br>#
<br># commands controlling geometry  =========
<br># this sets the separation from the star and the face of the cloud
<br>radius 17.4507
<br># this turns off the stop temperature opption
<br># the sim will not stop due to temperature
<br>stop temperature off
<br># this is typical of a gmc, larson 1981
<br>stop total hydrogen column density 23
<br># this sets the thickness of the HII region & PDR
<br>stop thickness 0.5 linear parsec 
<br># constant total pressure, so like orion_hii_open
<br>constant pressure 
<br># this will result in a milli gauss B-field in molecular region
<br>magnetic field -5 gauss
<br># the orion environment full covers the star, so turn on sphere
<br>sphere 
<br># we have a spherical geometry but want to simulate observing
<br># through a spectrometer's slit.  use the aperture
<br># command for this
<br>aperture beam 
<br>#
<br># other commands for details     =========
<br># mimic existence of unmodeled molecular gas
<br>double 
<br># iterate since lines optically thick
<br>iterate
<br># the observed microturbulence, partially a flow, so not included in pressure
<br>turbulence 8 km/sec no pressure
<br># set the line width so lines appear on the save continuum
<br>set save line width 10 km/s
<br># there should be no failures at all
<br>failures 3
<br>#
<br># commands for density & abundances =========
<br># this is the log of the initial H density, cm-3
<br>hden 4
<br># this will speed up the calculation a bit
<br>init file="ism.ini"
<br># this uses HII region abundances, but no grains
<br>abundances hii region no grains
<br># this turns on orion grains, but leaves quantum heating off to save time
<br>grains orion no qheat
<br># turn on PAHs, with an abundance that depends on H0 fraction,
<br># as suggested by long-slit observations of Orion bar,
<br># with an abundance 3x larger than default built into the code
<br>grains PAH function 3
<br># 
<br># commands controlling output    =========
<br>normalize to "O  1" 63.1679m
<br># print lots of faint CO lines
<br>print line faint -4
<br>save performance "orion_hii_pdr.per"
<br>save overview last "orion_hii_pdr.ovr"
<br>save heating "orion_hii_pdr.het"
<br>save cooling "orion_hii_pdr.col"
<br>save dr last "orion_hii_pdr.dr"
<br>save results last "orion_hii_pdr.rlt"
<br>save lines, array "orion_hii_pdr.lina" last, units microns
<br>save continuum last "orion_hii_pdr.con" units microns
<br>save hydrogen 21 cm last "orion_hii_pdr.21cm"
<br>save hydrogen lya last "orion_hii_pdr.lya" 
<br>save element silicon last "orion_hii_pdr.sil" 
<br>save grain extinction last  "orion_hii_pdr.grnext"
<br>save grain charge last "orion_hii_pdr.grnchr" 
<br>save grain potential last "orion_hii_pdr.grnpot" 
<br>save grain temperature last "orion_hii_pdr.grntem" 
<br>#
<br>#
<br>#
<br># orion_hii_pdr.in
<br># class hii pdr  
<br># ========================================
</kbd><p>
This extends BFM from the H+ region into the PDR as in Abel et al 2005.
This is the correct way to do a PDR calcualtion.
<p>
>>refer	Orion	model	Baldwin, J., Ferland, G. J., 
>>refercon	Martin, P. G., Corbin, M., Cota, S., Peterson, 
>>refercon	B. M., & Slettebak, A. 1991, ApJ, 374, 580
<p>
>>refer	physics	HII/PDR	Abel, N.P., Ferland, G.J., Shaw, G. & 
>>refercon	van Hoof, P.A.M. 2005, ApJS, 161, 65
</p><hr><kbd><h2>orion_hii_pdr_fast.in</h2>  </kbd><h2><I>constant gas pressure H+ region/PDR
</I></h2><kbd><br>title constant gas pressure H+ region/PDR
<br># much faster due to physics disabled by fast.ini
<br>#
<br># commands controlling continuum =========
<br># the incident continuum is two parts
<br># star and flux of photons striking it
<br># this is the result of this command
<br># table star kurucz 39600 K
<br># and makes it possible to run these orion sims without
<br># installing the stellar atmosphere files 
<br>table SED "star_kurucz_39600.dat" 
<br>Q(H) 49
<br># add cosmic rays, which are important at depth
<br>cosmic rays, background
<br># plus hot brems 
<br>brems 6
<br>phi(h) 10
<br># 
<br># commands for density & abundances =========
<br>hden 4
<br>init file="fast.ini"
<br>abundances hii region no grains
<br># single sized grain with no quantum heating 
<br>grains orion no qheat single 
<br>#
<br># commands controlling geometry  =========
<br>radius 17.4507
<br>sphere 
<br># let it go into the molecular cloud
<br>stop temperature 10 linear
<br># this is roughly the thickness of OMC1
<br>stop thickness 1 linear parsec 
<br># mimic existence of unmodeled molecular gas with double command
<br>double 
<br>#
<br># other commands for details     =========
<br>failures 3
<br>iterate
<br># make constant gas pressure since fast turned off line radiation pressure
<br>constant gas pressure 
<br># the observed microturbulence 
<br>turbulence 8 km/sec
<br># we have a spherical geometry but want to simulate observing
<br># through a spectrometer's slit.  use the aperture
<br># command for this
<br>aperture beam 
<br>#
<br># commands controlling output    =========
<br>normalize to "CaBo" 4861.32A
<br>print line faint -4
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save performance "orion_hii_pdr_fast.per"
<br>save overview last "orion_hii_pdr_fast.ovr"
<br>save heating "orion_hii_pdr_fast.het"
<br>save cooling "orion_hii_pdr_fast.col"
<br>save dr last "orion_hii_pdr_fast.dr"
<br>save results last "orion_hii_pdr_fast.rlt"
<br>save continuum last "orion_hii_pdr_fast.con" units microns
<br>save ionizing continuum last "orion_hii_pdr_fast.ion"
<br>save hydrogen 21 cm last "orion_hii_pdr_fast.21cm"
<br>save hydrogen lya last "orion_hii_pdr_fast.lya" 
<br>save element silicon last "orion_hii_pdr_fast.sil" 
<br>save element sulphur last "orion_hii_pdr_fast.sul" 
<br>#
<br>#
<br># orion_hii_pdr_fast.in
<br># class hii pdr 
<br># ========================================
<br># 
</kbd><p>
Orion HII region and PDR, simialr to orion_hii_pdr but
much faster because of fast.ini
<p>
</p><hr><kbd><h2>pdr_co_fully.in</h2>  </kbd><h2><I>H2 and CO in fully molecular limit 
</I></h2><kbd><br>title H2 and CO in fully molecular limit 
<br># this is a pair with pdr_co_fully_noneq - that tests non equilibrium chem
<br>#
<br># commands controlling continuum =========
<br>blackbody 5000
<br>luminosity total solar linear 2
<br>brems 6
<br>luminosity total solar log -2.7
<br># 
<br># commands for density & abundances =========
<br># set the density and composition, ism with grains
<br>hden 10
<br>abundances ism no qheat
<br>#
<br># other commands for details     =========
<br># this is an important ionization source
<br>cosmic ray background 
<br># code will stop at 4000 K by default, lower this temp so we
<br># can do fully molecular gas 
<br>stop temperature 10K linear
<br>#
<br># commands controlling geometry  =========
<br># the radius and thickness
<br>radius 15.8 
<br>stop thickness 6
<br>turbulence 3 km / s
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_co_fully.per"
<br>save overview "pdr_co_fully.ovr"
<br>save molecules "pdr_co_fully.mol"
<br>save dr "pdr_co_fully.dr"
<br>save heating "pdr_co_fully.het"
<br>save cooling "pdr_co_fully.col"
<br>save grain charge "pdr_co_fully.grnchr"
<br>save grain drift "pdr_co_fully.grndft"
<br>save grain temperature "pdr_co_fully.grntem"
<br>save ionization means "pdr_co_fully.ion"
<br>#
<br># 
<br># gas has more he++ than He+ due to fast charge transfer with co
<br># neutralizing he+ 
<br># pdr_co_fully.in
<br># class pdr 
<br># ========================================
</kbd><p>
test code in fully molecular limit
this is a pair with pdr_co_fully_noneq - that tests non equilibrium chem
<p>
</p><hr><kbd><h2>pdr_co_fully_noneq.in</h2>  </kbd><h2><I>H2 and CO are fully molecular, non-equilibrium case
</I></h2><kbd><br>title H2 and CO are fully molecular, non-equilibrium case
<br># this is a pair with pdr_co_fully.in, which does not include non-equil chem
<br>#
<br># commands controlling continuum =========
<br>blackbody 5000
<br>luminosity total solar linear 2
<br>brems 6
<br>luminosity total solar log -2.7
<br># 
<br># commands for density & abundances =========
<br># set the density and composition, ism with grains
<br>hden 10
<br>abundances ism no qheat
<br>#
<br># other commands for details     =========
<br># this is an important ionization source
<br>cosmic ray background 
<br># code will stop at 4000 K by default, lower this temp so we
<br># can do fully molecular gas 
<br>stop temperature 10K linear
<br>#
<br># commands controlling geometry  =========
<br># the radius and thickness
<br>radius 15.8 
<br>stop thickness 6
<br>turbulence 3 km / s
<br># this turns on non-equilibrium chemistry as suggested by Federman et al. 1996
<br>set chemistry non equilibrium 
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_co_fully_noneq.per"
<br>save overview "pdr_co_fully_noneq.ovr"
<br>save molecules "pdr_co_fully_noneq.mol"
<br>save dr "pdr_co_fully_noneq.dr"
<br>save heating "pdr_co_fully_noneq.het"
<br>save cooling "pdr_co_fully_noneq.col"
<br>save grain charge "pdr_co_fully_noneq.grnchr"
<br>save grain drift "pdr_co_fully_noneq.grndft"
<br>save grain temperature "pdr_co_fully_noneq.grntem"
<br>#
<br># 
<br># gas has more he++ than He+ due to fast charge transfer with co
<br># neutralizing he+ 
<br># pdr_co_fully_noneq.in
<br># class pdr 
<br># ========================================
</kbd><p>
test code in fully molecular limit with Federman non-equilibrium chem
this is a pair with pdr_co_fully.in, which does not include non-equil chem
<p>
</p><hr><kbd><h2>pdr_coolbb.in</h2>  </kbd><h2><I>illumination by cool STE blackbody
</I></h2><kbd><br>title illumination by cool STE blackbody
<br># gasis fully molecular, grains should be in STE
<br>#
<br># commands controlling continuum =========
<br># illuminate with 120 blackbody in thermodynamic equilibrium
<br>blackbody 120 STE
<br>CMB  
<br># 
<br># commands for density & abundances =========
<br># density
<br>hden 7
<br># ism dust and grains
<br>abundances ISM no grains
<br># dust to gas ratio is 10x standard
<br>grains 1.0
<br># lowers metals and grains to 1/10 standard, so metals are
<br># 1/10 solar while dust to gas ratio is galactic
<br>metals and grains 0.1
<br>#
<br># other commands for details     =========
<br># CO heating sets dr on second iteration, need many zones
<br>set nend 1600
<br># set background cosmic rays to allow chemistry 
<br>cosmic ray background
<br># we need iterate to convergence here, but that doesn't work for now... 
<br>iterate convergence
<br>#
<br># commands controlling geometry  =========
<br>radius 17.5
<br>sphere
<br>stop temperature 20K linear 
<br>stop column density 25.5
<br># double optical depths in PDR sims, to account for unmodelled
<br># molecular cloud behind the PDR
<br>double
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_coolbb.per"
<br>save overview "pdr_coolbb.ovr"
<br>save heating "pdr_coolbb.het"
<br>save cooling "pdr_coolbb.col"
<br>save dr "pdr_coolbb.dr"
<br>save grain temperature "pdr_coolbb.grntem"
<br>save convergence reason "pdr_coolbb.cvr"
<br>save lines emissivity "pdr_coolbb.ems"
<br>H2O  212.468m
<br>H2O  160.466m
<br>CO   325.137m
<br>CO   144.745m
<br>CO   118.548m
<br>CN   880.858m
<br>end
<br>#
<br>#
<br># pdr_coolbb.in
<br># class pdr 
<br># ========================================
</kbd><p>
This is a dense ISM exposed to a cool blackbody.  This tests the
ability to converge onto a VERY molecular environment.  Nearly all
C and H are in CO and H2.  Cosmic rays are the main source of
heat and ionization.
<p>
Continuum pumping of CO followed by collisional deexcitation is a
major heating agent across the sim.
</p><hr><kbd><h2>pdr_dense_persei.in</h2>  </kbd><h2><I>dense phase zeta persei cloud
</I></h2><kbd><br>title dense phase zeta persei cloud
<br>#
<br># density and abundances ==========
<br># density of dense phase from Table 2 of Le Petit paper ========
<br>hden 4.3
<br># 
<br># abundandces from Table 1 of Le Petit paper ==========
<br>element carbon abundance 0.000132 linear
<br>element helium abundance 0.10 linear
<br>element oxygen abundance 0.00032 linear
<br>element nitrogen abundance 0.000075 linear
<br>element sulphur abundance 0.0000186 linear
<br>element silicon abundance 0.000029 linear
<br># set abundance of all other elements to zero ====================
<br>element copper off
<br>element magnesium off
<br>element manganese off
<br>element sodium off
<br>element chlorine off
<br>element vanadium off
<br>element potassium off
<br>element phosphorous off
<br>element calcium off
<br>element iron off
<br>element zinc off
<br>element neon off
<br>element argon off
<br>element fluorine off
<br>element aluminum off
<br>element boron off
<br>element lithium off
<br>element beryllium off
<br>element scandium off
<br>element nickel off
<br>element titanium off
<br>element chromium off
<br>element cobalt off
<br># do not use Federman rates for this model ==============
<br>set federman chemistry off
<br># use standard ism grain size distribution ============
<br>grains ism 
<br># 
<br># command controlling the continuum, for this model is Draine 1978 field ====
<br>table draine 0.5 linear
<br># make sure no H-ioinizing radiation strikes the cloud
<br>extinguish 24 
<br># 
<br># fix the temperature to 20 K =============
<br>constant temperature 20
<br># stop at a radius of 4.3e-4 parsecs ============ 
<br>stop thickness 0.00043 parsecs linear
<br># Le Petit model does not consider ices, so turn this off ============
<br>no grain molecules
<br># turn on cosmic rays =========
<br>cosmic rays background
<br># Set cosmic ray ionization rate to Table 2 of Le Petit paper ========
<br>set csupra -15.6
<br># Allow calculation to go extend into cold environment ============
<br>stop temperature linear 3
<br># 
<br># commands controlling output ============
<br>save performance "pdr_dense_persei.per"
<br>save overview "pdr_dense_persei.ovr"
<br>save dr "pdr_dense_persei.dr"
<br>save molecules "pdr_dense_persei.mol"
<br>save heating "pdr_dense_persei.het"
<br>save cooling "pdr_dense_persei.col"
<br># 
<br># pdr_dense_persei.in
<br># class pdr
<br># ====================================
</kbd><p>
This is the dense phase model presented by LePetit, Roueff, and Herbst 
in order to reproduce C2 and C3 column densities observed along the line
of sight to zera persei.  This is our attempt at reproducing their calculation.
This is the dense molecular phase, not the phase that produces H3+ 
<p>
# >>refer	model	pdr	Le Petit, F., Roueff, E., & Herbst, E. 2004,
# >>refercon	A&A, 417, 993
<p>
If you do a thermal equilibrium calculation by removing the constant temperature
command the kinetic temperature will be about three times larger than
assumed in their paper.
</p><hr><kbd><h2>pdr_HTT91.in</h2>  </kbd><h2><I>low-density PDR from HTT91
</I></h2><kbd><br>title low-density PDR from HTT91
<br># >>refer	test	model Hollenbach, D., Takahashi, T., &
<br># >>refcon	Tielens, A.G.G.M., 1991, ApJ,377, 192-209
<br>#
<br># commands controlling continuum =========
<br># first continuum is FIR hot grain continuum produced in 
<br># unmodeled HII Region
<br># this is hot star continuum
<br>black 30000
<br>intensity  0.2 range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br>cosmic rays, background
<br>#
<br># commands for density & abundances =========
<br>hden 3
<br>init file="ism.ini"
<br>abundances he= -1.01 c= -3.52 n=-8 o=-3.30 ne=-8 mg=-5.89
<br>continue si= -6.10 s= -5.10 cl=-7 ar=-8 fe= -6.60
<br>grains orion, abundance log 0.16 no qheat 
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br># stop when gas is fully neutral
<br>stop efrac -10
<br># this is to stop at an intended place, since results would be
<br># very dependent on details if we stop on temperature
<br>stop thickness 18.954
<br># stop when gas is cold
<br>stop temperature 10 linear
<br># add this to mimic unmodelled neutral gas
<br>double optical depths
<br>#
<br># other commands for details     =========
<br>iterate  2
<br>Database H-like Lyman pumping off
<br>turbulence 1.5 km/sec
<br># 
<br># commands controlling output    =========
<br>normalize to 157.636m "C  2" 
<br># uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>save performance "pdr_HTT91.per"
<br>save overview last "pdr_HTT91.ovr"
<br>save dr "pdr_HTT91.dr"
<br>save molecules last "pdr_HTT91.mol"
<br>save results last "pdr_HTT91.rlt"
<br>save continuum units microns last "pdr_HTT91.con"
<br>save heating last "pdr_HTT91.het"
<br>save cooling last "pdr_HTT91.col"
<br>#
<br># pdr_HTT91.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is the Hollenbach et al 1991 Low-density PDR
The Database H-like Lyman pumping off command appears because the Lyman lines are
vastly optically thick in this environment. 
If the command is removed the Lyman lines will be optically thin,
which will result in fast fluorescent excitation of the
(nearly totally neutral) hydrogen atom.  
<p>
there is very little CO in this model since it is not thick enough
for the UV pumping lines to become optically thick
</p><hr><kbd><h2>pdr_leiden_f1.in</h2>  </kbd><h2><I>Leiden meeting model 1
</I></h2><kbd><br>title Leiden meeting model 1
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>#  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br># use leiden initialization file
<br>init file="pdr_leiden.ini"
<br># This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br># This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#
<br># commands controlling output    =========
<br>print line optical depths 
<br>save performance "pdr_leiden_f1.per"
<br>save overview "pdr_leiden_f1.ovr"
<br>save continuum "pdr_leiden_f1.con"
<br>save leiden lines "pdr_leiden_f1.lin"
<br>save leiden "pdr_leiden_f1.lei"
<br>save dr "pdr_leiden_f1.dr" 
<br>save molecules "pdr_leiden_f1.mol"
<br>save grain physical conditions "pdr_leiden_f1.grn"
<br>save chemistry rates "pdr_leiden_f1.COr" "CO"
<br>save chemistry rates "pdr_leiden_f1.H2r" "H2"
<br>save chemistry rates "pdr_leiden_f1.H2a" "H2" all
<br>save chemistry rates "pdr_leiden_f1.H2ds" "H2" destruction
<br>save chemistry rates "pdr_leiden_f1.H2cr" "H2" creation
<br>save chemistry rates "pdr_leiden_f1.H2ca" "H2" catalytic 
<br>save secondaries "pdr_leiden_f1.sec"
<br>save species column densities "pdr_leiden_f1.col" all
<br>#
<br># 
<br>#
<br># pdr_leiden_f1.in
<br># class pdr  
<br># ========================================
<br># 
</kbd><p>
<p>
This sim has some interesting properties.  The grain temp is so low that
O freezes onto grains as H2O.  This is so efficient that CO does not become
well formed - the CO/C ratio only reaches 0.3.
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><kbd><h2>pdr_leiden_f2.in</h2>  </kbd><h2><I>Leiden meeting model 2
</I></h2><kbd><br>title Leiden meeting model 2
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use
<br># half the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 3.
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>#  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>#  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_f2.per"
<br>save overview "pdr_leiden_f2.ovr"
<br>save continuum "pdr_leiden_f2.con"
<br>save molecules "pdr_leiden_f2.mol"
<br>save chemistry rates "pdr_leiden_f2.rat" "SiO"
<br>save leiden lines "pdr_leiden_f2.lin"
<br>save leiden "pdr_leiden_f2.lei"
<br>save dr "pdr_leiden_f2.dr" 
<br>save grain physical conditions "pdr_leiden_f2.grn"
<br>#
<br># 
<br># pdr_leiden_f2.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
# This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><kbd><h2>pdr_leiden_f3.in</h2>  </kbd><h2><I>Leiden meeting model 3
</I></h2><kbd><br>title Leiden meeting model 3
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 5.5
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>#  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>#  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_f3.per"
<br>save overview "pdr_leiden_f3.ovr"
<br>save continuum "pdr_leiden_f3.con"
<br>save leiden lines "pdr_leiden_f3.lin"
<br>save leiden "pdr_leiden_f3.lei"
<br>save dr "pdr_leiden_f3.dr" 
<br>save grain physical conditions "pdr_leiden_f3.grn"
<br>#
<br># 
<br># pdr_leiden_f3.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
# This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><kbd><h2>pdr_leiden_f4.in</h2>  </kbd><h2><I>Leiden meeting model 4
</I></h2><kbd><br>title Leiden meeting model 4
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br>#
<br># commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>#
<br># commands controlling geometry  =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>#  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>#  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#  hydrogen density 
<br>hden 5.5
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_f4.per"
<br>save overview "pdr_leiden_f4.ovr"
<br>save continuum "pdr_leiden_f4.con"
<br>save leiden lines "pdr_leiden_f4.lin"
<br>save leiden "pdr_leiden_f4.lei"
<br>save dr "pdr_leiden_f4.dr" 
<br>save grain physical conditions "pdr_leiden_f4.grn"
<br>#
<br># 
<br># pdr_leiden_f4.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
# This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><kbd><h2>pdr_leiden_hack_f1.in</h2>  </kbd><h2><I>Leiden meeting model 1 with hacks
</I></h2><kbd><br>title Leiden meeting model 1 with hacks
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>#  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br># use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br># This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br># This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_hack_f1.per"
<br>save leiden lines "pdr_leiden_hack_f1.lin"
<br>save leiden "pdr_leiden_hack_f1.lei"
<br>save dr "pdr_leiden_hack_f1.dr" 
<br>save grain physical conditions "pdr_leiden_hack_f1.grn"
<br>save overview "pdr_leiden_hack_f1.ovr"
<br>#
<br>#
<br>#
<br># class pdr  
<br># ========================================
<br># 
</kbd><p>
# This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
this includes hacks to get "standard answer" 
</p><hr><kbd><h2>pdr_leiden_hack_f2.in</h2>  </kbd><h2><I>Leiden meeting model 2 with hacks
</I></h2><kbd><br>title Leiden meeting model 2 with hacks
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use
<br># half the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 3.
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>#  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>#  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_hack_f2.per"
<br>save leiden lines "pdr_leiden_hack_f2.lin"
<br>save leiden "pdr_leiden_hack_f2.lei"
<br>save dr "pdr_leiden_hack_f2.dr" 
<br>save grain physical conditions "pdr_leiden_hack_f2.grn"
<br>save overview "pdr_leiden_hack_f2.ovr"
<br>#
<br># 
<br># pdr_leiden_hack_f2.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
# This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer.
</p><hr><kbd><h2>pdr_leiden_hack_f3.in</h2>  </kbd><h2><I>Leiden meeting model 3 with hacks
</I></h2><kbd><br>title Leiden meeting model 3 with hacks
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 5.5
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>#  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>#  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_hack_f3.per"
<br>save leiden lines "pdr_leiden_hack_f3.lin"
<br>save overview "pdr_leiden_hack_f3.ovr"
<br>save leiden "pdr_leiden_hack_f3.lei"
<br>save dr "pdr_leiden_hack_f3.dr" 
<br>save grain physical conditions "pdr_leiden_hack_f3.grn"
<br>#
<br># 
<br># pdr_leiden_hack_f3.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
# This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
include hacks to get standard answer.
</p><hr><kbd><h2>pdr_leiden_hack_f4.in</h2>  </kbd><h2><I>Leiden meeting model 4 with hacks
</I></h2><kbd><br>title Leiden meeting model 4 with hacks
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br>#
<br># commands for density & abundances =========
<br>grains ism 1.16 no qheat
<br>#
<br># commands controlling geometry  =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>#  This command defines the grain temperature to be a constant 20 Kelvin
<br>constant grain temperature 20 
<br>#  This sets the temperature to a constant 50 Kelvin
<br>constant temperature 50 linear
<br>#  hydrogen density 
<br>hden 5.5
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_hack_f4.per"
<br>save leiden lines "pdr_leiden_hack_f4.lin"
<br>save leiden "pdr_leiden_hack_f4.lei"
<br>save dr "pdr_leiden_hack_f4.dr" 
<br>save grain physical conditions "pdr_leiden_hack_f4.grn"
<br>save overview "pdr_leiden_hack_f4.ovr"
<br>#
<br># 
<br># pdr_leiden_hack_f4.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks needed to get standard answer.
</p><hr><kbd><h2>pdr_leiden_hack_v1.in</h2>  </kbd><h2><I>Leiden meeting model 5 with hacks
</I></h2><kbd><br>title Leiden meeting model 5 with hacks
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># is half the requested value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>#  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>#  Define the abundance of PAHs so we can reproduce the same photoelectric
<br># heating curve as BT94 
<br>#  We have also scaled the grain abundance to achieve the desired AV/NH ratio 
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_hack_v1.per"
<br>save leiden lines "pdr_leiden_hack_v1.lin"
<br>save leiden "pdr_leiden_hack_v1.lei"
<br>save dr "pdr_leiden_hack_v1.dr" 
<br>save grain temperature "pdr_leiden_hack_v1.grn"
<br>save overview "pdr_leiden_hack_v1.ovr"
<br>#
<br>#
<br># pdr_leiden_hack_v1.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer.
</p><hr><kbd><h2>pdr_leiden_hack_v2.in</h2>  </kbd><h2><I>Leiden meeting model 6 with hacks
</I></h2><kbd><br>title Leiden meeting model 6 with hacks
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>#  Define the abundance of PAHs so we can reproduce the same photoelectric
<br># heating curve as BT94 
<br>#  We have also scaled the grain abundance to achieve the desired AV/NH ratio 
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 3.
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>#  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_hack_v2.per"
<br>save leiden lines "pdr_leiden_hack_v2.lin"
<br>save leiden "pdr_leiden_hack_v2.lei"
<br>save dr "pdr_leiden_hack_v2.dr" 
<br>save grain temperature "pdr_leiden_hack_v2.grn"
<br>save overview "pdr_leiden_hack_v2.ovr"
<br>save heating "pdr_leiden_hack_v2.het"
<br>save cooling "pdr_leiden_hack_v2.col"
<br>save h2 rates "pdr_leiden_hack_v2.h2rat"
<br>#
<br>#
<br># pdr_leiden_hack_v2.in
<br># class pdr  
<br># ========================================
<br># 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer.
</p><hr><kbd><h2>pdr_leiden_hack_v3.in</h2>  </kbd><h2><I>Leiden meeting model 7 with hacks
</I></h2><kbd><br>title Leiden meeting model 7 with hacks
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>#  Define the abundance of PAHs so we can reproduce the same photoelectric
<br># heating curve as BT94 
<br>#  We have also scaled the grain abundance to achieve the desired AV/NH ratio 
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 5.5
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br># this sim has more than one thermal solution - force into lowest one,
<br># the one found by the rest of the group - without this we will find a
<br># soln at 1400 K
<br>force temperature to 60K
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_hack_v3.per"
<br>save leiden lines "pdr_leiden_hack_v3.lin"
<br>save leiden "pdr_leiden_hack_v3.lei"
<br>save dr "pdr_leiden_hack_v3.dr" 
<br>save grain temperature "pdr_leiden_hack_v3.grn"
<br>save overview "pdr_leiden_hack_v3.ovr"
<br>save heating "pdr_leiden_hack_v3.het"
<br>save cooling "pdr_leiden_hack_v3.col"
<br>#
<br># 
<br># pdr_leiden_hack_v3.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer
</p><hr><kbd><h2>pdr_leiden_hack_v4.in</h2>  </kbd><h2><I>Leiden meeting model 8 with hacks
</I></h2><kbd><br>title Leiden meeting model 8 with hacks
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24 
<br>#
<br># commands for density & abundances =========
<br>#  Define the abundance of PAHs so we can reproduce the same photoelectric
<br># heating curve as BT94 
<br>#  We have also scaled the grain abundance to achieve the desired AV/NH ratio 
<br>grains ism 1.16 no qheat
<br>set PAH Bakes 
<br>#  hydrogen density 
<br>hden 5.5
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>#  use leiden initialization file
<br>init file="pdr_leiden_hack.ini"
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_hack_v4.per"
<br>save leiden lines "pdr_leiden_hack_v4.lin"
<br>save leiden "pdr_leiden_hack_v4.lei"
<br>save dr "pdr_leiden_hack_v4.dr" 
<br>save grain temperature  "pdr_leiden_hack_v4.grn"
<br>save overview "pdr_leiden_hack_v4.ovr"
<br>save heating "pdr_leiden_hack_v4.het"
<br>save cooling "pdr_leiden_hack_v4.col"
<br>save transmitted continuum "pdr_leiden_hack_v4.con"
<br>#
<br>#
<br># pdr_leiden_hack_v4.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
includes hacks to get standard answer. 
</p><hr><kbd><h2>pdr_leiden_v1.in</h2>  </kbd><h2><I>Leiden meeting model 5
</I></h2><kbd><br>title Leiden meeting model 5
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># is half the requested value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>#  hydrogen density 
<br>hden 3.
<br>grains ism 1.16 no qheat
<br>#  add PAHs 
<br>grains PAH no qheat 3 function
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_v1.per"
<br>save overview "pdr_leiden_v1.ovr"
<br>save leiden lines "pdr_leiden_v1.lin"
<br>save leiden "pdr_leiden_v1.lei"
<br>save dr "pdr_leiden_v1.dr" 
<br>save grain temperature "pdr_leiden_v1.grn"
<br>#
<br># 
<br>#
<br># pdr_leiden_v1.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><kbd><h2>pdr_leiden_v2.in</h2>  </kbd><h2><I>Leiden meeting model 6
</I></h2><kbd><br>title Leiden meeting model 6
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br># add PAHs and grains
<br>grains PAH no qheat 3 function
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 3.
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_v2.per"
<br>save overview "pdr_leiden_v2.ovr"
<br>save leiden lines "pdr_leiden_v2.lin"
<br>save leiden "pdr_leiden_v2.lei"
<br>save dr "pdr_leiden_v2.dr" 
<br>save grain temperature "pdr_leiden_v2.grn"
<br>#
<br>#
<br># pdr_leiden_v2.in
<br># class pdr  
<br># ========================================
<br># 
</kbd><p>
# This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
</p><hr><kbd><h2>pdr_leiden_v3.in</h2>  </kbd><h2><I>Leiden meeting model 7
</I></h2><kbd><br>title Leiden meeting model 7
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 5
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br># add PAHs and grains
<br>grains PAH no qheat 3 function
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 5.5
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br>failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_v3.per"
<br>save overview "pdr_leiden_v3.ovr"
<br>save leiden lines "pdr_leiden_v3.lin"
<br>save leiden "pdr_leiden_v3.lei"
<br>save dr "pdr_leiden_v3.dr" 
<br>save grain temperature "pdr_leiden_v3.grn"
<br>save heating "pdr_leiden_v3.het"
<br>save cooling "pdr_leiden_v3.col"
<br>#
<br># 
<br># pdr_leiden_v3.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
</p><hr><kbd><h2>pdr_leiden_v4.in</h2>  </kbd><h2><I>Leiden meeting model 8
</I></h2><kbd><br>title Leiden meeting model 8
<br># This is one of the tests in Rollig et al. 2007, A&A, 467, 187 
<br>#
<br># commands controlling continuum =========
<br># Use the Draine 1978 field, for a semi-infinite slab we have to use half
<br># the requested value, so the actual value
<br># they want for the model is actually twice the value below
<br>table draine 50000
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>grains PAH no qheat 3 function
<br>grains ism 1.16 no qheat
<br>#  hydrogen density 
<br>hden 5.5
<br>#
<br># commands controlling geometry  =========
<br>#
<br># other commands for details     =========
<br># failures 3
<br>#  use leiden initialization file
<br>init file="pdr_leiden.ini"
<br>#
<br># commands controlling output    =========
<br>save performance "pdr_leiden_v4.per"
<br>save overview "pdr_leiden_v4.ovr"
<br>save leiden lines "pdr_leiden_v4.lin"
<br>save leiden "pdr_leiden_v4.lei"
<br>save dr "pdr_leiden_v4.dr" 
<br>save grain temperature  "pdr_leiden_v4.grn"
<br>save transmitted continuum "pdr_leiden_v4.con"
<br>save heating "pdr_leiden_v4.het"
<br>save cooling "pdr_leiden_v4.col"
<br>#
<br>#
<br># pdr_leiden_v4.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
</p><hr><kbd><h2>pdr_minimal.in</h2>  </kbd><h2><I>test physical conditions at the illuminated face of a PDR
</I></h2><kbd><br>title test physical conditions at the illuminated face of a PDR
<br>#
<br># commands controlling continuum =========
<br>table draine 50000
<br>extinguish 24
<br>#
<br># commands for density & abundances =========
<br>hden 5.5
<br>element helium abundance -1.00  
<br>element lithium     off  
<br>element beryllium   off 
<br>element boron       off
<br>element carbon      off
<br>element oxygen      off
<br>element fluorine    off 
<br>element neon        off  
<br>element sodium      off  
<br>element magnesium   off  
<br>element aluminum    off  
<br>element silicon     off
<br>element phosphorus  off 
<br>element sulphur     off
<br>element chlorine    off  
<br>element argon       off  
<br>element potassium   off 
<br>element calcium     off 
<br>element scandium    off  
<br>element titanium    off  
<br>element vanadium    off  
<br>element chromium    off  
<br>element manganese   off  
<br>element iron        off
<br>element cobalt      off 
<br>element nickel      off  
<br>element copper      off  
<br>element zinc        off
<br>#
<br># other commands for details     =========
<br>constant temperature 50 linear
<br>set dr 1
<br>stop zone 2
<br>stop temperature off
<br>#
<br># commands controlling output    =========
<br>set save prefix "pdr_minimal"
<br>save performance ".per" last
<br>save overview ".ovr" last
<br>save molecules ".mol" last
<br>save leiden ".lei" last
<br>save leiden lines ".lin" last
<br>#
<br>#
<br># IF EITHER OF THESE MONITORS NEEDS TO BE ADJUSTED, CHECK THAT THE IONIZATION
<br># CONDITIONS IN ZONE 1 AND 2 ARE IN VERY GOOD AGREEMENT!
<br>#
<br># pdr_minimal.in
<br># class pdr
<br># ========================================
</kbd><p>
This model is derived from the F4 model from the Leiden workshop (Roellig et
al. 2007, A&A, 467, 187). It has been reduced to a two-zone model in order to
test the ionization conditions at the face of the PDR. Older versions of the
code had a bug where the ionization in zone 1 was many dex lower than in zone
2. The conditions in zone 1 were wrong and should have been similar to the
conditions in zone 2. Here we test that the code doesn't regress. See also
ticket #358: https://wiki.nublado.org/ticket/358
<p>
The ionization in this sim is produced by continuum pumping of the metastable
levels of N I, followed by photoionization out of the metastable levels of N I.
See Ferland et al., 2012, ApJ, 757, 79. So this pumping and ionization mechanism
is also tested by this sim.
</p><hr><kbd><h2>pdr_orion_veil.in</h2>  </kbd><h2><I>Orion's veil
</I></h2><kbd><br>title Orion's veil
<br>#
<br># commands controlling continuum =========
<br>q(h) 50.000000 
<br>table SED "Rubin.sed"  
<br># AGN & CMB background
<br>background z=0   
<br>cosmic rays background 
<br># as a test this was tried - atomic temperature raised fm 100 to 140
<br># but nothing really wrong
<br># the observed magnetic field, roughly 100 micro Gauss
<br>magnetic field -4 
<br>#
<br># commands for density & abundances =========
<br>hden 3.1
<br>init "ism.ini"
<br>element calcium on 
<br>abundances orion no grains  
<br>grains orion no qheat 
<br>element magnesium isotopes (24, 3) (25, 1) (26, 1)
<br>#
<br># commands controlling geometry  =========
<br>stop neutral hydrogen column density 21.6  
<br>radius 19.1
<br>stop temperature linear 5  
<br># this will not be hit, but put it in to insure that we stop if
<br># gas becomes totally molecular
<br>stop av 10 
<br>#
<br># other commands for details     =========
<br>failures 3
<br>turbulence 0.5 km/sec 
<br>sphere  
<br># c this simulates Lyman lines in the stellar continuum
<br># atom h-like lyman pumping off 
<br>#
<br># commands controlling output    =========
<br>print line optical depths
<br>save overview "pdr_orion_veil.ovr"
<br>save performance "pdr_orion_veil.per"
<br>save PDR "pdr_orion_veil.pdr"
<br>save species column densities "pdr_orion_veil.fe2col" "Fe+"
<br>save hydrogen 21 cm "pdr_orion_veil.21cm"
<br>save molecules "pdr_orion_veil.mol"
<br>save overveiw "pdr_orion_veil.ovr"
<br>save species column densities "pdr_orion_veil.cden" all
<br>save heating "pdr_orion_veil.het"
<br>save cooling "pdr_orion_veil.col"
<br>save dr "pdr_orion_veil.dr"
<br>save H2 rates "pdr_orion_veil.h2rat"
<br>save pressure "pdr_orion_veil.pre"
<br>save wind "pdr_orion_veil.wnd"
<br>save continuum units microns "pdr_orion_veil.con" last 
<br>#
<br># pdr_orion_veil.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is Abel et al 2004 model of Orion's veil, the layer of gas in front
of the Orion Nebula.  
>>refer	Orion	Veil	Abel, N. P., Brogan, C. L.,  Ferland, G. J., 
>>refercon	O'Dell, C. R., Shaw, G., & Troland, T. H. 2004
<p>
</p><hr><kbd><h2>pdr_th85ism.in</h2>  </kbd><h2><I>TH85 PDR with ISM grains
</I></h2><kbd><br>title TH85 PDR with ISM grains
<br>#
<br># commands controlling continuum =========
<br># cosmic radiation background
<br>background z=0
<br># cosmic ray background ionization and heating 
<br>cosmic rays, background
<br># first continuum is FIR hot grain continuum produced in 
<br># unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity 2.7 (total)
<br># this is the attenuated hot stellar continuum
<br>black 30000
<br>intensity  2.204 range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br>#
<br># commands controlling geometry  =========
<br># simulate effects of gas we do not model
<br>double
<br># their turbulence
<br>turbulence 2.7 km/sec
<br># stopping criteria
<br># this should be the one actually used
<br>stop AV 33.2 extended 
<br># stop when gas is fully neutral
<br>stop efrac -10
<br># stop when gas is cold
<br>stop temperature 10 linear
<br># stop at thickness of 16.5 so that mole limit does not
<br># stop this calculation - that would make results very
<br># detail dependent
<br>stop thickness 19
<br>#
<br># commands for density & abundances =========
<br>hden 5.362
<br># this turns off some elements, and processes we don't need
<br># so needs to come before the elements 
<br>init file="ism.ini"
<br>abundances he= -1.01 c= -3.52 n=-8 o=-3.30 ne=-8 mg=-5.89
<br>continue si= -6.10 s= -5.10 cl=-7 ar=-8 fe= -6.60
<br># use ism abundances but turn of quantum heating 
<br>grains ism, abundance log 0.16 no qheat 
<br>#
<br># other commands for details     =========
<br># must iterate since many FIR MIR lines are optically thick
<br>iterate 
<br># this is a closed geometry, in Orion, veil covers 2pi sr
<br>sphere
<br># make Lyman lines very optically thick, which stops pumping by
<br># Balmer continuum
<br>Database H-like Lyman pumping off
<br># this should run cleanly - turn down number of allow conv fails
<br>failures 3 
<br>#
<br># commands controlling output    =========
<br>normalize to "c  2" 157.636m 
<br># want the spectrum to be relative to this [C II] line
<br># uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>save performance "pdr_th85ism.per"
<br>save overview last "pdr_th85ism.ovr"
<br>save pdr last "pdr_th85ism.pdr"
<br>save molecules last "pdr_th85ism.mol"
<br>save dr last "pdr_th85ism.dr"
<br>save hydrogen physical conditions last "pdr_th85ism.hyd" 
<br>save results last "pdr_th85ism.rlt"
<br>save continuum units microns last "pdr_th85ism.con"
<br>save heating last "pdr_th85ism.het"
<br>save cooling last "pdr_th85ism.col"
<br>save hydrogen 21 cm last "pdr_th85ism.21cm"
<br>save element magnesium last "pdr_th85ism.mag"
<br>save species levels "pdr_th85ism.lev" all
<br>save species densities "pdr_th85ism.popCp" "C+[:]"
<br>save species column density "pdr_th85ism.pop" "CO[:]"
<br>save species densities "pdr_th85ism.poplist"
<br>"*AV"
<br>"*temp"
<br>"e-"
<br>C+
<br>"C+[1:3]"
<br>"CO[1]"
<br>"CO[2]"
<br>"H[1]"
<br>"H[2]"
<br>"He[1]"
<br>"He[2]"
<br>"He+[1]"
<br>"He+[2]"
<br>end of species
<br>save grain extinction last  "pdr_th85ism.grnext"
<br>save grain potential last   "pdr_th85ism.grnpot"
<br>save grain temperature last "pdr_th85ism.grntem"
<br>save grain charge last "pdr_th85ism.grnchr"
<br>#
<br># pdr_th85ism.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is the Tielens and Hollenbach (1985a, b) standard model of
the Orion photodissociation region (PDR).  Specifically,
this is my attempt at their Table 2 of paper 2, ApJ 291,  p749.
The Database H-like Lyman pumping off command appears because the Lyman lines are
vastly optically thick in this environment. 
If the command is removed the Lyman lines will be optically thin,
which will result in fast fluorescent excitation of the
(nearly totally neutral) hydrogen atom.
<p>
# >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985a, ApJ, 291, 722
# >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985b, ApJ, 291, 746
  
</p><hr><kbd><h2>pdr_th85ism_cgto.in</h2>  </kbd><h2><I>TH85 pdr with ISM grains and C > O
</I></h2><kbd><br>title TH85 pdr with ISM grains and C > O
<br>#
<br># commands controlling continuum =========
<br># cosmic radiation background
<br>background z=0
<br># cosmic ray background ionization and heating 
<br>cosmic rays, background
<br># first continuum is FIR hot grain continuum produced in 
<br># unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity 2.7 (total)
<br># this is the attenuated hot stellar continuum
<br>black 30000
<br>intensity  2.204 range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br>#
<br># commands controlling geometry  =========
<br># simulate effects of gas we do not model
<br>double
<br># their turbulence
<br>turbulence 2.7 km/sec
<br># stopping criteria
<br># this should be the one actually used
<br>stop AV 33.2 extended 
<br># stop when gas is fully neutral
<br>stop efrac -10
<br># stop when gas is cold
<br>stop temperature 10 linear
<br># stop at thickness of 16.5 so that mole limit does not
<br># stop this calculation - that would make results very
<br># detail dependent
<br>stop thickness 19
<br>#
<br># commands for density & abundances =========
<br>hden 5.362
<br># this turns off some elements, and processes we don't need
<br># so needs to come before the elements 
<br>init file="ism.ini"
<br># this is the TH85 mix except C is raised by 0.2 dex,
<br># and O lowered byt his amount, so that C/O > 1
<br>abundances he= -1.01 c= -3.4 n=-8 o=-3.50 ne=-8 mg=-5.89
<br>continue si= -6.10 s= -5.10 cl=-7 ar=-8 fe= -6.60
<br># use ism abundances but turn of quantum heating 
<br>grains ism, abundance log 0.16 no qheat 
<br>#
<br># other commands for details     =========
<br># must iterate since many FIR MIR lines are optically thick
<br>iterate 
<br># this is a closed geometry, in Orion, veil covers 2pi sr
<br>sphere
<br># make Lyman lines very optically thick, which stops pumping by
<br># Balmer continuum
<br>Database H-like Lyman pumping off
<br># this should run cleanly - turn down number of allow conv fails
<br>failures 3 
<br>#
<br># commands controlling output    =========
<br>normalize to "c  2" 157.636m 
<br># want the spectrum to be relative to this [C II] line
<br># uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>save performance "pdr_th85ism_cgto.per"
<br>save overview last "pdr_th85ism_cgto.ovr"
<br>save pdr last "pdr_th85ism_cgto.pdr"
<br>save molecules last "pdr_th85ism_cgto.mol"
<br>save dr last "pdr_th85ism_cgto.dr"
<br>save hydrogen physical conditions last "pdr_th85ism_cgto.hyd" 
<br>save results last "pdr_th85ism_cgto.rlt"
<br>save continuum units microns last "pdr_th85ism_cgto.con"
<br>save heating last "pdr_th85ism_cgto.het"
<br>save cooling last "pdr_th85ism_cgto.col"
<br>save hydrogen 21 cm last "pdr_th85ism_cgto.21cm"
<br>save element magnesium last "pdr_th85ism_cgto.mag"
<br>save grain extinction last  "pdr_th85ism_cgto.grnext"
<br>save grain potential last   "pdr_th85ism_cgto.grnpot"
<br>save grain temperature last "pdr_th85ism_cgto.grntem"
<br>save grain charge last "pdr_th85ism_cgto.grnchr"
<br>#
<br># pdr_th85ism_cgto.in
<br># class pdr 
<br># ========================================
<br># 
</kbd><p>
This is the Tielens and Hollenbach (1985a, b) standard model of
the Orion photodissociation region (PDR) but with the C abundance
increased by 0.2 dex, and O lowered by this amount, so that C/O>1.
Specifically, this is their Table 2 of paper 2, ApJ 291,  p749.
The Database H-like Lyman pumping off command appears because the Lyman lines are
vastly optically thick in this environment. 
If the command is removed the Lyman lines will be optically thin,
which will result in fast fluorescent excitation of the
(nearly totally neutral) hydrogen atom.
<p>
# >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985a, ApJ, 291, 722
# >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985b, ApJ, 291, 746
  
</p><hr><kbd><h2>pdr_th85orion.in</h2>  </kbd><h2><I>TH85 PDR with Orion grains
</I></h2><kbd><br>title TH85 PDR with Orion grains
<br>#
<br># commands controlling continuum =========
<br># cosmic background
<br>background
<br># galactic cosmic ray background 
<br>cosmic rays, background
<br># first continuum is FIR hot grain continuum produced in 
<br># unmodeled HII Region
<br>blackbody, t = 75 K
<br>intensity 2.7 (total)
<br># this is the attenuated hot stellar continuum
<br>black 30000
<br>intensity  2.204 range  0.4412 to 1 Ryd
<br># this will remove all ionizing radiation
<br>extinguish 24 0
<br>#
<br># commands for density & abundances =========
<br>hden 5.362
<br>init file="ism.ini"
<br>grains orion, abundance log 0.16 no qheat 
<br>abundances he=-1.01 c=-3.52 n=-8 o=-3.30 ne=-8 mg=-5.89
<br>continue si= -6.10 s= -5.10 cl=-7 ar=-8 fe= -6.60
<br>#
<br># commands controlling geometry  =========
<br># simulate effects of gas we do not model 
<br>double
<br>sphere
<br># stopping criteria
<br># this should be the one actually used
<br># >>chn 04 mar 13, from 10 to 36.3, bug in AV had stopped at this depth,
<br># so change it to this to keep model the same
<br>stop AV 36.3 extended 
<br># stop when gas is fully neutral
<br>stop efrac -10
<br># stop when gas is cold
<br>stop temperature 10 linear
<br># stop at thickness so that would make results very
<br># detail dependent
<br>stop thickness 19
<br>#
<br># other commands for details     =========
<br>turbulence 2.7 km/sec
<br>iterate
<br>failures 3 
<br># 
<br># this is done to not allow pumping and subsequent photoionization
<br># of H by Balmer continuum in keeping with std pdr assumptions 
<br>Database H-like Lyman pumping off
<br>#
<br># commands controlling output    =========
<br>normalize to "c  2" 157.636m 
<br># uv lines are strongly pumped by stellar continuum, break out contribution
<br>print line pump
<br>print line optical depths
<br>print ages
<br>#
<br>save performance "pdr_th85orion.per"
<br>save overview "pdr_th85orion.ovr"
<br>save pdr last "pdr_th85orion.pdr"
<br># this only outputs major molecules 
<br>save molecules last "pdr_th85orion.mol"
<br>save dr "pdr_th85orion.dr"
<br># this is to get all of H molecules 
<br>save hydrogen physical conditions last "pdr_th85orion.hyd" 
<br>save results last "pdr_th85orion.rlt"
<br>save continuum units microns last "pdr_th85orion.con"
<br>save ionizing continuum last "pdr_th85orion.ion"
<br>save heating last "pdr_th85orion.het"
<br>save cooling last "pdr_th85orion.col"
<br>save hydrogen 21 cm last "pdr_th85orion.21cm"
<br># these are for the grains
<br>save grain extinction last  "pdr_th85orion.grnext"
<br>save grain potential last   "pdr_th85orion.grnpot"
<br>save grain temperature last "pdr_th85orion.grntem"
<br>save grain charge last "pdr_th85orion.grnchr"
<br>#
<br>#
<br># pdr_th85orion.in
<br># class pdr  
<br># ========================================
</kbd><p>
This is the Tielens and Hollenbach (1985a, b) standard model of
the Orion photodissociation region (PDR).  Specifically,
this is my attempt at their Table 2 of paper 2, ApJ 291,  p749.
The Database H-like Lyman pumping off command appears because the Lyman lines are
vastly optically thick in this environment. 
If the command is removed the Lyman lines will be optically thin,
which will result in fast fluorescent excitation of the
(nearly totally neutral) hydrogen atom.
<p>
# >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985a, ApJ, 291, 722
# >>refer	model	pdr	Tielens, A. G. G. M., & Hollenbach, D. 1985b, ApJ, 291, 746
  
</p><hr><kbd><h2>pn_fluc.in</h2>  </kbd><h2><I>Paris PN with density fluctuations
</I></h2><kbd><br>title Paris PN with density fluctuations
<br>#
<br># commands for density & abundances =========
<br>fluctuations 16.5 4 3
<br># this sets up the code like version c84, with fewer chemical elements
<br>init file="c84.ini"
<br># this sets the abundances of the elements that we will use 
<br>abund He=-1 C=-3.523 N=-4. O=-3.222 ne=-3.824 na=-10 mg=-4.523 al=-10
<br>continue si=-4.523 s=-4.824 ar=-10 ca=-10 fe=-10 ni=-10
<br>#
<br># commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>black 5
<br>luminosity total 38
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 17
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>save performance "pn_fluc.per"
<br>save overview last "pn_fluc.ovr"
<br>save element nitrogen last "pn_fluc.nit"
<br>save dr last "pn_fluc.dr"
<br>save results last "pn_fluc.rlt"
<br>#
<br># pn_fluc.in
<br># class pn function
<br># ========================================
</kbd><p>
The boundary conditions are similar to those for the Paris meeting PN,
a homogeneous grain-free PN.  This model has density fluctuations,
with values chosen so that the mean ne np V are the same
for the nebulae with and without fluctuations.  
<p>
<br>Checks:
<br>-	Check that the fluctuations command works.
<br>-	How do results compare with homogeneous Paris pn?
<p>
</p><hr><kbd><h2>pn_ots.in</h2>  </kbd><h2><I>Paris PN with ots
</I></h2><kbd><br>title Paris PN with ots
<br># recompute "standard" PN model of the Pequignot Meudon Conference
<br>#
<br># commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>#
<br># commands for density & abundances =========
<br>hden = 3.4771213
<br>init file="c84.ini"
<br>abund He=-1 C=-3.523 N=-4. O=-3.222 ne=-3.824 na=-10 mg=-4.523 al=-10
<br>continue si=-4.523 s=-4.824 ar=-10 ca=-10 fe=-10 ni=-10
<br>#
<br># commands controlling geometry  =========
<br>radius = 17
<br>sphere
<br>#
<br># other commands for details     =========
<br>diffuse ots
<br>no level2
<br>iterate
<br>database h-like element hydrogen levels resolved 10
<br>database h-like element helium levels resolved 15
<br>#
<br># commands controlling output    =========
<br>save performance "pn_ots.per"
<br>save overview last "pn_ots.ovr"
<br>save element nitrogen last "pn_ots.nit"
<br>save results last "pn_ots.rlt"
<br>save dr last "pn_ots.dr"
<br>#
<br># pn_ots.in
<br># class pn 
<br># ========================================
<br># 
</kbd><p>
This is the on-the-spot version of the Paris Planetary Nebula.
<br>Checks:
<br>-	Q(H) total 4861 luminosity is close to expected value
<br>-	Line spectrum similar to that predicted by default conditions.
<p>
</p><hr><kbd><h2>pn_paris.in</h2>  </kbd><h2><I>"Paris meeting PN"
</I></h2><kbd><br>title "Paris meeting PN"
<br># standard" PN model of the Pequignot Meudon Conference
<br>#
<br># commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>#
<br># commands for density & abundances =========
<br>hden = 3.4771213
<br>init file="ism.ini"
<br># these elements were not part of the workshop models
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>abund he=-1 C=-3.523 N=-4. O=-3.222 ne=-3.824 mg=-4.523 
<br>continue si=-4.523 s=-4.824 cl=-7 ar=-10 fe=-10 
<br>#
<br># commands controlling geometry  =========
<br>radius = 17
<br>sphere
<br>#
<br># other commands for details     =========
<br>age 10^2^2 years
<br>#
<br># commands controlling output    =========
<br>print lines sort wavelength
<br>normalize to "Ca b" 4861.32A 
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>print line optical depths 
<br>print ages 
<br>print column densities 
<br>save performance "pn_paris.per"
<br>save overview "pn_paris.ovr"
<br>save transmitted continuum "pn_paris.trn"
<br>save continuum units microns "pn_paris.con"
<br>save element carbon  "pn_paris.car"
<br>save physical conditions "pn_paris.phy"
<br>save element nitrogen "pn_paris.nit" 
<br>save dr "pn_paris.dr"
<br>save temperature "pn_paris.tem"
<br>save lines emissivity "pn_paris.ems"
<br>h  1 6562.80A
<br>Blnd  6720
<br>end of lines
<br>save averages "pn_paris.avr" last
<br>temperature hydrogen 1 
<br>end of averagers
<br>#
<br># pn_paris.in 
<br># class pn 
<br># ========================================
<br># 
</kbd><p>
<p>
This is one of the "standard" models computed at the Paris meeting on
photoionization and shock calculations.  A table in Hazy compares the
predictions of the current version of CLOUDY with predictions of a
few of the other codes.
<p>
The model is meant to represent a planetary nebula ionized by a very
hot central object.  As a result there is a great deal of He++ and
the associated line and continuum emission is very important.
<p>
An age of 10000 years was set.  This tests logic in the age command.
<p>
</p><hr><kbd><h2>pn_paris_cpre.in</h2>  </kbd><h2><I>"Paris meeting PN with constant pressure"
</I></h2><kbd><br>title "Paris meeting PN with constant pressure"
<br># standard" PN model of the Pequignot Meudon Conference
<br>#
<br># commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>#
<br># commands for density & abundances =========
<br>hden = 3.4771213
<br>constant pressure
<br>init file="ism.ini"
<br># these elements were not part of the workshop models
<br>element chlorine off
<br>element argon off
<br>element iron off
<br>abund he=-1 C=-3.523 N=-4. O=-3.222 ne=-3.824 mg=-4.523 
<br>continue si=-4.523 s=-4.824 cl=-7 ar=-10 fe=-10 
<br>#
<br># commands controlling geometry  =========
<br>radius = 17
<br>sphere
<br>#
<br># other commands for details     =========
<br>age 10^2^2 years
<br>#
<br># commands controlling output    =========
<br>print lines sort wavelength
<br>normalize to "Ca b" 4861.32A 
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>print line optical depths 
<br>print ages 
<br>print column densities 
<br>save performance "pn_paris_cpre.per"
<br>save overview "pn_paris_cpre.ovr"
<br>save transmitted continuum "pn_paris_cpre.trn"
<br>save continuum units microns "pn_paris_cpre.con"
<br>save element carbon  "pn_paris_cpre.car"
<br>save physical conditions "pn_paris_cpre.phy"
<br>save element nitrogen "pn_paris_cpre.nit" 
<br>save dr "pn_paris_cpre.dr"
<br>save temperature "pn_paris_cpre.tem"
<br>save lines emissivity "pn_paris_cpre.ems"
<br>h  1 6562.80A
<br>Blnd  6720
<br>end of lines
<br>save averages "pn_paris_cpre.avr" last
<br>temperature hydrogen 1 
<br>end of averagers
<br>#
<br># pn_paris_cpre.in 
<br># class pn 
<br># ========================================
<br># 
</kbd><p>
<p>
This is one of the "standard" models computed at the Paris meeting on
photoionization and shock calculations, modified by assuming constant
pressure within the nebula.
<p>
</p><hr><kbd><h2>pn_paris_fast.in</h2>  </kbd><h2><I>Paris PN, fast version
</I></h2><kbd><br>title Paris PN, fast version
<br># standard" PN model of the Pequignot Meudon Conference
<br>#
<br># commands controlling continuum =========
<br>black body, T = 150000 K, radius = 10
<br>#
<br># commands for density & abundances =========
<br>hden = 3.4771213
<br>init file="fast.ini"
<br>abund he=-1 C=-3.523 N=-4. O=-3.222 ne=-3.824 mg=-4.523 
<br>continue si=-4.523 s=-4.824 ar=-10
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius = 17
<br>#
<br># other commands for details     =========
<br>#
<br># commands controlling output    =========
<br>normalize to "Ca b" 4861.32A
<br># the normalizing line is not defined on the emergent line stack
<br>print lines emergent off
<br>save performance "pn_paris_fast.per"
<br>save overview "pn_paris_fast.ovr"
<br>save physical conditions "pn_paris_fast.phy"
<br>save element nitrogen "pn_paris_fast.nit" 
<br>save dr "pn_paris_fast.dr"
<br>#
<br># pn_paris_fast.in 
<br># class pn 
<br># ========================================
<br># 
</kbd><p>
<p>
This is one of the "standard" models computed at the Paris meeting on
photoionization and shock calculations.  A table in Hazy compares the
predictions of the current version of CLOUDY with predictions of a
few of the other codes.
<p>
The model is meant to represent a planetary nebula ionized by a very
hot central object.  As a result there is a great deal of He++ and
the associated line and continuum emission is very important.
<p>
</p><hr><kbd><h2>pn_sqrden.in</h2>  </kbd><h2><I>PN with density propt R^-2 and filling factor
</I></h2><kbd><br>title PN with density propt R^-2 and filling factor
<br># this is an optically thin model, which will have a broad range
<br># of density but the same ionization parameter across the model.  
<br># the physical condtions should not vary by much across the structure
<br>#
<br># commands controlling continuum =========
<br># continuum is hot blackbody at ~Ledd for solar mass
<br>blackbody, t=5 luminosity=38
<br>#
<br># commands for density & abundances =========
<br># the density will fall off as the inverse square of the radius, hence the name
<br>hden 5 -2
<br>init file "ism.ini"
<br># use default PN abundances but turn off quantum heating since
<br># we are not going to save the predicted near IR continuum
<br>abundances planetary no qheat 
<br>#
<br># commands controlling geometry  =========
<br># small filling factor so that region will be optically thin
<br>filling factor -2
<br># set inner and outer radius 
<br>radius 16 18
<br>sphere
<br>#
<br># other commands for details     =========
<br>iterate
<br># 
<br># commands controlling output    =========
<br>print line faint 1 
<br>save performance "pn_sqrden.per"
<br>save overview "pn_sqrden.ovr" last
<br>save dr "pn_sqrden.dr" last
<br>save molecules "pn_sqrden.mol" 
<br>#
<br># pn_sqrden.in
<br># class pn 
<br># ========================================
</kbd><p>
<br>Checks:
<br>-	Zone thickness budgeting handled OK.
<br>-       physical conditions nearly constant across computed structure
<p>
</p><hr><kbd><h2>rrc_o.in</h2>  </kbd><h2><I>he-like oxygen ion vs. Bautista & Kallman 2000 Table 1, column 3
</I></h2><kbd><br>title he-like oxygen ion vs. Bautista & Kallman 2000 Table 1, column 3
<br>#
<br># commands controlling continuum =========
<br>laser 100
<br>ionization -1
<br>#
<br># commands for density & abundances =========
<br>hden 7
<br># include lots of the element we are testing and set the ionization 
<br># to be dominated by the correct ion stage
<br>element oxygen abundance -2.0458
<br>element oxygen ionization -1 -1 -1 -1 -1 -1 -1 -1 -1
<br>init file "ism.ini"
<br>element helium off
<br>element nitrogen off
<br>element carbon off
<br>element neon off
<br>element magnesium off
<br>element silicon off
<br>element sulphur off
<br>element argon off
<br>element iron off
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>set dr -12
<br>#
<br># other commands for details     =========
<br>constant temper 5
<br>iterate
<br>#
<br># commands controlling output    =========
<br>print line faint -5
<br>save overview "rrc_o.ovr"
<br>save performance "rrc_o.per"
<br>save continuum "rrc_o.con" units Angstroms last
<br># rrc_o.in
<br># class limit 
<br># ========================================
<br># 
</kbd><p>
test RRC of simple and iso model atoms.  The ionization is set to
10% for all stages of ionization of O.  We monitor the ground
state recombination emission.  This is an optically thin model.
<p>
<p>
</p><hr><kbd><h2>stars_atlas.in</h2>  </kbd><h2><I>Atlas stellar atmosphere
</I></h2><kbd><br>title Atlas stellar atmosphere
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a hot star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests the new Kurucz model option.
<br># I choose the T_eff and log(g) values arbitrarily.  It implies a star
<br># with luminosity 32300 L_sun, radius 6.4745 R_sun, and mass 3.745 M_sun.
<br>table star atlas 30400.0 4.2
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_atlas.per"
<br>save overview last "stars_atlas.ovr"
<br>save results last "stars_atlas.rlt"
<br>save transmitted continuum last "stars_atlas.trn" no header
<br>save continuum last "stars_atlas.con" units angstrom
<br>#
<br># stars_atlas.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Atlas model atmosphere continua described by Kurucz (1991). 
Kevin Volk provided it as part of his original coding of these
stellar atmosphere files.
Constant temperature is assumed since this tests shape of stellar continuum
rather than thermal physics.
<p>
<br>Checks:
table star atlas command works.
<p>
</p><hr><kbd><h2>stars_atlas_3d.in</h2>  </kbd><h2><I>Atlas stellar atmosphere, 3D interpolation
</I></h2><kbd><br>title Atlas stellar atmosphere, 3D interpolation
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a hot star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc. This run tests the atlas 3dim model option.
<br># I choose the T_eff and log(g) values arbitrarily.
<br>table star atlas 3-dim 38400.0 4.82 -1.42
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew 3-dim 38400.0 4.82 0.42
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_atlas_3d.per"
<br>save overview last "stars_atlas_3d.ovr"
<br>save results last "stars_atlas_3d.rlt"
<br>save transmitted continuum last "stars_atlas_3d.trn" no header
<br>save continuum last "stars_atlas_3d.con" units angstrom
<br>#
<br># stars_atlas_3d.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large 3-dim block of Atlas model atmosphere continua. 
<p>
<br>Checks:
table star atlas 3dim command works.
<p>
</p><hr><kbd><h2>stars_atlas_all.in</h2>  </kbd><h2><I>interpolate on Atlas grids
</I></h2><kbd><br>title interpolate on Atlas grids
<br>#
<br># commands controlling continuum =========
<br># Include stars with a wide range of metallicities to test access to these grids.
<br>table star atlas Z+1.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.3 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.2 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.1 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z+0.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-0.1 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-0.2 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-0.3 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-0.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-1.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-1.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-2.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-2.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-3.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-3.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-4.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-4.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas Z-5.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_atlas_all.per"
<br>save overview last "stars_atlas_all.ovr"
<br>save results last "stars_atlas_all.rlt"
<br>save transmitted continuum last "stars_atlas_all.trn" no header
<br>save continuum last "stars_atlas_all.con" units angstrom
<br>#
<br># stars_atlas_all.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
2D grids of various metallicity of Atlas model atmosphere continua. 
<p>
<br>Checks:
access to the various atlas grids
<p>
</p><hr><kbd><h2>stars_atlas_odfnew_all.in</h2>  </kbd><h2><I>access various Atlas ODFNEW grids
</I></h2><kbd><br>title access various Atlas ODFNEW grids
<br>#
<br># commands controlling continuum =========
<br># Include stars with a wide range of metallicities to test access to these grids.
<br>table star atlas odfnew Z+0.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z+0.2 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z+0.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-0.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-1.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-1.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-2.0 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>table star atlas odfnew Z-2.5 38400.0 4.82
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_atlas_odfnew_all.per"
<br>save overview last "stars_atlas_odfnew_all.ovr"
<br>save results last "stars_atlas_odfnew_all.rlt"
<br>save transmitted continuum last "stars_atlas_odfnew_all.trn" no header
<br>save continuum last "stars_atlas_odfnew_all.con" units angstrom
<br>#
<br># stars_atlas_odfnew_all.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
Atlas ODFNEW model atmosphere continua. 
<p>
<br>Checks:
access to the various atlas odfnew grids
</p><hr><kbd><h2>stars_bstar2006.in</h2>  </kbd><h2><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a B star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests the new Tlusty model option.
<br># I choose the T_eff and log(g) values arbitrarily.
<br>table star tlusty bstar 20400.0 4.2
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_bstar2006.per"
<br>save overview last "stars_bstar2006.ovr"
<br>save results last "stars_bstar2006.rlt"
<br>save continuum last "stars_bstar2006.con" units angstrom
<br>save transmitted continuum last "stars_bstar2006.trn" no header
<br>#
<br># stars_bstar2006.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty bstar command works.
<p>
</p><hr><kbd><h2>stars_bstar2006_3d.in</h2>  </kbd><h2><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a B star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc. This run tests the new Tlusty model option.
<br># I choose the T_eff, log(g) and log(Z) values arbitrarily.
<br>table star tlusty bstar 3-dim 20400.0 4.2 -0.573
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_bstar2006_3d.per"
<br>save overview last "stars_bstar2006_3d.ovr"
<br>save results last "stars_bstar2006_3d.rlt"
<br>save continuum last "stars_bstar2006_3d.con" units angstrom
<br>save transmitted continuum last "stars_bstar2006_3d.trn" no header
<br>#
<br># stars_bstar2006_3d.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large 3-dim block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty bstar 3-dim command works.
<p>
</p><hr><kbd><h2>stars_bstar2006_all.in</h2>  </kbd><h2><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of 6 B stars ionizing their surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests all the various
<br># metallicities contained in the BSTAR 2006 grids. I choose the T_eff
<br># and log(g) values arbitrarily.
<br>table star tlusty bstar Z+0.3 20000.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z+0.0 21400.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z-0.3 15000.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z-0.7 20400.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z-1.0 27500.0 3.0
<br>luminosity 4.509202522 solar
<br>table star tlusty bstar Z-INF 18000.0 4.75
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>no blends
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_bstar2006_all.per"
<br>save overview last "stars_bstar2006_all.ovr"
<br>save results last "stars_bstar2006_all.rlt"
<br>save continuum last "stars_bstar2006_all.trn" units angstrom
<br>save transmitted continuum last "stars_bstar2006_all.trn" no header
<br>#
<br># stars_bstar2006_all.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty bstar metallicity option works.
<p>
</p><hr><kbd><h2>stars_costar1.in</h2>  </kbd><h2><I>costar interpolation mode 1
</I></h2><kbd><br>title costar interpolation mode 1
<br>#
<br># commands controlling continuum =========
<br>table star costar, 40000 K
<br>ionization parameter -2
<br>table star costar, 31000 K, index 4
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>grains orion single no qheat 
<br>abundances ism no grains
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>constant temperature 6000K
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save overview "stars_costar1.ovr"
<br>save performance "stars_costar1.per"
<br>save continuum last "stars_costar1.con" units angstrom
<br>#
<br># stars_costar1.in
<br># class stars 
<br># ========================================
<br># 
</kbd><p>
This is a test of whether the code can read the CoStar stellar atmospheres.
It checks the resulting ionization to confirm that the continuum 
shape was ok.
Constant temperature is assumed since this tests shape of stellar continuum
rather than thermal physics.
<p>
<p>
</p><hr><kbd><h2>stars_costar2.in</h2>  </kbd><h2><I>costar interpolation mode 2
</I></h2><kbd><br>title costar interpolation mode 2
<br>#
<br># commands controlling continuum =========
<br>table star costar 35575.4 4.2367
<br>ionization parameter -2
<br>table star costar 34468.5 3.86765
<br>ionization parameter -2
<br>table star costar 41741.2 4.02
<br>ionization parameter -2
<br>table star costar 45000 4.1593
<br>ionization parameter -2
<br>table star costar 27500 3.3
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>grains orion single no qheat 
<br>abundances ism no grains
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save overview "stars_costar2.ovr"
<br>save performance "stars_costar2.per"
<br>save continuum last "stars_costar2.con" units angstrom
<br>#
<br># stars_costar2.in
<br># class stars 
<br># ========================================
<br># 
</kbd><p>
This is a test of whether the code can read the CoStar stellar atmospheres.
It checks the resulting ionization to confirm that the continuum 
shape was ok.
<p>
</p><hr><kbd><h2>stars_costar3.in</h2>  </kbd><h2><I>costar interpolation mode 3
</I></h2><kbd><br>title costar interpolation mode 3
<br>#
<br># commands controlling continuum =========
<br>table star costar zams 40.0 Msol 2.85e6
<br>ionization parameter -2
<br>table star costar zams 40.0 Msol 4e6
<br>ionization parameter -2
<br>table star costar zams 50.9 Msol 2.85e6
<br>ionization parameter -2
<br>table star costar zams 42.9 Msol 1.6e6
<br>ionization parameter -2
<br>table star costar zams 70.5 Msol 2.1e6
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>grains orion single no qheat 
<br>abundances ism no grains
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save overview "stars_costar3.ovr"
<br>save performance "stars_costar3.per"
<br>save continuum last "stars_costar3.con" units angstrom
<br>#
<br># stars_costar3.in
<br># class stars 
<br># ========================================
<br># 
</kbd><p>
This is a test of whether the code can read the CoStar stellar atmospheres.
It checks the resulting ionization to confirm that the continuum 
shape was ok.
<p>
</p><hr><kbd><h2>stars_costar4.in</h2>  </kbd><h2><I>costar interpolation mode 4
</I></h2><kbd><br>title costar interpolation mode 4
<br>#
<br># commands controlling continuum =========
<br>table star costar age 2.85e6 40.0
<br>ionization parameter -2
<br>table star costar age 4e6 40.0
<br>ionization parameter -2
<br>table star costar age 2.85e6 50.9
<br>ionization parameter -2
<br>table star costar age 1.6e6 42.9
<br>ionization parameter -2
<br>table star costar age 2.1e6 70.5
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>grains orion single no qheat 
<br>abundances ism no grains
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save overview "stars_costar4.ovr"
<br>save performance "stars_costar4.per"
<br>save continuum last "stars_costar4.con" units angstrom
<br>#
<br># stars_costar4.in
<br># class stars 
<br># ========================================
<br># 
</kbd><p>
This is a test of whether the code can read the CoStar stellar atmospheres.
It checks the resulting ionization to confirm that the continuum 
shape was ok.
<p>
<p>
</p><hr><kbd><h2>stars_costarhalo.in</h2>  </kbd><h2><I>costar halo abundances
</I></h2><kbd><br>title costar halo abundances
<br>#
<br># commands controlling continuum =========
<br>table star costar, halo abundances, 40000 K
<br>ionization parameter -2
<br>#
<br># commands for density & abundances =========
<br>hden 2
<br>abundances ism 
<br>#
<br># commands controlling geometry  =========
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>constant temperature 6900K
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save overview "stars_costarhalo.ovr"
<br>save performance "stars_costarhalo.per"
<br>save continuum last "stars_costarhalo.con" units angstrom
<br>#
<br># 
<br># stars_costarhalo.in
<br># class stars 
<br># ========================================
<br># 
</kbd><p>
This test checks that the code can read the CoStar
stellar atmospheres.  It checks the resulting
ionization to make sure that the continuum shape is ok.
Constant temperature is assumed since this tests shape of stellar continuum
rather than thermal physics.
<p>
</p><hr><kbd><h2>stars_kurucz79.in</h2>  </kbd><h2><I>Kurucz 1979 SED
</I></h2><kbd><br>title Kurucz 1979 SED
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a hot star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests the Kurucz model option.
<br># I choose the T_eff and log(g) values arbitrarily.  It implies a star
<br># with luminosity 32300 L_sun, radius 6.4745 R_sun, and mass 3.745 M_sun.
<br>table star kurucz 30400.0
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_kurucz79.per"
<br>save overview last "stars_kurucz79.ovr"
<br>save results last "stars_kurucz79.rlt"
<br>save transmitted continuum last "stars_kurucz79.trn" no header
<br>save continuum last "stars_kurucz79.con" units angstrom
<br>#
<br># stars_kurucz79.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
Kurucz model atmosphere continua described by Kurucz (1979). 
Kevin Volk provided it as part of his original coding of these
stellar atmosphere files.
Constant temperature is assumed since this tests shape of stellar continuum
rather than thermal physics.
<p>
<br>Checks:
table star kurucz command works.
<p>
</p><hr><kbd><h2>stars_mihalas.in</h2>  </kbd><h2><I>Mihalas SED
</I></h2><kbd><br>title Mihalas SED
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a hot star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests the new Kurucz model option.
<br># I choose the T_eff and log(g) values arbitrarily.  It implies a star
<br># with luminosity 32300 L_sun, radius 6.4745 R_sun, and mass 3.745 M_sun.
<br>table star mihalas 30400.0
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_mihalas.per"
<br>save overview last "stars_mihalas.ovr"
<br>save results last "stars_mihalas.rlt"
<br>save transmitted continuum last "stars_mihalas.trn" no header
<br>save continuum last "stars_mihalas.con" units angstrom
<br>#
<br># stars_mihalas.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
small Mihalas grid of NLTE model atmospeheres
Constant temperature is assumed since this tests shape of continuum
not thermal physics.
<p>
<br>Checks:
table star mihalas command works.
<p>
</p><hr><kbd><h2>stars_obstar_merged.in</h2>  </kbd><h2><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a B star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests the new Tlusty model option.
<br># I choose the T_eff and log(g) values arbitrarily.
<br>table star tlusty obstar 20400.0 4.2
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>no blends
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_obstar_merged.per"
<br>save overview last "stars_obstar_merged.ovr"
<br>save results last "stars_obstar_merged.rlt"
<br>save continuum last "stars_obstar_merged.con" units angstrom
<br>save transmitted continuum last "stars_obstar_merged.trn" no header
<br>#
<br># stars_obstar_merged.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty obstar command works.
<p>
</p><hr><kbd><h2>stars_obstar_merged_3d.in</h2>  </kbd><h2><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a B star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc. This run tests the new Tlusty model option.
<br># I choose the T_eff, log(g) and log(Z) values arbitrarily.
<br>table star tlusty obstar 3-dim 20400.0 4.2 -0.573
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_obstar_merged_3d.per"
<br>save overview last "stars_obstar_merged_3d.ovr"
<br>save results last "stars_obstar_merged_3d.rlt"
<br>save continuum last "stars_obstar_merged_3d.con" units angstrom
<br>save transmitted continuum last "stars_obstar_merged_3d.trn" no header
<br>#
<br># stars_obstar_merged_3d.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large 3-dim block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty obstar 3-dim command works.
<p>
</p><hr><kbd><h2>stars_obstar_merged_all.in</h2>  </kbd><h2><I>tlusty bstar grid
</I></h2><kbd><br>title tlusty bstar grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of 6 B stars ionizing their surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests all the various
<br># metallicities contained in the BSTAR 2006 grids. I choose the T_eff
<br># and log(g) values arbitrarily.
<br>table star tlusty obstar Z+0.3 40000.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty obstar Z+0.0 21400.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty obstar Z-0.3 35000.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty obstar Z-0.7 20400.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty obstar Z-1.0 27500.0 3.0
<br>luminosity 4.509202522 solar
<br>table star tlusty obstar Z-INF 18000.0 4.75
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_obstar_merged_all.per"
<br>save overview last "stars_obstar_merged_all.ovr"
<br>save results last "stars_obstar_merged_all.rlt"
<br>save continuum last "stars_obstar_merged_all.trn" units angstrom
<br>save transmitted continuum last "stars_obstar_merged_all.trn" no header
<br>#
<br># stars_obstar_merged_all.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty B-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty obstar metallicity option works.
<p>
</p><hr><kbd><h2>stars_optimize1.in</h2>  </kbd><h2><I>optimizer on stellar grids
</I></h2><kbd><br>title optimizer on stellar grids
<br>#
<br># commands controlling continuum =========
<br>table star tlusty ostar 3-dim 31200 3.6 -1.12 vary
<br>ionization par -3
<br>#
<br># commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on  
<br>#
<br># commands controlling geometry  =========
<br>case B
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>optimize tolerance 0.03
<br>constant temper 4.3 vary
<br>optimize phymir sequential
<br>optimize iteration 500
<br># the following spectrum was derived by running this sim at hden 5, t=4,
<br># and T_star=51200
<br># resulting eden was 5.040 and T=4, which we shall assert that we find
<br>optimize lines
<br>O  2  3728.81   0.0446
<br>O  2  3726.03   0.1164
<br>Blnd  7323   0.1237
<br>Blnd  7332   0.1018
<br>O  3  5006.84  10.0205
<br>O  3  4363.21   0.0968
<br>end of lines
<br>#
<br># commands controlling output    =========
<br>print line faint -2
<br>#
<br>save overview "stars_optimize1.ovr"
<br>save performance "stars_optimize1.per"
<br>#
<br># optimize_phymir.in
<br># class optimizer
<br># ========================================
<br>#
</kbd><p>
This checks whether the optimizer sets corrects limits for Teff.  The line
spectrum was calculated at T = 1e4 K, n_H=1e5 cm^-3, T_star = 51200 K.
<p>
</p><hr><kbd><h2>stars_optimize2.in</h2>  </kbd><h2><I>optimizer on stellar grids
</I></h2><kbd><br>title optimizer on stellar grids
<br>#
<br># commands controlling continuum =========
<br>table star costar 36200 vary
<br>ionization par -3
<br>#
<br># commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on  
<br>#
<br># commands controlling geometry  =========
<br>Case B
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>optimize tolerance 0.03
<br>constant temper 4.3 vary
<br>optimize phymir sequential
<br>optimize iteration 500
<br># the following spectrum was derived by running this sim at hden 5, t=4,
<br># and T_star=51200
<br># resulting eden was 5.041 and T=4, which we shall assert that we find
<br>optimize lines
<br>O  2  3728.81   0.0365
<br>O  2  3726.03   0.0951
<br>Blnd  7323   0.1012
<br>Blnd  7332   0.0833
<br>O  3  5006.84  10.4461
<br>O  3  4363.21   0.1010
<br>end of lines
<br>#
<br># commands controlling output    =========
<br>print line faint -2
<br>#
<br>save overview "stars_optimize2.ovr"
<br>save performance "stars_optimize2.per"
<br>#
<br># optimize_phymir.in
<br># class optimizer
<br># ========================================
<br>#
</kbd><p>
This checks whether the optimizer sets corrects limits for Teff.  The line
spectrum was calculated at T = 1e4 K, n_H=1e5 cm^-3, T_star = 51200 K.
<p>
</p><hr><kbd><h2>stars_optimize3.in</h2>  </kbd><h2><I>optimizer on stellar grids
</I></h2><kbd><br>title optimizer on stellar grids
<br>#
<br># commands controlling continuum =========
<br>table star costar age 5.8 log 36 msol vary
<br>ionization par -3
<br>#
<br># commands for density & abundances =========
<br>hden 4 vary
<br>init file "hheonly.ini"
<br>element oxygen on  
<br>#
<br># commands controlling geometry  =========
<br>Case B
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>optimize tolerance 0.03
<br>constant temper 4.3 vary
<br>optimize phymir sequential
<br>optimize iteration 500
<br># the following spectrum was derived by running this sim at hden 5, t=4,
<br># and log(age)=6.3
<br># resulting eden was 5.040 and T=4, which we shall assert that we find
<br>optimize lines
<br>O  2  3728.81  0.0680
<br>O  2  3726.03  0.1774
<br>Blnd  7323  0.1887
<br>Blnd  7332  0.1554
<br>O  3  5006.84  8.7015
<br>O  3  4363.21  0.0841
<br>end of lines
<br>#
<br># commands controlling output    =========
<br>print line faint -2
<br>#
<br>save overview "stars_optimize3.ovr"
<br>save performance "stars_optimize3.per"
<br>#
<br># optimize_phymir.in
<br># class optimizer
<br># ========================================
<br>#
</kbd><p>
This checks whether the optimizer sets corrects limits for log(age).  The line
spectrum was calculated at T = 1e4 K, n_H=1e5 cm^-3, log(age/yr) = 6.3.
</p><hr><kbd><h2>stars_ostar2002.in</h2>  </kbd><h2><I>tlusty O star grid
</I></h2><kbd><br>title tlusty O star grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a hot star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests the new Tlusty model option.
<br># I choose the T_eff and log(g) values arbitrarily.  It implies a star
<br># with luminosity 32300 L_sun, radius 6.4745 R_sun, and mass 3.745 M_sun.
<br>table star tlusty ostar 30400.0 4.2
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>no blends
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_ostar2002.per"
<br>save overview last "stars_ostar2002.ovr"
<br>save results last "stars_ostar2002.rlt"
<br>save continuum last "stars_ostar2002.con" units angstrom
<br>save transmitted continuum last "stars_ostar2002.trn" no header
<br>#
<br># stars_ostar2002.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty O-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty ostar command works.
<p>
</p><hr><kbd><h2>stars_ostar2002_3d.in</h2>  </kbd><h2><I>tlusty Ostar grid
</I></h2><kbd><br>title tlusty Ostar grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a hot star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc. This run tests the new Tlusty model option.
<br># I choose the T_eff, log(g) and log(Z) values arbitrarily.
<br>table star tlusty ostar 3-dim 30400.0 4.2 -1.573
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -3.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_ostar2002_3d.per"
<br>save overview last "stars_ostar2002_3d.ovr"
<br>save results last "stars_ostar2002_3d.rlt"
<br>save continuum last "stars_ostar2002_3d.con" units angstrom
<br>save transmitted continuum last "stars_ostar2002_3d.trn" no header
<br>#
<br># stars_ostar2002_3d.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty O-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty ostar 3-dim command works.
<p>
</p><hr><kbd><h2>stars_ostar2002_all.in</h2>  </kbd><h2><I>tlusty Ostar grid
</I></h2><kbd><br>title tlusty Ostar grid
<br>#
<br># commands controlling continuum =========
<br># Approximate model of 10 hot stars ionizing their surroundings.
<br># Assume H density of 1e+6 per cc.  This run tests all the various
<br># metallicities contained in the OSTAR 2002 grids. I choose the T_eff
<br># and log(g) values such that the selection algorithm gets a good workout.
<br>table star tlusty ostar Z+0.3 30000.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z+0.0 31400.0 4.5
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-0.3 45000.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-0.7 30400.0 4.2
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-1.0 27500.0 3.0
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-1.5 55000.0 4.75
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-1.7 27500.0 4.75
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-2.0 55000.0 3.00
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-3.0 44400.0 3.2
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-INF 53000.0 4.75
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z+0.0 48400.0 3.87
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z-0.7 48400.0 3.55
<br>luminosity 4.509202522 solar
<br>table star tlusty ostar Z+0.3 43400.0 3.65
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>#
<br># in this model the Lyman lines are pumped significantly by the stellar continuum;
<br># disable this process to avoid critical dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_ostar2002_all.per"
<br>save overview last "stars_ostar2002_all.ovr"
<br>save results last "stars_ostar2002_all.rlt"
<br>save continuum last "stars_ostar2002_all.con" units angstrom
<br>save transmitted continuum last "stars_ostar2002_all.trn" no header
<br>#
<br># stars_ostar2002_all.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
large block of Tlusty O-star model atmosphere continua. 
<p>
<br>Checks:
table star tlusty ostar metallicity option works, also test selection algorithm.
<p>
</p><hr><kbd><h2>stars_rauch_3d.in</h2>  </kbd><h2><I>Rauch 3-dimensional grid
</I></h2><kbd><br>title Rauch 3-dimensional grid
<br>#
<br># commands controlling continuum =========
<br>table star rauch 3-dim T = 150000 K, g = 6.5 , log(Z) = -0.6
<br>luminosity 4.5 solar
<br>table star rauch old 3-dim T = 233000 K, g = 7.5 , log(Z) = -0.32
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>#
<br># other commands for details     =========
<br>no level2
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_3d.per"
<br>save overview last "stars_rauch_3d.ovr"
<br>save results last "stars_rauch_3d.rlt"
<br>save continuum last "stars_rauch_3d.con" units angstrom
<br>#
<br># stars_rauch_3d.in
<br># class stars 
<br># ========================================
</kbd><p>
This model checks that the code is able to access the 3-dim versions
of the Rauch grids of stellar atmosphere models.
Constant temperature is set since this test is intended to test
shape of ionizing continuum, not thermal physics.
<p>
</p><hr><kbd><h2>stars_rauch_cowd.in</h2>  </kbd><h2><I>Rauch hot PN star
</I></h2><kbd><br>title Rauch hot PN star
<br>#
<br># commands controlling continuum =========
<br>table star rauch co wd T = 238000 K
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>#
<br># other commands for details     =========
<br>no level2
<br>no blends
<br># test adding continuum points
<br>set nfnu add 10 cm
<br>set nfnu add 350 micron
<br>set nfnu add 200 angstrom
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_cowd.per"
<br>save overview last "stars_rauch_cowd.ovr"
<br>save results last "stars_rauch_cowd.rlt"
<br>save continuum last "stars_rauch_cowd.con" units angstrom
<br>#
<br># stars_rauch_cowd.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the C/O white dwarf version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><kbd><h2>stars_rauch_h+he.in</h2>  </kbd><h2><I>Rauch PN central star
</I></h2><kbd><br>title Rauch PN central star
<br>#
<br># commands controlling continuum =========
<br># this tests the various interpolation modes of the 3d grid
<br>table star rauch h+he T = 150000 K, g = 6.5 , f(He) = 0.2
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 155000 K, g = 6.5 , f(He) = 0.2
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 150000 K, g = 6.25 , f(He) = 0.2
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 150000 K, g = 6.5 , f(He) = 0.25
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 155000 K, g = 6.25 , f(He) = 0.2
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 155000 K, g = 6.5 , f(He) = 0.25
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 150000 K, g = 6.25 , f(He) = 0.25
<br>luminosity 4.5 solar
<br>table star rauch h+he T = 155000 K, g = 6.25 , f(He) = 0.25
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>#
<br># other commands for details     =========
<br>no level2
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_h+he.per"
<br>save overview last "stars_rauch_h+he.ovr"
<br>save results last "stars_rauch_h+he.rlt"
<br>save continuum last "stars_rauch_h+he.con" units angstrom
<br>#
<br># stars_rauch_h+he.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the H+He version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><kbd><h2>stars_rauch_h-ca.in</h2>  </kbd><h2><I>Rauch central star hot PN
</I></h2><kbd><br>title Rauch central star hot PN
<br># NB
<br># this uses the H-Ca rauch atmospheres
<br>#
<br># commands controlling continuum =========
<br>table star old rauch T = 250000 K, g = 7.5
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>no level2
<br>no blends
<br>#
<br># commands for density & abundances =========
<br>hden 3.0
<br>abundances planetary 
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_h-ca.per"
<br>save overview last "stars_rauch_h-ca.ovr"
<br>save results last "stars_rauch_h-ca.rlt"
<br>save continuum last "stars_rauch_h-ca.con" units angstrom
<br>#
<br># stars_rauch_h-ca.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the H-Ca Rauch grid of stellar atmosphere models.
</p><hr><kbd><h2>stars_rauch_h-ni.in</h2>  </kbd><h2><I>Rauch hot PN star
</I></h2><kbd><br>title Rauch hot PN star
<br>#
<br># commands controlling continuum =========
<br>table star rauch T = 150000 K, g = 6.5
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>#
<br># other commands for details     =========
<br>no level2
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_h-ni.per"
<br>save overview last "stars_rauch_h-ni.ovr"
<br>save results last "stars_rauch_h-ni.rlt"
<br>save continuum last "stars_rauch_h-ni.con" units angstrom
<br>#
<br># stars_rauch_h-ni.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the H-Ni version of the Rauch grid of stellar
atmosphere models.
Constant temperature is set since this test is intended to test
shape of ionizing continuum, not thermal physics.
<p>
<p>
</p><hr><kbd><h2>stars_rauch_helium.in</h2>  </kbd><h2><I>Rauch hot PN star
</I></h2><kbd><br>title Rauch hot PN star
<br>#
<br># commands controlling continuum =========
<br>table star rauch helium T = 240000 K, g = 8.5
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>#
<br># other commands for details     =========
<br>no level2
<br>no blends
<br># test adding continuum points
<br>set nfnu add 10 cm
<br>set nfnu add 350 micron
<br>set nfnu add 200 angstrom
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_helium.per"
<br>save overview last "stars_rauch_helium.ovr"
<br>save results last "stars_rauch_helium.rlt"
<br>save continuum last "stars_rauch_helium.con" units angstrom
<br>#
<br># stars_rauch_helium.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the pure helium version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><kbd><h2>stars_rauch_hydr.in</h2>  </kbd><h2><I>Rauch hot PN star
</I></h2><kbd><br>title Rauch hot PN star
<br>#
<br># commands controlling continuum =========
<br>table star rauch hydr T = 240000 K, g = 8.5
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>#
<br># other commands for details     =========
<br>no level2
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_hydr.per"
<br>save overview last "stars_rauch_hydr.ovr"
<br>save results last "stars_rauch_hydr.rlt"
<br>save continuum last "stars_rauch_hydr.con" units angstrom
<br>#
<br># stars_rauch_hydr.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the pure hydrogen version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><kbd><h2>stars_rauch_pg1159.in</h2>  </kbd><h2><I>Rauch hot [WR] PN
</I></h2><kbd><br>title Rauch hot [WR] PN
<br>#
<br># commands controlling continuum =========
<br>table star rauch pg1159 T=150000K g=6.5
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>#
<br># other commands for details     =========
<br>no level2
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_pg1159.per"
<br>save overview last "stars_rauch_pg1159.ovr"
<br>save results last "stars_rauch_pg1159.rlt"
<br>save continuum last "stars_rauch_pg1159.con" units angstrom
<br>#
<br># stars_rauch.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a model of a very hot planetary nebula, and checks that the code
is able to access the PG1159 version of the Rauch grid of stellar
atmosphere models.
<p>
</p><hr><kbd><h2>stars_rauch_pg1159_ascii.in</h2>  </kbd><h2><I>Rauch cool [WR] PN
</I></h2><kbd><br>title Rauch cool [WR] PN
<br>#
<br># commands controlling continuum =========
<br>table star "rauch_pg1159.ascii" T=40000K g=7
<br>luminosity 4.5 solar
<br>#
<br># commands controlling geometry  =========
<br>sphere
<br>radius 18
<br>stop zone 1
<br>set dr 0
<br>#
<br># commands for density & abundances =========
<br>abundances planetary 
<br>hden 3.0
<br>#
<br># other commands for details     =========
<br>no level2
<br>set nfnu add 9.5 angstrom
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save performance "stars_rauch_pg1159_ascii.per"
<br>save overview last "stars_rauch_pg1159_ascii.ovr"
<br>save results last "stars_rauch_pg1159_ascii.rlt"
<br>save continuum last "stars_rauch_pg1159_ascii.con" units angstrom
<br>#
<br># stars_rauch_pg1159_ascii.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a model of a cool PNCS, and checks that the code
can correctly rebin a model with zero fluxes embedded.
It also exercises reading directly from an ascii file.
</p><hr><kbd><h2>stars_starburst99.in</h2>  </kbd><h2><I>Starburst 99 SED
</I></h2><kbd><br>title Starburst 99 SED
<br>#
<br># commands controlling continuum =========
<br># read the table starburst and interploate to an age of 1e8 years
<br>table star log age=8 "starburst99.mod"
<br>luminosity 43
<br># add background continuum - starburs 99 does not extend
<br># into fir so code would complain about zero continuum
<br># adding the cosmic background stops this complaint
<br>background
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>radius 20
<br>#
<br># other commands for details     =========
<br>constant temper 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save overview "stars_starburst99.ovr"
<br>save performance "stars_starburst99.per"
<br>save continuum last "stars_starburst99.con" units angstrom
<br>#
<br>#
<br># stars_starburst99.in
<br># class stars 
<br># ========================================
<br># 
</kbd><p>
this is a demonstration of the use of a Starburst 99 spectrum.  It was
provided to me by anand Srianand, and we used it in Srianand et al. 2003.
A constant temperature is set since this is to test shape of continuum
not thermal physics. It also tests access to user-supplied grids as the
mechanism is the same.
<p>
<p>
<p>
<p>
</p><hr><kbd><h2>stars_starburst99_2d.in</h2>  </kbd><h2><I>Starburst 99 2D SED
</I></h2><kbd><br>title Starburst 99 2D SED
<br>#
<br># commands controlling continuum =========
<br># read the table starburst and interpolate to an age of 2.09e6 years
<br># and a metallicity of 12.
<br>table star log age=6.32 Z=12. "starburst99_2d.mod"
<br>luminosity 43
<br># add background continuum - starburs 99 does not extend
<br># into fir so code would complain about zero continuum
<br># adding the cosmic background stops this complaint
<br>background
<br>#
<br># commands for density & abundances =========
<br>hden 5
<br>#
<br># commands controlling geometry  =========
<br>stop zone 1
<br>radius 20
<br>#
<br># other commands for details     =========
<br>constant temper 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>save overview "stars_starburst99_2d.ovr"
<br>save performance "stars_starburst99_2d.per"
<br>save continuum last "stars_starburst99_2d.con" units angstrom
<br>#
<br>#
<br># stars_starburst99_2d.in
<br># class stars 
<br># ========================================
<br># 
</kbd><p>
this is a demonstration of the use of a manually crafted Starburst 99 2D
grid, allowing for interpolation in both age and metallicity.  It was
provided by Christophe Morisset.
A constant temperature is set since this is to test shape of continuum
not thermal physics. It also tests access to user-supplied grids as the
mechanism is the same.
<p>
<p>
<p>
<p>
</p><hr><kbd><h2>stars_werner.in</h2>  </kbd><h2><I>Werner stars grid
</I></h2><kbd><br>title Werner stars grid
<br>#
<br># commands controlling continuum =========
<br>table star werner 190000 g=7.5
<br>luminosity total 38
<br>#
<br># commands for density & abundances =========
<br>hden 4
<br>abundances planetary no grains
<br>grains agm no qheat single 
<br>#
<br># commands controlling geometry  =========
<br>radius 17
<br>sphere
<br>set dr 0
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br>constant temperature 4.373
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_werner.per"
<br>save overview last "stars_werner.ovr"
<br>save results last "stars_werner.rlt"
<br>save continuum last "stars_werner.con" units angstrom
<br>save transmitted continuum last "stars_werner.trn"
<br>#
<br># stars_werner.in
<br># class stars 
<br># ========================================
<br># 
</kbd><p>
This checks that the code can access Kevin Volk39s Werner atmospheres. 
<p>
<br>Checks:
<br>-	table star Werner atmosphere works.
constant temperature is set to that this tests shape of stellar continuum
</p><hr><kbd><h2>stars_wmbasic.in</h2>  </kbd><h2><I>wmbasic stellar SED
</I></h2><kbd><br>title wmbasic stellar SED
<br>#
<br># commands controlling continuum =========
<br># Approximate model of a hot star ionizing its surroundings.
<br># Assume H density of 1e+6 per cc. This run tests the WMBASIC model option.
<br># I choose the T_eff, log(g), and log(Z) values arbitrarily.
<br>table star wmbasic 30000.0 4.0 -0.3
<br>luminosity 4.509202522 solar
<br>table star wmbasic 32000.0 4.0 0.0
<br>luminosity 4.509202522 solar
<br>table star wmbasic 40000.0 3.6 -0.3
<br>luminosity 4.509202522 solar
<br>table star wmbasic 35000.0 4.0 -0.15
<br>luminosity 4.509202522 solar
<br>table star wmbasic 57000.0 4.0 0.0
<br>luminosity 4.509202522 solar
<br>table star wmbasic 37000.0 3.4 -0.3
<br>luminosity 4.509202522 solar
<br>table star wmbasic 32000.0 4.0 -0.1
<br>luminosity 4.509202522 solar
<br>table star wmbasic 36000.0 3.5 -0.12
<br>luminosity 4.509202522 solar
<br>#
<br># commands for density & abundances =========
<br>abundances old solar 84 
<br>hden 6.0
<br>grains ism
<br>#
<br># commands controlling geometry  =========
<br>radius -2.0 parsec
<br>sphere
<br>stop zone 1
<br>set dr 0
<br>#
<br># other commands for details     =========
<br>#
<br># in this model the Lyman lines are pumped significantly
<br># by the stellar continuum; disable this process to avoid critical
<br># dependence on the precise shape of the continuum.
<br>no induced processes
<br>constant temperature 4
<br>no blends
<br>#
<br># commands controlling output    =========
<br>#
<br>save performance "stars_wmbasic.per"
<br>save overview last "stars_wmbasic.ovr"
<br>save results last "stars_wmbasic.rlt"
<br>save transmitted continuum last "stars_wmbasic.trn" no header
<br>save continuum last "stars_wmbasic.con" units angstrom
<br>save continuum bins last "stars_wmbasic.bin" no header
<br>#
<br># stars_wmbasic.in
<br># class stars 
<br># ========================================
</kbd><p>
This is a test that the code can correctly access the
WMBASIC O-star model atmosphere continua. 
<p>
<br>Checks:
table star wmbasic command works.
<p>
 
</p><hr><kbd><h2>thin.in</h2>  </kbd><h2><I>"Thin coronal model"
</I></h2><kbd><br>title "Thin coronal model"
<br>coronal equilibrium 1e6K
<br>hden 0
<br>stop thickness 0
<br>iterate
<br>save performance "thin.per"
<br># thin.in
<br># ===========================
</kbd><p>
This tests whether a layer with thickness much smaller than any
relevant lengthscale is modelled in a single zone
</p><hr><kbd><h2>time_cool_cd.in</h2>  </kbd><h2><I>constant density cooling cloud
</I></h2><kbd><br>title constant density cooling cloud
<br>#
<br># commands controlling continuum =========
<br>coronal 3.4e7 K init time 
<br>#
<br># commands for density & abundances =========
<br># want nT = 2e6 K cm-3
<br>hden 5.88e-2 linear
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>set nend 1
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br># number of time steps
<br>iterate 300
<br>stop time when temperature falls below 1e4 K
<br>cosmic rays background
<br>#
<br># commands controlling output    =========
<br>print line faint 2 log
<br>print line cumulative
<br>print ages
<br>set save prefix "time_cool_cd"
<br>save time dependent ".tim" no hash
<br>save dt ".dt" no hash
<br>save overview ".ovr" no hash
<br>save cooling ".col" no hash
<br>save heating ".het" no hash
<br>save continuum units Angstroms ".con"
<br>save cumulative continuum units Angstroms last ".concum"
<br>#
<br># commands giving the asserts    =========
<br>#
<br># time_cool_cd.in 
<br># class dynamics 
<br># ========================================
<br># 
</kbd><p>
test time dependent cooling at constant density
</p><hr><kbd><h2>time_cool_cd_eq.in</h2>  </kbd><h2><I>constant density equilibrium cooling cloud
</I></h2><kbd><br>title constant density equilibrium cooling cloud
<br>#
<br># commands controlling continuum =========
<br>coronal 3.4e7 K init time 
<br>#
<br># commands for density & abundances =========
<br># want nT = 2e6 K cm-3
<br>hden 5.88e-2 linear
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>set nend 1
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br># number of time steps
<br>iterate 300
<br>stop time when temperature falls below 1e4 K
<br># this will do equilibrium cooling
<br>set dynamics populations equilibrium
<br>cosmic rays background
<br>#
<br># commands controlling output    =========
<br>print line faint 2 log
<br>print line cumulative
<br>print ages
<br>set save prefix "time_cool_cd_eq"
<br>save time dependent ".tim" no hash
<br>save overview ".ovr" no hash
<br>save cooling ".col" no hash
<br>save heating ".het" no hash
<br>save continuum units Angstroms ".con"
<br>save cumulative continuum units Angstroms last ".concum"
<br>#
<br># commands giving the asserts    =========
<br>#
<br># time_cool_cd_eq.in 
<br># class dynamics 
<br># ========================================
<br># 
</kbd><p>
test time dependent equilibrium cooling at constant density
</p><hr><kbd><h2>time_cool_cd_flux.in</h2>  </kbd><h2><I>constant density cooling cloud
</I></h2><kbd><br>title constant density cooling cloud
<br>#
<br># commands controlling continuum =========
<br>coronal 3.4e7 K init time 
<br>#
<br># commands for density & abundances =========
<br># want nT = 2e6 K cm-3
<br>hden 5.88e-2 linear
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>set nend 1
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br># number of time steps
<br>iterate 300
<br>stop time when temperature falls below 1e7 K
<br>cosmic rays background
<br>#
<br># commands controlling output    =========
<br>print line faint 2 log
<br>print line cumulative
<br>print ages
<br>set cumulative flux
<br>set save prefix "time_cool_cd_flux"
<br>#
<br># commands giving the asserts    =========
<br>#
<br># time_cool_cd_flux.in 
<br># class dynamics 
<br># ========================================
<br># 
</kbd><p>
Test time dependent cooling at constant density.
In time_cool_cd.in, the line emission accumulation is done by default by mass.
In this sim, the accumulation is done by flux (see 'set cumulative' above).
This sim is meant simply to exercise the 'set cumulative flux' command, so a
full run to low temperatures is deemed unnecessary.
</p><hr><kbd><h2>time_cool_cd_noaccu.in</h2>  </kbd><h2><I>constant density cooling cloud
</I></h2><kbd><br>title constant density cooling cloud
<br>#
<br># commands controlling continuum =========
<br>coronal 3.4e7 K init time 
<br>#
<br># commands for density & abundances =========
<br># want nT = 2e6 K cm-3
<br>hden 5.88e-2 linear
<br>#
<br># commands controlling geometry  =========
<br>set dr 0 
<br>set nend 1
<br>stop zone 1
<br>#
<br># other commands for details     =========
<br># number of time steps
<br>iterate 300
<br>stop time when temperature falls below 1e7 K
<br>cosmic rays background
<br>#
<br># commands controlling output    =========
<br>normalize to "O  8" 18.9689A
<br>print line faint -3 log
<br>print ages
<br>set cumulative off
<br>set save prefix "time_cool_cd_noaccu"
<br>#
<br># commands giving the asserts    =========
<br>#
<br># time_cool_cd_flux.in 
<br># class dynamics 
<br># ========================================
<br># 
</kbd><p>
Test time dependent cooling at constant density.
In time_cool_cd.in, the line emission accumulation is done by default by mass.
In this sim, no accumulation is performed (see 'set cumulative' above).  The
final line fluxes are those of the last iteration.
This sim is meant simply to exercise the 'set cumulative off' command, so a
full run to low temperatures is deemed unnecessary.
</p><hr>

</body>

</html>
